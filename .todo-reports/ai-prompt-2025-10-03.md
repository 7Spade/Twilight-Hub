# AI Agent 工作指令
## 📊 專案狀態
- 總 TODO 數量: 157
- 🔴 緊急項目: 48
## ⚠️ 立即處理（P0 或已過期）
### 1. FIX: Parsing (L138) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\file-explorer\file-explorer.tsx:9`
- 優先級: P0
- ⏰ 截止日期: 2025-01-15
- 負責人: @frontend
**詳細說明:**
- - 問題：Unterminated string literal
- - 指引：關閉模板/單雙引號；避免註解與程式同行；必要時先以佔位字串 '--'。
- TODO[P2][lint][parser-error]: 第95行附近缺少分號或換行，導致 Parsing error。請：
- 1) 檢查上一行是否缺分號或字串未關閉。
- 2) 檢查註解是否破壞字元（如中文全形標點）。
- 3) 保持最小改動，先確保程式可被解析再進行重構。
- 參考：ESLint CLI 與 Next.js ESLint 規範（`next/core-web-vitals`），TypeScript-ESLint parsing 原則。
- TODO: [P1] REFACTOR src/components/features/spaces/components/file-explorer/file-explorer.tsx - 簡化過度複雜的組件結構
- 問題：FileExplorer 組件超過 540 行，違反奧卡姆剃刀原則
- 影響：維護困難、測試複雜、性能問題
- 建議：
- 1) 將組件拆分為更小的單一職責組件
- 2) 移除多層 Context Provider 嵌套
- 3) 使用 Next.js 15 Server Components 替代不必要的 Client Components
- 4) 統一狀態管理，避免 prop drilling
**程式碼上下文:**
```typescript
 * and user actions.
 */
'use client';
// TODO: [P0] FIX Parsing (L138) [低認知][現代化]
// - 問題：Unterminated string literal
// - 指引：關閉模板/單雙引號；避免註解與程式同行；必要時先以佔位字串 '--'。
// TODO[P2][lint][parser-error]: 第95行附近缺少分號或換行，導致 Parsing error。請：
// 1) 檢查上一行是否缺分號或字串未關閉。
// 2) 檢查註解是否破壞字元（如中文全形標點）。
// 3) 保持最小改動，先確保程式可被解析再進行重構。
// 參考：ESLint CLI 與 Next.js ESLint 規範（`next/core-web-vitals`），TypeScript-ESLint parsing 原則。
// TODO: [P1] REFACTOR src/components/features/spaces/components/file-explorer/file-explorer.tsx - 簡化過度複雜的組件結構
// 問題：FileExplorer 組件超過 540 行，違反奧卡姆剃刀原則
```
### 2. FIX: src/components/features/spaces/components/file-explorer/file-table.tsx - 修復語法錯誤（第52行未終止的字串）
- 檔案: `src\components\features\spaces\components\file-explorer\file-table.tsx:1`
- 優先級: P0
**詳細說明:**
- 說明：修正字串/JSX 轉義，確保語法正確並通過 Lint
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/file-table.tsx - 修復語法錯誤（第52行未終止的字串）
// 說明：修正字串/JSX 轉義，確保語法正確並通過 Lint
/**
 * @fileoverview A component that renders a table of files and folders.
 * TODO: [P2] [BUG] [UI] [TODO] 修復字符串字面量錯誤 - 第51行包含未終止的字符串字面量
 * It supports sorting by various columns, selecting multiple items, and triggering
 * actions on individual items. It also includes a settings menu to toggle
 * the visibility of columns.
 */
'use client';
```
### 3. FIX: src/components/features/spaces/components/file-explorer/filter-panel.tsx - 修復語法錯誤（第141行 Unexpected token）
- 檔案: `src\components\features\spaces\components\file-explorer\filter-panel.tsx:1`
- 優先級: P0
**詳細說明:**
- 說明：檢查 JSX 標籤與大於號轉義，修正不合法符號
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/filter-panel.tsx - 修復語法錯誤（第141行 Unexpected token）
// 說明：檢查 JSX 標籤與大於號轉義，修正不合法符號
/**
 * @fileoverview A slide-out panel for filtering files and folders in the explorer.
 * It provides a rich set of filtering options, including keyword search, scope
 * selection, file type, status, and date ranges. It allows users to apply these
 * filters or save them for later use.
 */
'use client';
// TODO[P2][lint][parser-error]: 第143行 Unexpected token，可能為 JSX 標籤未正確關閉或需要使用 {'>'}。
```
### 4. FIX: src/components/features/spaces/components/file-explorer/folder-tree.tsx - 修復語法錯誤（第480行 Unexpected token）
- 檔案: `src\components\features\spaces\components\file-explorer\folder-tree.tsx:1`
- 優先級: P0
**詳細說明:**
- 說明：檢查 JSX 結構與轉義，修正不合法符號
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/folder-tree.tsx - 修復語法錯誤（第480行 Unexpected token）
// 說明：檢查 JSX 結構與轉義，修正不合法符號
/**
 * @fileoverview A component that displays a hierarchical folder structure.
 * It allows users to expand and collapse folders, select items, and access
 * context-menu actions. It's the primary navigation element on the left side
 * of the file explorer.
 */
'use client';

```
### 5. FIX: src/components/features/spaces/components/file-explorer/packages-tab.tsx - 修復語法錯誤（第61行未終止的字串）
- 檔案: `src\components\features\spaces\components\file-explorer\packages-tab.tsx:1`
- 優先級: P0
**詳細說明:**
- 說明：修正字串/模板字面量，避免編譯失敗
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/packages-tab.tsx - 修復語法錯誤（第61行未終止的字串）
// 說明：修正字串/模板字面量，避免編譯失敗
/**
 * @fileoverview A component for the "Packages" tab in the file explorer's sidebar.
 * It displays a list of file packages, which are collections of related documents.
 * This component handles the creation and management of these packages.
 */
'use client';
// TODO: [P0] FIX Parsing (L156) [低認知][現代化]
// - 問題：Unexpected token（可能缺少 {'>'} 或需使用 &gt;）
```
### 6. FIX: Parsing (L156) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\file-explorer\packages-tab.tsx:9`
- 優先級: P0
**詳細說明:**
- - 問題：Unexpected token（可能缺少 {'>'} 或需使用 &gt;）
- - 指引：檢查 JSX 標籤關閉與大於號轉義，先以簡化標籤/文字替代。
**程式碼上下文:**
```typescript
 * This component handles the creation and management of these packages.
 */
'use client';
// TODO: [P0] FIX Parsing (L156) [低認知][現代化]
// - 問題：Unexpected token（可能缺少 {'>'} 或需使用 &gt;）
// - 指引：檢查 JSX 標籤關閉與大於號轉義，先以簡化標籤/文字替代。

import React, { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
```
### 7. FIX: src/components/features/spaces/components/file-explorer/services/file-preview-service.ts - 修復語法錯誤（第224行未終止的字串）
- 檔案: `src\components\features\spaces\components\file-explorer\services\file-preview-service.ts:1`
- 優先級: P0
**詳細說明:**
- 說明：補齊引號或移除多餘字元，確保語法正確
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/services/file-preview-service.ts - 修復語法錯誤（第224行未終止的字串）
// 說明：補齊引號或移除多餘字元，確保語法正確
/**
 * @fileoverview Abstract service layer for file preview functionality.
 * Provides a unified interface for different file preview libraries.
 */
'use client';

import { type FileItem } from '../folder-tree';

```
### 8. FIX: src/components/features/spaces/components/file-explorer/thumbnail/file-thumbnail-grid.tsx - 修復語法錯誤（第212行未終止的字串）
- 檔案: `src\components\features\spaces\components\file-explorer\thumbnail\file-thumbnail-grid.tsx:1`
- 優先級: P0
**詳細說明:**
- 說明：修正模板/普通字串，避免解析錯誤
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/thumbnail/file-thumbnail-grid.tsx - 修復語法錯誤（第212行未終止的字串）
// 說明：修正模板/普通字串，避免解析錯誤
/**
 * @fileoverview A modern component that displays files in a responsive thumbnail grid layout.
 * Uses @tanstack/react-virtual for high-performance virtualization and adaptive sizing.
 */
'use client';

import React, { useState, useEffect, useMemo, useRef } from 'react';

```
### 9. FIX: src/components/features/spaces/components/file-explorer/toolbar.tsx - 修復語法錯誤（第138行未終止的字串）
- 檔案: `src\components\features\spaces\components\file-explorer\toolbar.tsx:1`
- 優先級: P0
**詳細說明:**
- 說明：修正字串與 JSX 構造，確保可編譯
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/toolbar.tsx - 修復語法錯誤（第138行未終止的字串）
// 說明：修正字串與 JSX 構造，確保可編譯
/**
 * @fileoverview The main toolbar for the file explorer.
 * It contains primary actions like upload, move, and export, as well as controls
 * for searching, changing the view layout (grid/list), and accessing filters and
 * deleted items.
 */
'use client';
// TODO: [P0] FIX Parsing (L141) [低認知][現代化]
```
### 10. FIX: Parsing (L141) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\file-explorer\toolbar.tsx:10`
- 優先級: P0
**詳細說明:**
- - 問題：Unterminated string literal
- - 指引：補上引號或改為模板字串；避免在字串中混入未轉義的特殊符號。
**程式碼上下文:**
```typescript
 * deleted items.
 */
'use client';
// TODO: [P0] FIX Parsing (L141) [低認知][現代化]
// - 問題：Unterminated string literal
// - 指引：補上引號或改為模板字串；避免在字串中混入未轉義的特殊符號。

import React, { useRef } from 'react';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';

// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/toolbar.tsx:13 - 清理未使用的導入
// 問題：'Input' 已導入但從未使用
```
### 11. FIX: src/components/features/spaces/components/issues/issue-details.tsx - 修復語法錯誤（第106行未終止的字串）
- 檔案: `src\components\features\spaces\components\issues\issue-details.tsx:1`
- 優先級: P0
**詳細說明:**
- 說明：修正字串或模板字面量，避免 Lint 解析錯誤
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/issues/issue-details.tsx - 修復語法錯誤（第106行未終止的字串）
// 說明：修正字串或模板字面量，避免 Lint 解析錯誤
'use client';
// TODO: [P0] FIX Parsing (L109) [低認知][現代化]
// - 問題：Unterminated string literal
// - 指引：補齊字串引號或替換為 '--' 站位，避免註解與程式碼同一行。

import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
```
### 12. FIX: Parsing (L109) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\issues\issue-details.tsx:4`
- 優先級: P0
**詳細說明:**
- - 問題：Unterminated string literal
- - 指引：補齊字串引號或替換為 '--' 站位，避免註解與程式碼同一行。
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/issues/issue-details.tsx - 修復語法錯誤（第106行未終止的字串）
// 說明：修正字串或模板字面量，避免 Lint 解析錯誤
'use client';
// TODO: [P0] FIX Parsing (L109) [低認知][現代化]
// - 問題：Unterminated string literal
// - 指引：補齊字串引號或替換為 '--' 站位，避免註解與程式碼同一行。

import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';
import { ScrollArea } from '@/components/ui/scroll-area';
```
### 13. FIX: src/components/features/spaces/components/issues/issue-list.tsx - 修復語法錯誤（第137行未終止的字串）
- 檔案: `src\components\features\spaces\components\issues\issue-list.tsx:1`
- 優先級: P0
**詳細說明:**
- 說明：補齊引號或修正 JSX 文字，確保通過 Lint
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/issues/issue-list.tsx - 修復語法錯誤（第137行未終止的字串）
// 說明：補齊引號或修正 JSX 文字，確保通過 Lint
'use client';
// TODO: [P0] FIX Parsing (L139) [低認知][現代化]
// - 問題：Unterminated string literal
// - 指引：關閉引號；若文案不明先以 '--' 站位，稍後再補。

import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
```
### 14. FIX: Parsing (L139) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\issues\issue-list.tsx:4`
- 優先級: P0
**詳細說明:**
- - 問題：Unterminated string literal
- - 指引：關閉引號；若文案不明先以 '--' 站位，稍後再補。
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/issues/issue-list.tsx - 修復語法錯誤（第137行未終止的字串）
// 說明：補齊引號或修正 JSX 文字，確保通過 Lint
'use client';
// TODO: [P0] FIX Parsing (L139) [低認知][現代化]
// - 問題：Unterminated string literal
// - 指引：關閉引號；若文案不明先以 '--' 站位，稍後再補。

import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';
```
### 15. FIX: src/components/features/spaces/components/participants/advanced-filters.tsx - 修復語法錯誤（第34行 ',' 缺失）
- 檔案: `src\components\features\spaces\components\participants\advanced-filters.tsx:1`
- 優先級: P0
**詳細說明:**
- 說明：檢查物件/參數列表逗號缺失與 JSX 分隔
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/participants/advanced-filters.tsx - 修復語法錯誤（第34行 ',' 缺失）
// 說明：檢查物件/參數列表逗號缺失與 JSX 分隔
/**
 * @fileoverview ?�代?��?級�?濾器組件
 * ?��?多種?�濾條件?�實?��?�?
 */

'use client';
// TODO: [P0] FIX Parsing (L36) [低認知][現代化]
// - 問題："," expected（可能缺少逗號/括號）
```
### 16. FIX: Parsing (L36) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\participants\advanced-filters.tsx:9`
- 優先級: P0
**詳細說明:**
- - 問題："," expected（可能缺少逗號/括號）
- - 指引：補齊分隔符或簡化 props，先確保可解析再優化。
**程式碼上下文:**
```typescript
 */

'use client';
// TODO: [P0] FIX Parsing (L36) [低認知][現代化]
// - 問題："," expected（可能缺少逗號/括號）
// - 指引：補齊分隔符或簡化 props，先確保可解析再優化。

import React, { useState, useCallback, useMemo } from 'react';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Checkbox } from '@/components/ui/checkbox';
```
### 17. FIX: src/components/features/spaces/components/participants/card-grid.tsx - 修復語法錯誤（第123行未終止的字串）
- 檔案: `src\components\features\spaces\components\participants\card-grid.tsx:1`
- 優先級: P0
**詳細說明:**
- 說明：補齊字串/模板字面量，避免解析錯誤
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/participants/card-grid.tsx - 修復語法錯誤（第123行未終止的字串）
// 說明：補齊字串/模板字面量，避免解析錯誤
/**
 * @fileoverview ?��?式卡?�網?��??��?�?
 * 使用?�擬?��?術支?�大?�數?��?高性能渲�?
 */

'use client';
// TODO: [P0] FIX Parsing (L125) [低認知][現代化]
// - 問題：Unterminated string literal
```
### 18. FIX: Parsing (L125) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\participants\card-grid.tsx:9`
- 優先級: P0
**詳細說明:**
- - 問題：Unterminated string literal
- - 指引：補上結尾引號或用模板字串，避免特殊符號未轉義。
**程式碼上下文:**
```typescript
 */

'use client';
// TODO: [P0] FIX Parsing (L125) [低認知][現代化]
// - 問題：Unterminated string literal
// - 指引：補上結尾引號或用模板字串，避免特殊符號未轉義。

import React, { useState, useCallback, useMemo } from 'react';
import { useVirtualizer } from '@tanstack/react-virtual';
import { ParticipantCard } from './participant-card';
import { Checkbox } from '@/components/ui/checkbox';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
```
### 19. FIX: Typo/Parsing (L81) [低認知]
- 檔案: `src\components\features\spaces\components\participants\data.ts:81`
- 優先級: P0
**詳細說明:**
- - 指引：修正參數型別宣告錯字 `_spaceId:`
**程式碼上下文:**
```typescript
    },
  ];

  // TODO: [P0] FIX Typo/Parsing (L81) [低認知]
  // - 指引：修正參數型別宣告錯字 `_spaceId:`
  static async getParticipants(spaceId: _spaceId: string): Promise<Participant[]> {
    // Simulate API call
    await new Promise(resolve => setTimeout(resolve, 100));
    return [...this.participants];
  }

  // TODO: [P0] FIX Typo/Parsing (L91) [低認知]
  // - 指引：修正可選參數宣告 `message?: _message: string` => `message?: string`
```
### 20. FIX: Typo/Parsing (L91) [低認知]
- 檔案: `src\components\features\spaces\components\participants\data.ts:89`
- 優先級: P0
**詳細說明:**
- - 指引：修正可選參數宣告 `message?: _message: string` => `message?: string`
**程式碼上下文:**
```typescript
    return [...this.participants];
  }

  // TODO: [P0] FIX Typo/Parsing (L91) [低認知]
  // - 指引：修正可選參數宣告 `message?: _message: string` => `message?: string`
  static async inviteParticipant(
    spaceId: string,
    email: string,
    role: Participant['role'],
    message?: _message: string
  ): Promise<Participant> {
    // Simulate API call
    await new Promise(resolve => setTimeout(resolve, 500));
```
### 21. FIX: src/components/features/spaces/components/participants/invite-participant-dialog.tsx - 修復語法錯誤（第98行 Unexpected token）
- 檔案: `src\components\features\spaces\components\participants\invite-participant-dialog.tsx:1`
- 優先級: P0
**詳細說明:**
- 說明：檢查 JSX 標籤是否缺失閉合或有非法字元
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/participants/invite-participant-dialog.tsx - 修復語法錯誤（第98行 Unexpected token）
// 說明：檢查 JSX 標籤是否缺失閉合或有非法字元
'use client';
// TODO: [P0] FIX Parsing (L100) [低認知][現代化]
// - 問題：Unexpected token（可能需 {'>'} 或 &gt;）
// - 指引：檢查 JSX 標籤閉合，將裸 '>' 轉義為 {'>'}。

import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog';
```
### 22. FIX: Parsing (L100) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\participants\invite-participant-dialog.tsx:4`
- 優先級: P0
**詳細說明:**
- - 問題：Unexpected token（可能需 {'>'} 或 &gt;）
- - 指引：檢查 JSX 標籤閉合，將裸 '>' 轉義為 {'>'}。
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/participants/invite-participant-dialog.tsx - 修復語法錯誤（第98行 Unexpected token）
// 說明：檢查 JSX 標籤是否缺失閉合或有非法字元
'use client';
// TODO: [P0] FIX Parsing (L100) [低認知][現代化]
// - 問題：Unexpected token（可能需 {'>'} 或 &gt;）
// - 指引：檢查 JSX 標籤閉合，將裸 '>' 轉義為 {'>'}。

import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog';
import { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';
import { Input } from '@/components/ui/input';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
```
### 23. FIX: src/components/features/spaces/components/participants/participant-card.tsx - 修復語法錯誤（第109行 Unexpected token）
- 檔案: `src\components\features\spaces\components\participants\participant-card.tsx:6`
- 優先級: P0
**詳細說明:**
- 說明：檢查 JSX 屬性與標籤閉合，修正不合法符號
**程式碼上下文:**
```typescript
 * ?��?式設計�??��??�畫?�交互�???
 */

// TODO: [P0] FIX src/components/features/spaces/components/participants/participant-card.tsx - 修復語法錯誤（第109行 Unexpected token）
// 說明：檢查 JSX 屬性與標籤閉合，修正不合法符號
'use client';
// TODO: [P0] FIX Parsing (L111) [低認知][現代化]
// - 問題：Unexpected token（考慮 {'>'} 或 &gt;）
// - 指引：關閉 JSX 標籤或使用轉義，優先確保可解析。

import React, { useCallback } from 'react';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { Badge } from '@/components/ui/badge';
```
### 24. FIX: Parsing (L111) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\participants\participant-card.tsx:9`
- 優先級: P0
**詳細說明:**
- - 問題：Unexpected token（考慮 {'>'} 或 &gt;）
- - 指引：關閉 JSX 標籤或使用轉義，優先確保可解析。
**程式碼上下文:**
```typescript
// TODO: [P0] FIX src/components/features/spaces/components/participants/participant-card.tsx - 修復語法錯誤（第109行 Unexpected token）
// 說明：檢查 JSX 屬性與標籤閉合，修正不合法符號
'use client';
// TODO: [P0] FIX Parsing (L111) [低認知][現代化]
// - 問題：Unexpected token（考慮 {'>'} 或 &gt;）
// - 指引：關閉 JSX 標籤或使用轉義，優先確保可解析。

import React, { useCallback } from 'react';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Checkbox } from '@/components/ui/checkbox';
import { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from '@/components/ui/dropdown-menu';
```
### 25. FIX: Parsing (L58) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\participants\participant-filters.tsx:2`
- 優先級: P0
**詳細說明:**
- - 問題：Unterminated string literal
- - 指引：補上引號或以 '--' 站位，避免混雜未轉義符號。
**程式碼上下文:**
```typescript
'use client';
// TODO: [P0] FIX Parsing (L58) [低認知][現代化]
// - 問題：Unterminated string literal
// - 指引：補上引號或以 '--' 站位，避免混雜未轉義符號。

import { memo } from 'react';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Search, Filter, X } from 'lucide-react';
import { ParticipantFiltersProps } from './types';
```
### 26. FIX: Parsing (L67) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\participants\participant-list.tsx:2`
- 優先級: P0
**詳細說明:**
- - 問題：Unexpected token（可能需 {'>'} 或 &gt;）
- - 指引：檢查 JSX 標籤/表格單元，使用 {'>'} 取代裸字符。
**程式碼上下文:**
```typescript
'use client';
// TODO: [P0] FIX Parsing (L67) [低認知][現代化]
// - 問題：Unexpected token（可能需 {'>'} 或 &gt;）
// - 指引：檢查 JSX 標籤/表格單元，使用 {'>'} 取代裸字符。

import React, { useEffect, useMemo, useState, useCallback } from 'react';
import { Button } from '@/components/ui/button';
import { Plus, Download, Users, AlertCircle } from 'lucide-react';
import { useParticipants, useParticipantFilters } from './hooks/use-participants';
import { VirtualizedTable } from './virtualized-table';
import { CardGrid } from './card-grid';
```
### 27. FIX: Parsing (L67) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\participants\participant-role-editor.tsx:2`
- 優先級: P0
**詳細說明:**
- - 問題：Unterminated string literal
- - 指引：補齊引號或簡化字串；避免行內註解破壞字串。
**程式碼上下文:**
```typescript
'use client';
// TODO: [P0] FIX Parsing (L67) [低認知][現代化]
// - 問題：Unterminated string literal
// - 指引：補齊引號或簡化字串；避免行內註解破壞字串。

import { Button } from '@/components/ui/button';
import { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog';
import { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
```
### 28. FIX: Parsing (L82) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\participants\participant-table.tsx:2`
- 優先級: P0
**詳細說明:**
- - 問題：Unterminated string literal
- - 指引：補上結尾引號；若文案未定以 '--' 站位。
**程式碼上下文:**
```typescript
'use client';
// TODO: [P0] FIX Parsing (L82) [低認知][現代化]
// - 問題：Unterminated string literal
// - 指引：補上結尾引號；若文案未定以 '--' 站位。

import { memo, useCallback } from 'react';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Switch } from '@/components/ui/switch';
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';
```
### 29. FIX: Parsing (L106) [低認知][現代化]
- 檔案: `src\components\features\spaces\components\participants\virtualized-table.tsx:7`
- 優先級: P0
**詳細說明:**
- - 問題：Unexpected token（考慮 {'>'} 或 &gt;）
- - 指引：檢查 JSX 中的 '>' 與屬性，必要時以 {'>'} 顯示文字箭頭。
**程式碼上下文:**
```typescript
 */

'use client';
// TODO: [P0] FIX Parsing (L106) [低認知][現代化]
// - 問題：Unexpected token（考慮 {'>'} 或 &gt;）
// - 指引：檢查 JSX 中的 '>' 與屬性，必要時以 {'>'} 顯示文字箭頭。

import React, { useMemo, useCallback, useState } from 'react';
import { useVirtualizer } from '@tanstack/react-virtual';
import { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';
import { Badge } from '@/components/ui/badge';
import { Button } from '@/components/ui/button';
import { Checkbox } from '@/components/ui/checkbox';
```
### 30. PERF: src/app/(app)/layout.tsx:71 - 優化 React hooks 依賴項
- 檔案: `src\app\(app)\layout.tsx:73`
- 優先級: P1
- ⏰ 截止日期: 2025-01-15
- 負責人: @frontend
**詳細說明:**
- 問題：organizations 邏輯表達式可能導致 useMemo Hook 依賴項在每次渲染時改變
- 影響：性能問題，不必要的重新渲染
- 建議：將 organizations 初始化包裝在獨立的 useMemo Hook 中
**程式碼上下文:**
```typescript
  );
  const organizations = organizationsData || [];

// TODO: [P1] PERF src/app/(app)/layout.tsx:71 - 優化 React hooks 依賴項
// 問題：organizations 邏輯表達式可能導致 useMemo Hook 依賴項在每次渲染時改變
// 影響：性能問題，不必要的重新渲染
// 建議：將 organizations 初始化包裝在獨立的 useMemo Hook 中
// @assignee frontend-team
// @deadline 2025-01-15

  const [selectedTeam, setSelectedTeam] = useState<Team | null>(null);
  
  const handleSetSelectedTeam = (team: Team) => {
```
### 31. PERF: src/app/(app)/organizations/[organizationslug]/inventory/page.tsx:122 - 優化 React hooks 依賴項
- 檔案: `src\app\(app)\organizations\[organizationslug]\inventory\page.tsx:127`
- 優先級: P1
- ⏰ 截止日期: 2025-01-15
- 負責人: @frontend
**詳細說明:**
- 問題：warehouses 邏輯表達式可能導致 useEffect 和 useMemo Hook 依賴項在每次渲染時改變
- 影響：性能問題，不必要的重新渲染（影響 lines 150, 176）
- 建議：將 warehouses 初始化包裝在獨立的 useMemo Hook 中
**程式碼上下文:**
```typescript
    useCollection<WarehouseType>(warehousesQuery);
  const warehouses = warehousesData || [];

// TODO: [P1] PERF src/app/(app)/organizations/[organizationslug]/inventory/page.tsx:122 - 優化 React hooks 依賴項
// 問題：warehouses 邏輯表達式可能導致 useEffect 和 useMemo Hook 依賴項在每次渲染時改變
// 影響：性能問題，不必要的重新渲染（影響 lines 150, 176）
// 建議：將 warehouses 初始化包裝在獨立的 useMemo Hook 中
// @assignee frontend-team
// @deadline 2025-01-15

  // Fetch all stock data for all warehouses
  const [allStock, setAllStock] = useState<Stock[]>([]);
  const [stockLoading, setStockLoading] = useState(true);
```
### 32. PERF: src/app/(app)/organizations/[organizationslug]/inventory/[itemId]/page.tsx:95 - 優化 React hooks 依賴項
- 檔案: `src\app\(app)\organizations\[organizationslug]\inventory\[itemId]\page.tsx:100`
- 優先級: P1
- ⏰ 截止日期: 2025-01-15
- 負責人: @frontend
**詳細說明:**
- 問題：warehouses 邏輯表達式可能導致 useEffect Hook 依賴項在每次渲染時改變
- 影響：性能問題，不必要的重新渲染（影響 line 128）
- 建議：將 warehouses 初始化包裝在獨立的 useMemo Hook 中
**程式碼上下文:**
```typescript
    useCollection<Warehouse>(warehousesQuery);
  const warehouses = warehousesData || [];

// TODO: [P1] PERF src/app/(app)/organizations/[organizationslug]/inventory/[itemId]/page.tsx:95 - 優化 React hooks 依賴項
// 問題：warehouses 邏輯表達式可能導致 useEffect Hook 依賴項在每次渲染時改變
// 影響：性能問題，不必要的重新渲染（影響 line 128）
// 建議：將 warehouses 初始化包裝在獨立的 useMemo Hook 中
// @assignee frontend-team
// @deadline 2025-01-15

  // Get stock for this item across all warehouses
  const [stockData, setStockData] = useState< (Stock & { warehouseName: string })[] >([]);
  const [stockLoading, setStockLoading] = useState(true);
```
### 33. PERF: src/app/(app)/spaces/page.tsx:42 - 優化 React hooks 依賴項
- 檔案: `src\app\(app)\spaces\page.tsx:47`
- 優先級: P1
- ⏰ 截止日期: 2025-01-15
- 負責人: @frontend
**詳細說明:**
- 問題：allSpaces 邏輯表達式可能導致多個 useMemo Hook 依賴項在每次渲染時改變
- 影響：性能問題，不必要的重新渲染（影響 lines 49, 70, 77, 82）
- 建議：將 allSpaces 初始化包裝在獨立的 useMemo Hook 中
**程式碼上下文:**
```typescript
    useCollection<Space>(allSpacesQuery);
  const allSpaces = allSpacesData || [];

// TODO: [P1] PERF src/app/(app)/spaces/page.tsx:42 - 優化 React hooks 依賴項
// 問題：allSpaces 邏輯表達式可能導致多個 useMemo Hook 依賴項在每次渲染時改變
// 影響：性能問題，不必要的重新渲染（影響 lines 49, 70, 77, 82）
// 建議：將 allSpaces 初始化包裝在獨立的 useMemo Hook 中
// @assignee frontend-team
// @deadline 2025-01-15

  const allOwnerIds = useMemo(() => {
    if (allSpaces.length === 0) return [];
    const ids = new Set<string>();
```
### 34. PERF: src/components/auth/auth-provider.tsx:345 - 修復 React Hook 缺失依賴項
- 檔案: `src\components\auth\auth-provider.tsx:370`
- 優先級: P1
- ⏰ 截止日期: 2025-01-15
- 負責人: @frontend
**詳細說明:**
- 問題：useEffect Hook 缺少 'fetchUserRoleAssignment' 依賴項
- 影響：可能導致過時閉包問題，狀態更新不及時
- 建議：將 'fetchUserRoleAssignment' 添加到依賴數組中，或移除依賴數組
**程式碼上下文:**
```typescript
    return () => unsubscribe();
  }, [auth]);

// TODO: [P1] PERF src/components/auth/auth-provider.tsx:345 - 修復 React Hook 缺失依賴項
// 問題：useEffect Hook 缺少 'fetchUserRoleAssignment' 依賴項
// 影響：可能導致過時閉包問題，狀態更新不及時
// 建議：將 'fetchUserRoleAssignment' 添加到依賴數組中，或移除依賴數組
// @assignee frontend-team
// @deadline 2025-01-15

  const value: AuthContext = {
    ...state,
    setUser,
```
### 35. PERF: src/components/auth/role-manager.tsx:123 - 修復 React Hook 缺失依賴項
- 檔案: `src\components\auth\role-manager.tsx:160`
- 優先級: P1
- ⏰ 截止日期: 2025-01-15
- 負責人: @frontend
**詳細說明:**
- 問題：useEffect Hook 缺少 'loadRoles' 和 'loadUsers' 依賴項
- 影響：可能導致過時閉包問題，函數更新不及時
- 建議：將 'loadRoles' 和 'loadUsers' 添加到依賴數組中，或使用 useCallback 包裝函數
**程式碼上下文:**
```typescript
    loadUsers();
  }, [spaceId]);

// TODO: [P1] PERF src/components/auth/role-manager.tsx:123 - 修復 React Hook 缺失依賴項
// 問題：useEffect Hook 缺少 'loadRoles' 和 'loadUsers' 依賴項
// 影響：可能導致過時閉包問題，函數更新不及時
// 建議：將 'loadRoles' 和 'loadUsers' 添加到依賴數組中，或使用 useCallback 包裝函數
// @assignee frontend-team
// @deadline 2025-01-15

  const loadRoles = async () => {
    setLoading(true);
    setError(null);
```
### 36. REFACTOR: src/components/features/spaces/components/file-explorer/file-explorer.tsx - 簡化過度複雜的組件結構
- 檔案: `src\components\features\spaces\components\file-explorer\file-explorer.tsx:17`
- 優先級: P1
- ⏰ 截止日期: 2025-01-15
- 負責人: @frontend
**詳細說明:**
- 問題：FileExplorer 組件超過 540 行，違反奧卡姆剃刀原則
- 影響：維護困難、測試複雜、性能問題
- 建議：
- 1) 將組件拆分為更小的單一職責組件
- 2) 移除多層 Context Provider 嵌套
- 3) 使用 Next.js 15 Server Components 替代不必要的 Client Components
- 4) 統一狀態管理，避免 prop drilling
**程式碼上下文:**
```typescript
// 2) 檢查註解是否破壞字元（如中文全形標點）。
// 3) 保持最小改動，先確保程式可被解析再進行重構。
// 參考：ESLint CLI 與 Next.js ESLint 規範（`next/core-web-vitals`），TypeScript-ESLint parsing 原則。
// TODO: [P1] REFACTOR src/components/features/spaces/components/file-explorer/file-explorer.tsx - 簡化過度複雜的組件結構
// 問題：FileExplorer 組件超過 540 行，違反奧卡姆剃刀原則
// 影響：維護困難、測試複雜、性能問題
// 建議：
// 1) 將組件拆分為更小的單一職責組件
// 2) 移除多層 Context Provider 嵌套
// 3) 使用 Next.js 15 Server Components 替代不必要的 Client Components
// 4) 統一狀態管理，避免 prop drilling
// @assignee frontend-team
// @deadline 2025-01-15
```
### 37. PERF: src/components/features/spaces/hooks/use-file-actions.ts:105 - 修復 React Hook 缺失依賴項
- 檔案: `src\components\features\spaces\hooks\use-file-actions.ts:107`
- 優先級: P1
- ⏰ 截止日期: 2025-01-15
- 負責人: @frontend
**詳細說明:**
- 問題：useCallback Hook 缺少 'fileOperations' 依賴項
- 影響：可能導致過時閉包問題，函數更新不及時
- 建議：將 'fileOperations' 添加到依賴數組中，或移除依賴數組
**程式碼上下文:**
```typescript
    }
  }, [toast]);

// TODO: [P1] PERF src/components/features/spaces/hooks/use-file-actions.ts:105 - 修復 React Hook 缺失依賴項
// 問題：useCallback Hook 缺少 'fileOperations' 依賴項
// 影響：可能導致過時閉包問題，函數更新不及時
// 建議：將 'fileOperations' 添加到依賴數組中，或移除依賴數組
// @assignee frontend-team
// @deadline 2025-01-15

  const downloadFile = useCallback(async (
    fileName: string, 
    spaceId: string, 
```
### 38. REFACTOR: src/components/features/spaces/components/ - 減少過度抽象的組件層級
- 檔案: `src\components\features\spaces\components\index.ts:7`
- 優先級: P1
- ⏰ 截止日期: 2025-01-20
- 負責人: @frontend
**詳細說明:**
- 問題：70 個文件過度拆分，造成不必要的複雜性
- 影響：導入路徑過長、維護成本高、認知負擔重
- 建議：
- 1) 合併功能相似的組件（如多個 list 組件）
- 2) 簡化目錄結構，減少嵌套層級
- 3) 移除不必要的 barrel exports
- 4) 遵循 Next.js 15 組件組合模式
**程式碼上下文:**
```typescript
 * by providing a single, consistent path.
 */

// TODO: [P1] REFACTOR src/components/features/spaces/components/ - 減少過度抽象的組件層級
// 問題：70 個文件過度拆分，造成不必要的複雜性
// 影響：導入路徑過長、維護成本高、認知負擔重
// 建議：
// 1) 合併功能相似的組件（如多個 list 組件）
// 2) 簡化目錄結構，減少嵌套層級
// 3) 移除不必要的 barrel exports
// 4) 遵循 Next.js 15 組件組合模式
// @assignee frontend-team
// @deadline 2025-01-20
```
### 39. REFACTOR: src/components/adjust-stock-dialog.tsx:133 - 修復非空斷言警告
- 檔案: `src\components\adjust-stock-dialog.tsx:142`
- 優先級: P2
- ⏰ 截止日期: 2025-01-25
- 負責人: @frontend
**詳細說明:**
- 問題：使用非空斷言 (!) 可能導致運行時錯誤
- 影響：類型安全問題，可能導致應用崩潰
- 建議：添加適當的類型檢查或使用可選鏈操作符
**程式碼上下文:**
```typescript
              // 說明：在使用 stockInfo.stockId 前進行存在性檢查，移除非空斷言
              stockDocRef = doc(firestore, 'accounts', organizationId, 'warehouses', warehouseId, 'stock', stockInfo.stockId!);
              
// TODO: [P2] REFACTOR src/components/adjust-stock-dialog.tsx:133 - 修復非空斷言警告
// 問題：使用非空斷言 (!) 可能導致運行時錯誤
// 影響：類型安全問題，可能導致應用崩潰
// 建議：添加適當的類型檢查或使用可選鏈操作符
// @assignee frontend-team
// @deadline 2025-01-25
              batch.update(stockDocRef, { quantity: increment(adjustment) });
          } else {
              // Create a new stock document
              stockDocRef = doc(collection(firestore, 'accounts', organizationId, 'warehouses', warehouseId, 'stock'));
```
### 40. REFACTOR: src/components/auth/auth-provider.tsx:192 - 修復 TypeScript any 類型使用
- 檔案: `src\components\auth\auth-provider.tsx:197`
- 優先級: P2
- ⏰ 截止日期: 2025-01-25
- 負責人: @frontend
**詳細說明:**
- 問題：使用 any 類型違反類型安全原則
- 影響：失去類型檢查，可能導致運行時錯誤
- 建議：定義具體的類型接口替代 any 類型
**程式碼上下文:**
```typescript
      spaceRolesSnapshot.forEach(d => {
        const data = d.data() as any;
        
// TODO: [P2] REFACTOR src/components/auth/auth-provider.tsx:192 - 修復 TypeScript any 類型使用
// 問題：使用 any 類型違反類型安全原則
// 影響：失去類型檢查，可能導致運行時錯誤
// 建議：定義具體的類型接口替代 any 類型
// @assignee frontend-team
// @deadline 2025-01-25
        const ts: Timestamp = data.assignedAt && typeof data.assignedAt.toDate === 'function'
          ? data.assignedAt as Timestamp
          : Timestamp.fromDate(new Date());
        spaceRoles[data.spaceId] = {
```
### 41. REFACTOR: src/components/auth/auth-provider.tsx:221 - 修復 TypeScript any 類型使用
- 檔案: `src\components\auth\auth-provider.tsx:226`
- 優先級: P2
- ⏰ 截止日期: 2025-01-25
- 負責人: @frontend
**詳細說明:**
- 問題：使用 any 類型違反類型安全原則
- 影響：失去類型檢查，可能導致運行時錯誤
- 建議：定義具體的類型接口替代 any 類型
**程式碼上下文:**
```typescript
      orgRolesSnapshot.forEach(d => {
        const data = d.data() as any;
        
// TODO: [P2] REFACTOR src/components/auth/auth-provider.tsx:221 - 修復 TypeScript any 類型使用
// 問題：使用 any 類型違反類型安全原則
// 影響：失去類型檢查，可能導致運行時錯誤
// 建議：定義具體的類型接口替代 any 類型
// @assignee frontend-team
// @deadline 2025-01-25
        const ts: Timestamp = data.assignedAt && typeof data.assignedAt.toDate === 'function'
          ? data.assignedAt as Timestamp
          : Timestamp.fromDate(new Date());
        organizationRoles.push({
```
### 42. PERF: src/components/features/spaces/components/file-explorer/ - 優化 Client/Server Components 使用
- 檔案: `src\components\features\spaces\components\file-explorer\file-explorer.tsx:28`
- 優先級: P2
- ⏰ 截止日期: 2025-01-25
- 負責人: @performance
**詳細說明:**
- 問題：過度使用 Client Components，違反 Next.js 15 最佳實踐
- 影響：增加 JavaScript bundle 大小、影響首屏性能
- 建議：
- 1) 將純展示組件改為 Server Components
- 2) 使用 Next.js 15 的 'use client' 邊界優化
- 3) 實現適當的代碼分割和懶加載
- 4) 使用 React 19 的新特性優化渲染
**程式碼上下文:**
```typescript
// @assignee frontend-team
// @deadline 2025-01-15

// TODO: [P2] PERF src/components/features/spaces/components/file-explorer/ - 優化 Client/Server Components 使用
// 問題：過度使用 Client Components，違反 Next.js 15 最佳實踐
// 影響：增加 JavaScript bundle 大小、影響首屏性能
// 建議：
// 1) 將純展示組件改為 Server Components
// 2) 使用 Next.js 15 的 'use client' 邊界優化
// 3) 實現適當的代碼分割和懶加載
// 4) 使用 React 19 的新特性優化渲染
// @assignee performance-team
// @deadline 2025-01-25
```
### 43. REFACTOR: src/components/features/spaces/components/file-explorer/file-table.tsx:76-77 - 修復 TypeScript any 類型使用
- 檔案: `src\components\features\spaces\components\file-explorer\file-table.tsx:80`
- 優先級: P2
- ⏰ 截止日期: 2025-01-25
- 負責人: @frontend
**詳細說明:**
- 問題：使用 any 類型違反類型安全原則
- 影響：失去類型檢查，可能導致運行時錯誤
- 建議：定義具體的類型接口替代 any 類型
**程式碼上下文:**
```typescript
      let aValue: any;
      let bValue: any;
      
// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/file-table.tsx:76-77 - 修復 TypeScript any 類型使用
// 問題：使用 any 類型違反類型安全原則
// 影響：失去類型檢查，可能導致運行時錯誤
// 建議：定義具體的類型接口替代 any 類型
// @assignee frontend-team
// @deadline 2025-01-25

      switch (sortField) {
        case 'name':
          aValue = a.name.toLowerCase();
```
### 44. REFACTOR: src/components/features/spaces/components/file-explorer/filter-panel.tsx:81 - 修復 TypeScript any 類型使用
- 檔案: `src\components\features\spaces\components\file-explorer\filter-panel.tsx:102`
- 優先級: P2
- ⏰ 截止日期: 2025-01-25
- 負責人: @frontend
**詳細說明:**
- 問題：使用 any 類型違反類型安全原則
- 影響：失去類型檢查，可能導致運行時錯誤
- 建議：定義具體的類型接口替代 any 類型
**程式碼上下文:**
```typescript

  const handleFilterChange = (key: keyof FilterOptions, value: any) => {
    
// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/filter-panel.tsx:81 - 修復 TypeScript any 類型使用
// 問題：使用 any 類型違反類型安全原則
// 影響：失去類型檢查，可能導致運行時錯誤
// 建議：定義具體的類型接口替代 any 類型
// @assignee frontend-team
// @deadline 2025-01-25
    setFilters(prev => ({ ...prev, [key]: value }));
  };

  const handleApply = () => {
```
### 45. REFACTOR: src/components/features/spaces/components/ - 合併重複的組件邏輯
- 檔案: `src\components\features\spaces\components\index.ts:18`
- 優先級: P2
- ⏰ 截止日期: 2025-01-30
- 負責人: @frontend
**詳細說明:**
- 問題：多個 list/card/dialog 組件存在重複邏輯
- 影響：代碼重複、維護困難、一致性問題
- 建議：
- 1) 創建通用的 List/Card/Dialog 基礎組件
- 2) 使用 TypeScript 泛型提高類型安全
- 3) 實現組合模式而非繼承
- 4) 遵循 DRY 原則和奧卡姆剃刀
- Spaces feature components exports
**程式碼上下文:**
```typescript
// @assignee frontend-team
// @deadline 2025-01-20

// TODO: [P2] REFACTOR src/components/features/spaces/components/ - 合併重複的組件邏輯
// 問題：多個 list/card/dialog 組件存在重複邏輯
// 影響：代碼重複、維護困難、一致性問題
// 建議：
// 1) 創建通用的 List/Card/Dialog 基礎組件
// 2) 使用 TypeScript 泛型提高類型安全
// 3) 實現組合模式而非繼承
// 4) 遵循 DRY 原則和奧卡姆剃刀
// @assignee frontend-team
// @deadline 2025-01-30
```
### 46. PERF: next.config.ts - 實現 Next.js 15 性能優化配置
- 檔案: `next.config.ts:12`
- 優先級: P2
- ⏰ 截止日期: 2025-02-01
- 負責人: @performance
**詳細說明:**
- 問題：未充分利用 Next.js 15 的性能優化特性
- 影響：圖片載入性能差、bundle 大小過大
- 建議：
- 1) 啟用 optimizePackageImports 減少 bundle 大小
- 2) 配置 bundlePagesRouterDependencies 優化依賴打包
- 3) 添加 experimental.turbo 配置提升開發體驗
- 4) 配置適當的圖片優化參數
**程式碼上下文:**
```typescript
    ignoreDuringBuilds: true,
  },
  
  // TODO: [P2] PERF next.config.ts - 實現 Next.js 15 性能優化配置
  // 問題：未充分利用 Next.js 15 的性能優化特性
  // 影響：圖片載入性能差、bundle 大小過大
  // 建議：
  // 1) 啟用 optimizePackageImports 減少 bundle 大小
  // 2) 配置 bundlePagesRouterDependencies 優化依賴打包
  // 3) 添加 experimental.turbo 配置提升開發體驗
  // 4) 配置適當的圖片優化參數
  // @assignee performance-team
  // @deadline 2025-02-01
```
### 47. PERF: src/components/ui/file-type-icon.tsx - 實現 Next.js 15 圖片優化最佳實踐
- 檔案: `src\components\ui\file-type-icon.tsx:28`
- 優先級: P2
- ⏰ 截止日期: 2025-02-01
- 負責人: @performance
**詳細說明:**
- 問題：未充分利用 Next.js Image 組件的優化特性
- 影響：圖片載入性能差、LCP 指標不佳
- 建議：
- 1) 使用 next/image 替代所有 <img> 標籤
- 2) 配置適當的 priority 和 sizes 屬性
- 3) 實現圖片預載入和懶加載策略
- 4) 使用 WebP/AVIF 格式優化
**程式碼上下文:**
```typescript
  FileImage,
  // TODO: [P2] REFACTOR src/components/ui/file-type-icon.tsx - 清理未使用的導入（useEffect, Image, Video, Music, Archive, Code 未使用）
  
// TODO: [P2] PERF src/components/ui/file-type-icon.tsx - 實現 Next.js 15 圖片優化最佳實踐
// 問題：未充分利用 Next.js Image 組件的優化特性
// 影響：圖片載入性能差、LCP 指標不佳
// 建議：
// 1) 使用 next/image 替代所有 <img> 標籤
// 2) 配置適當的 priority 和 sizes 屬性
// 3) 實現圖片預載入和懶加載策略
// 4) 使用 WebP/AVIF 格式優化
// @assignee performance-team
// @deadline 2025-02-01
```
### 48. REFACTOR: src/components/features/spaces/hooks/ - 簡化 hooks 邏輯
- 檔案: `src\components\features\spaces\hooks\index.ts:7`
- 優先級: P2
- ⏰ 截止日期: 2025-02-05
- 負責人: @frontend
**詳細說明:**
- 問題：多個 hooks 文件可能包含重複邏輯
- 影響：代碼重複、狀態管理複雜
- 建議：
- 1) 合併相似的 hooks 邏輯
- 2) 使用 React 19 的新 hooks 特性
- 3) 實現更簡單的狀態管理模式
- 4) 減少不必要的 useEffect 使用
- Spaces feature hooks exports
**程式碼上下文:**
```typescript
 * hooks, such as those for handling actions, into other components.
 */

// TODO: [P2] REFACTOR src/components/features/spaces/hooks/ - 簡化 hooks 邏輯
// 問題：多個 hooks 文件可能包含重複邏輯
// 影響：代碼重複、狀態管理複雜
// 建議：
// 1) 合併相似的 hooks 邏輯
// 2) 使用 React 19 的新 hooks 特性
// 3) 實現更簡單的狀態管理模式
// 4) 減少不必要的 useEffect 使用
// @assignee frontend-team
// @deadline 2025-02-05
```
## 📋 建議處理順序
依照以下順序處理 TODO：
1. P0 - SECURITY（安全性問題）
2. P0 - FIX（緊急修復）
3. P1 - SECURITY
4. P1 - FIX
5. P1 - FEAT（重要功能）
6. P2 項目
7. P3 項目

## 🎯 完整 TODO 清單（JSON 格式）

```json
[
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L138) [低認知][現代化]",
    "details": [
      "- 問題：Unterminated string literal",
      "- 指引：關閉模板/單雙引號；避免註解與程式同行；必要時先以佔位字串 '--'。",
      "TODO[P2][lint][parser-error]: 第95行附近缺少分號或換行，導致 Parsing error。請：",
      "1) 檢查上一行是否缺分號或字串未關閉。",
      "2) 檢查註解是否破壞字元（如中文全形標點）。",
      "3) 保持最小改動，先確保程式可被解析再進行重構。",
      "參考：ESLint CLI 與 Next.js ESLint 規範（`next/core-web-vitals`），TypeScript-ESLint parsing 原則。",
      "TODO: [P1] REFACTOR src/components/features/spaces/components/file-explorer/file-explorer.tsx - 簡化過度複雜的組件結構",
      "問題：FileExplorer 組件超過 540 行，違反奧卡姆剃刀原則",
      "影響：維護困難、測試複雜、性能問題",
      "建議：",
      "1) 將組件拆分為更小的單一職責組件",
      "2) 移除多層 Context Provider 嵌套",
      "3) 使用 Next.js 15 Server Components 替代不必要的 Client Components",
      "4) 統一狀態管理，避免 prop drilling"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\file-explorer.tsx",
    "line": 9,
    "assignee": "frontend",
    "deadline": "2025-01-15",
    "context": " * and user actions.\r\n */\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L138) [低認知][現代化]\r\n// - 問題：Unterminated string literal\r\n// - 指引：關閉模板/單雙引號；避免註解與程式同行；必要時先以佔位字串 '--'。\r\n// TODO[P2][lint][parser-error]: 第95行附近缺少分號或換行，導致 Parsing error。請：\r\n// 1) 檢查上一行是否缺分號或字串未關閉。\r\n// 2) 檢查註解是否破壞字元（如中文全形標點）。\r\n// 3) 保持最小改動，先確保程式可被解析再進行重構。\r\n// 參考：ESLint CLI 與 Next.js ESLint 規範（`next/core-web-vitals`），TypeScript-ESLint parsing 原則。\r\n// TODO: [P1] REFACTOR src/components/features/spaces/components/file-explorer/file-explorer.tsx - 簡化過度複雜的組件結構\r\n// 問題：FileExplorer 組件超過 540 行，違反奧卡姆剃刀原則\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/file-explorer/file-table.tsx - 修復語法錯誤（第52行未終止的字串）",
    "details": [
      "說明：修正字串/JSX 轉義，確保語法正確並通過 Lint"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\file-table.tsx",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/file-table.tsx - 修復語法錯誤（第52行未終止的字串）\r\n// 說明：修正字串/JSX 轉義，確保語法正確並通過 Lint\r\n/**\r\n * @fileoverview A component that renders a table of files and folders.\r\n * TODO: [P2] [BUG] [UI] [TODO] 修復字符串字面量錯誤 - 第51行包含未終止的字符串字面量\r\n * It supports sorting by various columns, selecting multiple items, and triggering\r\n * actions on individual items. It also includes a settings menu to toggle\r\n * the visibility of columns.\r\n */\r\n'use client';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/file-explorer/filter-panel.tsx - 修復語法錯誤（第141行 Unexpected token）",
    "details": [
      "說明：檢查 JSX 標籤與大於號轉義，修正不合法符號"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\filter-panel.tsx",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/filter-panel.tsx - 修復語法錯誤（第141行 Unexpected token）\r\n// 說明：檢查 JSX 標籤與大於號轉義，修正不合法符號\r\n/**\r\n * @fileoverview A slide-out panel for filtering files and folders in the explorer.\r\n * It provides a rich set of filtering options, including keyword search, scope\r\n * selection, file type, status, and date ranges. It allows users to apply these\r\n * filters or save them for later use.\r\n */\r\n'use client';\r\n// TODO[P2][lint][parser-error]: 第143行 Unexpected token，可能為 JSX 標籤未正確關閉或需要使用 {'>'}。\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/file-explorer/folder-tree.tsx - 修復語法錯誤（第480行 Unexpected token）",
    "details": [
      "說明：檢查 JSX 結構與轉義，修正不合法符號"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\folder-tree.tsx",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/folder-tree.tsx - 修復語法錯誤（第480行 Unexpected token）\r\n// 說明：檢查 JSX 結構與轉義，修正不合法符號\r\n/**\r\n * @fileoverview A component that displays a hierarchical folder structure.\r\n * It allows users to expand and collapse folders, select items, and access\r\n * context-menu actions. It's the primary navigation element on the left side\r\n * of the file explorer.\r\n */\r\n'use client';\r\n\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/file-explorer/packages-tab.tsx - 修復語法錯誤（第61行未終止的字串）",
    "details": [
      "說明：修正字串/模板字面量，避免編譯失敗"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\packages-tab.tsx",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/packages-tab.tsx - 修復語法錯誤（第61行未終止的字串）\r\n// 說明：修正字串/模板字面量，避免編譯失敗\r\n/**\r\n * @fileoverview A component for the \"Packages\" tab in the file explorer's sidebar.\r\n * It displays a list of file packages, which are collections of related documents.\r\n * This component handles the creation and management of these packages.\r\n */\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L156) [低認知][現代化]\r\n// - 問題：Unexpected token（可能缺少 {'>'} 或需使用 &gt;）\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L156) [低認知][現代化]",
    "details": [
      "- 問題：Unexpected token（可能缺少 {'>'} 或需使用 &gt;）",
      "- 指引：檢查 JSX 標籤關閉與大於號轉義，先以簡化標籤/文字替代。"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\packages-tab.tsx",
    "line": 9,
    "context": " * This component handles the creation and management of these packages.\r\n */\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L156) [低認知][現代化]\r\n// - 問題：Unexpected token（可能缺少 {'>'} 或需使用 &gt;）\r\n// - 指引：檢查 JSX 標籤關閉與大於號轉義，先以簡化標籤/文字替代。\r\n\r\nimport React, { useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/file-explorer/services/file-preview-service.ts - 修復語法錯誤（第224行未終止的字串）",
    "details": [
      "說明：補齊引號或移除多餘字元，確保語法正確"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\services\\file-preview-service.ts",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/services/file-preview-service.ts - 修復語法錯誤（第224行未終止的字串）\r\n// 說明：補齊引號或移除多餘字元，確保語法正確\r\n/**\r\n * @fileoverview Abstract service layer for file preview functionality.\r\n * Provides a unified interface for different file preview libraries.\r\n */\r\n'use client';\r\n\r\nimport { type FileItem } from '../folder-tree';\r\n\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/file-explorer/thumbnail/file-thumbnail-grid.tsx - 修復語法錯誤（第212行未終止的字串）",
    "details": [
      "說明：修正模板/普通字串，避免解析錯誤"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\thumbnail\\file-thumbnail-grid.tsx",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/thumbnail/file-thumbnail-grid.tsx - 修復語法錯誤（第212行未終止的字串）\r\n// 說明：修正模板/普通字串，避免解析錯誤\r\n/**\r\n * @fileoverview A modern component that displays files in a responsive thumbnail grid layout.\r\n * Uses @tanstack/react-virtual for high-performance virtualization and adaptive sizing.\r\n */\r\n'use client';\r\n\r\nimport React, { useState, useEffect, useMemo, useRef } from 'react';\r\n\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/file-explorer/toolbar.tsx - 修復語法錯誤（第138行未終止的字串）",
    "details": [
      "說明：修正字串與 JSX 構造，確保可編譯"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\toolbar.tsx",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/file-explorer/toolbar.tsx - 修復語法錯誤（第138行未終止的字串）\r\n// 說明：修正字串與 JSX 構造，確保可編譯\r\n/**\r\n * @fileoverview The main toolbar for the file explorer.\r\n * It contains primary actions like upload, move, and export, as well as controls\r\n * for searching, changing the view layout (grid/list), and accessing filters and\r\n * deleted items.\r\n */\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L141) [低認知][現代化]\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L141) [低認知][現代化]",
    "details": [
      "- 問題：Unterminated string literal",
      "- 指引：補上引號或改為模板字串；避免在字串中混入未轉義的特殊符號。"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\toolbar.tsx",
    "line": 10,
    "context": " * deleted items.\r\n */\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L141) [低認知][現代化]\r\n// - 問題：Unterminated string literal\r\n// - 指引：補上引號或改為模板字串；避免在字串中混入未轉義的特殊符號。\r\n\r\nimport React, { useRef } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/toolbar.tsx:13 - 清理未使用的導入\r\n// 問題：'Input' 已導入但從未使用\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/issues/issue-details.tsx - 修復語法錯誤（第106行未終止的字串）",
    "details": [
      "說明：修正字串或模板字面量，避免 Lint 解析錯誤"
    ],
    "file": "src\\components\\features\\spaces\\components\\issues\\issue-details.tsx",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/issues/issue-details.tsx - 修復語法錯誤（第106行未終止的字串）\r\n// 說明：修正字串或模板字面量，避免 Lint 解析錯誤\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L109) [低認知][現代化]\r\n// - 問題：Unterminated string literal\r\n// - 指引：補齊字串引號或替換為 '--' 站位，避免註解與程式碼同一行。\r\n\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L109) [低認知][現代化]",
    "details": [
      "- 問題：Unterminated string literal",
      "- 指引：補齊字串引號或替換為 '--' 站位，避免註解與程式碼同一行。"
    ],
    "file": "src\\components\\features\\spaces\\components\\issues\\issue-details.tsx",
    "line": 4,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/issues/issue-details.tsx - 修復語法錯誤（第106行未終止的字串）\r\n// 說明：修正字串或模板字面量，避免 Lint 解析錯誤\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L109) [低認知][現代化]\r\n// - 問題：Unterminated string literal\r\n// - 指引：補齊字串引號或替換為 '--' 站位，避免註解與程式碼同一行。\r\n\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/issues/issue-list.tsx - 修復語法錯誤（第137行未終止的字串）",
    "details": [
      "說明：補齊引號或修正 JSX 文字，確保通過 Lint"
    ],
    "file": "src\\components\\features\\spaces\\components\\issues\\issue-list.tsx",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/issues/issue-list.tsx - 修復語法錯誤（第137行未終止的字串）\r\n// 說明：補齊引號或修正 JSX 文字，確保通過 Lint\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L139) [低認知][現代化]\r\n// - 問題：Unterminated string literal\r\n// - 指引：關閉引號；若文案不明先以 '--' 站位，稍後再補。\r\n\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L139) [低認知][現代化]",
    "details": [
      "- 問題：Unterminated string literal",
      "- 指引：關閉引號；若文案不明先以 '--' 站位，稍後再補。"
    ],
    "file": "src\\components\\features\\spaces\\components\\issues\\issue-list.tsx",
    "line": 4,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/issues/issue-list.tsx - 修復語法錯誤（第137行未終止的字串）\r\n// 說明：補齊引號或修正 JSX 文字，確保通過 Lint\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L139) [低認知][現代化]\r\n// - 問題：Unterminated string literal\r\n// - 指引：關閉引號；若文案不明先以 '--' 站位，稍後再補。\r\n\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/participants/advanced-filters.tsx - 修復語法錯誤（第34行 ',' 缺失）",
    "details": [
      "說明：檢查物件/參數列表逗號缺失與 JSX 分隔"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\advanced-filters.tsx",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/participants/advanced-filters.tsx - 修復語法錯誤（第34行 ',' 缺失）\r\n// 說明：檢查物件/參數列表逗號缺失與 JSX 分隔\r\n/**\r\n * @fileoverview ?�代?��?級�?濾器組件\r\n * ?��?多種?�濾條件?�實?��?�?\r\n */\r\n\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L36) [低認知][現代化]\r\n// - 問題：\",\" expected（可能缺少逗號/括號）\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L36) [低認知][現代化]",
    "details": [
      "- 問題：\",\" expected（可能缺少逗號/括號）",
      "- 指引：補齊分隔符或簡化 props，先確保可解析再優化。"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\advanced-filters.tsx",
    "line": 9,
    "context": " */\r\n\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L36) [低認知][現代化]\r\n// - 問題：\",\" expected（可能缺少逗號/括號）\r\n// - 指引：補齊分隔符或簡化 props，先確保可解析再優化。\r\n\r\nimport React, { useState, useCallback, useMemo } from 'react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/participants/card-grid.tsx - 修復語法錯誤（第123行未終止的字串）",
    "details": [
      "說明：補齊字串/模板字面量，避免解析錯誤"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\card-grid.tsx",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/participants/card-grid.tsx - 修復語法錯誤（第123行未終止的字串）\r\n// 說明：補齊字串/模板字面量，避免解析錯誤\r\n/**\r\n * @fileoverview ?��?式卡?�網?��??��?�?\r\n * 使用?�擬?��?術支?�大?�數?��?高性能渲�?\r\n */\r\n\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L125) [低認知][現代化]\r\n// - 問題：Unterminated string literal\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L125) [低認知][現代化]",
    "details": [
      "- 問題：Unterminated string literal",
      "- 指引：補上結尾引號或用模板字串，避免特殊符號未轉義。"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\card-grid.tsx",
    "line": 9,
    "context": " */\r\n\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L125) [低認知][現代化]\r\n// - 問題：Unterminated string literal\r\n// - 指引：補上結尾引號或用模板字串，避免特殊符號未轉義。\r\n\r\nimport React, { useState, useCallback, useMemo } from 'react';\r\nimport { useVirtualizer } from '@tanstack/react-virtual';\r\nimport { ParticipantCard } from './participant-card';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Typo/Parsing (L81) [低認知]",
    "details": [
      "- 指引：修正參數型別宣告錯字 `_spaceId:`"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\data.ts",
    "line": 81,
    "context": "    },\r\n  ];\r\n\r\n  // TODO: [P0] FIX Typo/Parsing (L81) [低認知]\r\n  // - 指引：修正參數型別宣告錯字 `_spaceId:`\r\n  static async getParticipants(spaceId: _spaceId: string): Promise<Participant[]> {\r\n    // Simulate API call\r\n    await new Promise(resolve => setTimeout(resolve, 100));\r\n    return [...this.participants];\r\n  }\r\n\r\n  // TODO: [P0] FIX Typo/Parsing (L91) [低認知]\r\n  // - 指引：修正可選參數宣告 `message?: _message: string` => `message?: string`\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Typo/Parsing (L91) [低認知]",
    "details": [
      "- 指引：修正可選參數宣告 `message?: _message: string` => `message?: string`"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\data.ts",
    "line": 89,
    "context": "    return [...this.participants];\r\n  }\r\n\r\n  // TODO: [P0] FIX Typo/Parsing (L91) [低認知]\r\n  // - 指引：修正可選參數宣告 `message?: _message: string` => `message?: string`\r\n  static async inviteParticipant(\r\n    spaceId: string,\r\n    email: string,\r\n    role: Participant['role'],\r\n    message?: _message: string\r\n  ): Promise<Participant> {\r\n    // Simulate API call\r\n    await new Promise(resolve => setTimeout(resolve, 500));\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/participants/invite-participant-dialog.tsx - 修復語法錯誤（第98行 Unexpected token）",
    "details": [
      "說明：檢查 JSX 標籤是否缺失閉合或有非法字元"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\invite-participant-dialog.tsx",
    "line": 1,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/participants/invite-participant-dialog.tsx - 修復語法錯誤（第98行 Unexpected token）\r\n// 說明：檢查 JSX 標籤是否缺失閉合或有非法字元\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L100) [低認知][現代化]\r\n// - 問題：Unexpected token（可能需 {'>'} 或 &gt;）\r\n// - 指引：檢查 JSX 標籤閉合，將裸 '>' 轉義為 {'>'}。\r\n\r\nimport { useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L100) [低認知][現代化]",
    "details": [
      "- 問題：Unexpected token（可能需 {'>'} 或 &gt;）",
      "- 指引：檢查 JSX 標籤閉合，將裸 '>' 轉義為 {'>'}。"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\invite-participant-dialog.tsx",
    "line": 4,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/participants/invite-participant-dialog.tsx - 修復語法錯誤（第98行 Unexpected token）\r\n// 說明：檢查 JSX 標籤是否缺失閉合或有非法字元\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L100) [低認知][現代化]\r\n// - 問題：Unexpected token（可能需 {'>'} 或 &gt;）\r\n// - 指引：檢查 JSX 標籤閉合，將裸 '>' 轉義為 {'>'}。\r\n\r\nimport { useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "src/components/features/spaces/components/participants/participant-card.tsx - 修復語法錯誤（第109行 Unexpected token）",
    "details": [
      "說明：檢查 JSX 屬性與標籤閉合，修正不合法符號"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\participant-card.tsx",
    "line": 6,
    "context": " * ?��?式設計�??��??�畫?�交互�???\r\n */\r\n\r\n// TODO: [P0] FIX src/components/features/spaces/components/participants/participant-card.tsx - 修復語法錯誤（第109行 Unexpected token）\r\n// 說明：檢查 JSX 屬性與標籤閉合，修正不合法符號\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L111) [低認知][現代化]\r\n// - 問題：Unexpected token（考慮 {'>'} 或 &gt;）\r\n// - 指引：關閉 JSX 標籤或使用轉義，優先確保可解析。\r\n\r\nimport React, { useCallback } from 'react';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Badge } from '@/components/ui/badge';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L111) [低認知][現代化]",
    "details": [
      "- 問題：Unexpected token（考慮 {'>'} 或 &gt;）",
      "- 指引：關閉 JSX 標籤或使用轉義，優先確保可解析。"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\participant-card.tsx",
    "line": 9,
    "context": "// TODO: [P0] FIX src/components/features/spaces/components/participants/participant-card.tsx - 修復語法錯誤（第109行 Unexpected token）\r\n// 說明：檢查 JSX 屬性與標籤閉合，修正不合法符號\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L111) [低認知][現代化]\r\n// - 問題：Unexpected token（考慮 {'>'} 或 &gt;）\r\n// - 指引：關閉 JSX 標籤或使用轉義，優先確保可解析。\r\n\r\nimport React, { useCallback } from 'react';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from '@/components/ui/dropdown-menu';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L58) [低認知][現代化]",
    "details": [
      "- 問題：Unterminated string literal",
      "- 指引：補上引號或以 '--' 站位，避免混雜未轉義符號。"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\participant-filters.tsx",
    "line": 2,
    "context": "'use client';\r\n// TODO: [P0] FIX Parsing (L58) [低認知][現代化]\r\n// - 問題：Unterminated string literal\r\n// - 指引：補上引號或以 '--' 站位，避免混雜未轉義符號。\r\n\r\nimport { memo } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Search, Filter, X } from 'lucide-react';\r\nimport { ParticipantFiltersProps } from './types';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L67) [低認知][現代化]",
    "details": [
      "- 問題：Unexpected token（可能需 {'>'} 或 &gt;）",
      "- 指引：檢查 JSX 標籤/表格單元，使用 {'>'} 取代裸字符。"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\participant-list.tsx",
    "line": 2,
    "context": "'use client';\r\n// TODO: [P0] FIX Parsing (L67) [低認知][現代化]\r\n// - 問題：Unexpected token（可能需 {'>'} 或 &gt;）\r\n// - 指引：檢查 JSX 標籤/表格單元，使用 {'>'} 取代裸字符。\r\n\r\nimport React, { useEffect, useMemo, useState, useCallback } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Plus, Download, Users, AlertCircle } from 'lucide-react';\r\nimport { useParticipants, useParticipantFilters } from './hooks/use-participants';\r\nimport { VirtualizedTable } from './virtualized-table';\r\nimport { CardGrid } from './card-grid';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L67) [低認知][現代化]",
    "details": [
      "- 問題：Unterminated string literal",
      "- 指引：補齊引號或簡化字串；避免行內註解破壞字串。"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\participant-role-editor.tsx",
    "line": 2,
    "context": "'use client';\r\n// TODO: [P0] FIX Parsing (L67) [低認知][現代化]\r\n// - 問題：Unterminated string literal\r\n// - 指引：補齊引號或簡化字串；避免行內註解破壞字串。\r\n\r\nimport { Button } from '@/components/ui/button';\r\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { useForm } from 'react-hook-form';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L82) [低認知][現代化]",
    "details": [
      "- 問題：Unterminated string literal",
      "- 指引：補上結尾引號；若文案未定以 '--' 站位。"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\participant-table.tsx",
    "line": 2,
    "context": "'use client';\r\n// TODO: [P0] FIX Parsing (L82) [低認知][現代化]\r\n// - 問題：Unterminated string literal\r\n// - 指引：補上結尾引號；若文案未定以 '--' 站位。\r\n\r\nimport { memo, useCallback } from 'react';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r"
  },
  {
    "priority": "P0",
    "type": "FIX",
    "description": "Parsing (L106) [低認知][現代化]",
    "details": [
      "- 問題：Unexpected token（考慮 {'>'} 或 &gt;）",
      "- 指引：檢查 JSX 中的 '>' 與屬性，必要時以 {'>'} 顯示文字箭頭。"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\virtualized-table.tsx",
    "line": 7,
    "context": " */\r\n\r\n'use client';\r\n// TODO: [P0] FIX Parsing (L106) [低認知][現代化]\r\n// - 問題：Unexpected token（考慮 {'>'} 或 &gt;）\r\n// - 指引：檢查 JSX 中的 '>' 與屬性，必要時以 {'>'} 顯示文字箭頭。\r\n\r\nimport React, { useMemo, useCallback, useState } from 'react';\r\nimport { useVirtualizer } from '@tanstack/react-virtual';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r"
  },
  {
    "priority": "P1",
    "type": "PERF",
    "description": "src/app/(app)/layout.tsx:71 - 優化 React hooks 依賴項",
    "details": [
      "問題：organizations 邏輯表達式可能導致 useMemo Hook 依賴項在每次渲染時改變",
      "影響：性能問題，不必要的重新渲染",
      "建議：將 organizations 初始化包裝在獨立的 useMemo Hook 中"
    ],
    "file": "src\\app\\(app)\\layout.tsx",
    "line": 73,
    "assignee": "frontend",
    "deadline": "2025-01-15",
    "context": "  );\n  const organizations = organizationsData || [];\n\n// TODO: [P1] PERF src/app/(app)/layout.tsx:71 - 優化 React hooks 依賴項\n// 問題：organizations 邏輯表達式可能導致 useMemo Hook 依賴項在每次渲染時改變\n// 影響：性能問題，不必要的重新渲染\n// 建議：將 organizations 初始化包裝在獨立的 useMemo Hook 中\n// @assignee frontend-team\n// @deadline 2025-01-15\n\n  const [selectedTeam, setSelectedTeam] = useState<Team | null>(null);\n  \n  const handleSetSelectedTeam = (team: Team) => {"
  },
  {
    "priority": "P1",
    "type": "PERF",
    "description": "src/app/(app)/organizations/[organizationslug]/inventory/page.tsx:122 - 優化 React hooks 依賴項",
    "details": [
      "問題：warehouses 邏輯表達式可能導致 useEffect 和 useMemo Hook 依賴項在每次渲染時改變",
      "影響：性能問題，不必要的重新渲染（影響 lines 150, 176）",
      "建議：將 warehouses 初始化包裝在獨立的 useMemo Hook 中"
    ],
    "file": "src\\app\\(app)\\organizations\\[organizationslug]\\inventory\\page.tsx",
    "line": 127,
    "assignee": "frontend",
    "deadline": "2025-01-15",
    "context": "    useCollection<WarehouseType>(warehousesQuery);\n  const warehouses = warehousesData || [];\n\n// TODO: [P1] PERF src/app/(app)/organizations/[organizationslug]/inventory/page.tsx:122 - 優化 React hooks 依賴項\n// 問題：warehouses 邏輯表達式可能導致 useEffect 和 useMemo Hook 依賴項在每次渲染時改變\n// 影響：性能問題，不必要的重新渲染（影響 lines 150, 176）\n// 建議：將 warehouses 初始化包裝在獨立的 useMemo Hook 中\n// @assignee frontend-team\n// @deadline 2025-01-15\n\n  // Fetch all stock data for all warehouses\n  const [allStock, setAllStock] = useState<Stock[]>([]);\n  const [stockLoading, setStockLoading] = useState(true);"
  },
  {
    "priority": "P1",
    "type": "PERF",
    "description": "src/app/(app)/organizations/[organizationslug]/inventory/[itemId]/page.tsx:95 - 優化 React hooks 依賴項",
    "details": [
      "問題：warehouses 邏輯表達式可能導致 useEffect Hook 依賴項在每次渲染時改變",
      "影響：性能問題，不必要的重新渲染（影響 line 128）",
      "建議：將 warehouses 初始化包裝在獨立的 useMemo Hook 中"
    ],
    "file": "src\\app\\(app)\\organizations\\[organizationslug]\\inventory\\[itemId]\\page.tsx",
    "line": 100,
    "assignee": "frontend",
    "deadline": "2025-01-15",
    "context": "    useCollection<Warehouse>(warehousesQuery);\n  const warehouses = warehousesData || [];\n\n// TODO: [P1] PERF src/app/(app)/organizations/[organizationslug]/inventory/[itemId]/page.tsx:95 - 優化 React hooks 依賴項\n// 問題：warehouses 邏輯表達式可能導致 useEffect Hook 依賴項在每次渲染時改變\n// 影響：性能問題，不必要的重新渲染（影響 line 128）\n// 建議：將 warehouses 初始化包裝在獨立的 useMemo Hook 中\n// @assignee frontend-team\n// @deadline 2025-01-15\n\n  // Get stock for this item across all warehouses\n  const [stockData, setStockData] = useState< (Stock & { warehouseName: string })[] >([]);\n  const [stockLoading, setStockLoading] = useState(true);"
  },
  {
    "priority": "P1",
    "type": "PERF",
    "description": "src/app/(app)/spaces/page.tsx:42 - 優化 React hooks 依賴項",
    "details": [
      "問題：allSpaces 邏輯表達式可能導致多個 useMemo Hook 依賴項在每次渲染時改變",
      "影響：性能問題，不必要的重新渲染（影響 lines 49, 70, 77, 82）",
      "建議：將 allSpaces 初始化包裝在獨立的 useMemo Hook 中"
    ],
    "file": "src\\app\\(app)\\spaces\\page.tsx",
    "line": 47,
    "assignee": "frontend",
    "deadline": "2025-01-15",
    "context": "    useCollection<Space>(allSpacesQuery);\r\n  const allSpaces = allSpacesData || [];\r\n\r\n// TODO: [P1] PERF src/app/(app)/spaces/page.tsx:42 - 優化 React hooks 依賴項\r\n// 問題：allSpaces 邏輯表達式可能導致多個 useMemo Hook 依賴項在每次渲染時改變\r\n// 影響：性能問題，不必要的重新渲染（影響 lines 49, 70, 77, 82）\r\n// 建議：將 allSpaces 初始化包裝在獨立的 useMemo Hook 中\r\n// @assignee frontend-team\r\n// @deadline 2025-01-15\r\n\r\n  const allOwnerIds = useMemo(() => {\r\n    if (allSpaces.length === 0) return [];\r\n    const ids = new Set<string>();\r"
  },
  {
    "priority": "P1",
    "type": "PERF",
    "description": "src/components/auth/auth-provider.tsx:345 - 修復 React Hook 缺失依賴項",
    "details": [
      "問題：useEffect Hook 缺少 'fetchUserRoleAssignment' 依賴項",
      "影響：可能導致過時閉包問題，狀態更新不及時",
      "建議：將 'fetchUserRoleAssignment' 添加到依賴數組中，或移除依賴數組"
    ],
    "file": "src\\components\\auth\\auth-provider.tsx",
    "line": 370,
    "assignee": "frontend",
    "deadline": "2025-01-15",
    "context": "    return () => unsubscribe();\n  }, [auth]);\n\n// TODO: [P1] PERF src/components/auth/auth-provider.tsx:345 - 修復 React Hook 缺失依賴項\n// 問題：useEffect Hook 缺少 'fetchUserRoleAssignment' 依賴項\n// 影響：可能導致過時閉包問題，狀態更新不及時\n// 建議：將 'fetchUserRoleAssignment' 添加到依賴數組中，或移除依賴數組\n// @assignee frontend-team\n// @deadline 2025-01-15\n\n  const value: AuthContext = {\n    ...state,\n    setUser,"
  },
  {
    "priority": "P1",
    "type": "PERF",
    "description": "src/components/auth/role-manager.tsx:123 - 修復 React Hook 缺失依賴項",
    "details": [
      "問題：useEffect Hook 缺少 'loadRoles' 和 'loadUsers' 依賴項",
      "影響：可能導致過時閉包問題，函數更新不及時",
      "建議：將 'loadRoles' 和 'loadUsers' 添加到依賴數組中，或使用 useCallback 包裝函數"
    ],
    "file": "src\\components\\auth\\role-manager.tsx",
    "line": 160,
    "assignee": "frontend",
    "deadline": "2025-01-15",
    "context": "    loadUsers();\n  }, [spaceId]);\n\n// TODO: [P1] PERF src/components/auth/role-manager.tsx:123 - 修復 React Hook 缺失依賴項\n// 問題：useEffect Hook 缺少 'loadRoles' 和 'loadUsers' 依賴項\n// 影響：可能導致過時閉包問題，函數更新不及時\n// 建議：將 'loadRoles' 和 'loadUsers' 添加到依賴數組中，或使用 useCallback 包裝函數\n// @assignee frontend-team\n// @deadline 2025-01-15\n\n  const loadRoles = async () => {\n    setLoading(true);\n    setError(null);"
  },
  {
    "priority": "P1",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/file-explorer.tsx - 簡化過度複雜的組件結構",
    "details": [
      "問題：FileExplorer 組件超過 540 行，違反奧卡姆剃刀原則",
      "影響：維護困難、測試複雜、性能問題",
      "建議：",
      "1) 將組件拆分為更小的單一職責組件",
      "2) 移除多層 Context Provider 嵌套",
      "3) 使用 Next.js 15 Server Components 替代不必要的 Client Components",
      "4) 統一狀態管理，避免 prop drilling"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\file-explorer.tsx",
    "line": 17,
    "assignee": "frontend",
    "deadline": "2025-01-15",
    "context": "// 2) 檢查註解是否破壞字元（如中文全形標點）。\r\n// 3) 保持最小改動，先確保程式可被解析再進行重構。\r\n// 參考：ESLint CLI 與 Next.js ESLint 規範（`next/core-web-vitals`），TypeScript-ESLint parsing 原則。\r\n// TODO: [P1] REFACTOR src/components/features/spaces/components/file-explorer/file-explorer.tsx - 簡化過度複雜的組件結構\r\n// 問題：FileExplorer 組件超過 540 行，違反奧卡姆剃刀原則\r\n// 影響：維護困難、測試複雜、性能問題\r\n// 建議：\r\n// 1) 將組件拆分為更小的單一職責組件\r\n// 2) 移除多層 Context Provider 嵌套\r\n// 3) 使用 Next.js 15 Server Components 替代不必要的 Client Components\r\n// 4) 統一狀態管理，避免 prop drilling\r\n// @assignee frontend-team\r\n// @deadline 2025-01-15\r"
  },
  {
    "priority": "P1",
    "type": "PERF",
    "description": "src/components/features/spaces/hooks/use-file-actions.ts:105 - 修復 React Hook 缺失依賴項",
    "details": [
      "問題：useCallback Hook 缺少 'fileOperations' 依賴項",
      "影響：可能導致過時閉包問題，函數更新不及時",
      "建議：將 'fileOperations' 添加到依賴數組中，或移除依賴數組"
    ],
    "file": "src\\components\\features\\spaces\\hooks\\use-file-actions.ts",
    "line": 107,
    "assignee": "frontend",
    "deadline": "2025-01-15",
    "context": "    }\n  }, [toast]);\n\n// TODO: [P1] PERF src/components/features/spaces/hooks/use-file-actions.ts:105 - 修復 React Hook 缺失依賴項\n// 問題：useCallback Hook 缺少 'fileOperations' 依賴項\n// 影響：可能導致過時閉包問題，函數更新不及時\n// 建議：將 'fileOperations' 添加到依賴數組中，或移除依賴數組\n// @assignee frontend-team\n// @deadline 2025-01-15\n\n  const downloadFile = useCallback(async (\n    fileName: string, \n    spaceId: string, "
  },
  {
    "priority": "P1",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/ - 減少過度抽象的組件層級",
    "details": [
      "問題：70 個文件過度拆分，造成不必要的複雜性",
      "影響：導入路徑過長、維護成本高、認知負擔重",
      "建議：",
      "1) 合併功能相似的組件（如多個 list 組件）",
      "2) 簡化目錄結構，減少嵌套層級",
      "3) 移除不必要的 barrel exports",
      "4) 遵循 Next.js 15 組件組合模式"
    ],
    "file": "src\\components\\features\\spaces\\components\\index.ts",
    "line": 7,
    "assignee": "frontend",
    "deadline": "2025-01-20",
    "context": " * by providing a single, consistent path.\r\n */\r\n\r\n// TODO: [P1] REFACTOR src/components/features/spaces/components/ - 減少過度抽象的組件層級\r\n// 問題：70 個文件過度拆分，造成不必要的複雜性\r\n// 影響：導入路徑過長、維護成本高、認知負擔重\r\n// 建議：\r\n// 1) 合併功能相似的組件（如多個 list 組件）\r\n// 2) 簡化目錄結構，減少嵌套層級\r\n// 3) 移除不必要的 barrel exports\r\n// 4) 遵循 Next.js 15 組件組合模式\r\n// @assignee frontend-team\r\n// @deadline 2025-01-20\r"
  },
  {
    "priority": "P1",
    "type": "REFACTOR",
    "description": "src/app/(app)/layout.tsx - 降低客戶端邊界與狀態複雜度",
    "details": [
      "導向：",
      "1) 盡量保持本檔為瘦客戶端殼層，將資料抓取/權限/聚合移至 Server Components 或 Server Actions。",
      "2) 將重型 UI（Sidebar/Nav 計算）與資料相依分離，採 props 注入；避免在 layout 內多重 useEffect/useMemo 疊加。",
      "3) 使用 App Router 推薦：父層 Server Layout + 子層 Client Providers（參考 Next.js docs: server and client components, use client in provider）。"
    ],
    "file": "src\\app\\(app)\\layout.tsx",
    "line": 2,
    "assignee": "ai",
    "context": "'use client';\n// TODO: [P1] REFACTOR src/app/(app)/layout.tsx - 降低客戶端邊界與狀態複雜度\n// 導向：\n// 1) 盡量保持本檔為瘦客戶端殼層，將資料抓取/權限/聚合移至 Server Components 或 Server Actions。\n// 2) 將重型 UI（Sidebar/Nav 計算）與資料相依分離，採 props 注入；避免在 layout 內多重 useEffect/useMemo 疊加。\n// 3) 使用 App Router 推薦：父層 Server Layout + 子層 Client Providers（參考 Next.js docs: server and client components, use client in provider）。\n// @assignee ai\n\nimport {\n  FirebaseClientProvider,\n  useUser,"
  },
  {
    "priority": "P1",
    "type": "PERF",
    "description": "Hooks deps (L122, L157, L183) [低認知][現代化]",
    "details": [
      "- 問題：'warehouses' 的邏輯表達式導致 useEffect/useMemo 依賴可能每次變更",
      "- 指引：以 useMemo 包裝初始化或將計算移入對應 useMemo/Effect 回呼中。"
    ],
    "file": "src\\app\\(app)\\organizations\\[organizationslug]\\inventory\\page.tsx",
    "line": 2,
    "context": "'use client';\n// TODO: [P1] PERF Hooks deps (L122, L157, L183) [低認知][現代化]\n// - 問題：'warehouses' 的邏輯表達式導致 useEffect/useMemo 依賴可能每次變更\n// - 指引：以 useMemo 包裝初始化或將計算移入對應 useMemo/Effect 回呼中。\n\nimport React, { useMemo, useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { useFirestore, useCollection } from '@/firebase';\nimport { collection, query, where, getDocs } from 'firebase/firestore';\nimport {\n  Breadcrumb,"
  },
  {
    "priority": "P1",
    "type": "PERF",
    "description": "Hooks deps (L95, L135) [低認知][現代化]",
    "details": [
      "- 問題：'warehouses' 的邏輯表達式可能使 useEffect 依賴每次改變",
      "- 指引：用 useMemo 固定引用或把初始化移入 effect 回呼。"
    ],
    "file": "src\\app\\(app)\\organizations\\[organizationslug]\\inventory\\[itemId]\\page.tsx",
    "line": 2,
    "context": "'use client';\n// TODO: [P1] PERF Hooks deps (L95, L135) [低認知][現代化]\n// - 問題：'warehouses' 的邏輯表達式可能使 useEffect 依賴每次改變\n// - 指引：用 useMemo 固定引用或把初始化移入 effect 回呼。\n\nimport React, { useMemo, useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { useFirestore, useDoc, useCollection } from '@/firebase';\nimport {\n  collection,\n  doc,"
  },
  {
    "priority": "P1",
    "type": "PERF",
    "description": "Hooks deps (L42, L56, L77, L84, L89) [低認知]",
    "details": [
      "- 問題：'allSpaces' 邏輯表達式導致 useMemo 依賴變動",
      "- 指引：以 useMemo 包裝初始化或移入對應 useMemo 回呼。"
    ],
    "file": "src\\app\\(app)\\spaces\\page.tsx",
    "line": 2,
    "context": "'use client';\r\n// TODO: [P1] PERF Hooks deps (L42, L56, L77, L84, L89) [低認知]\r\n// - 問題：'allSpaces' 邏輯表達式導致 useMemo 依賴變動\r\n// - 指引：以 useMemo 包裝初始化或移入對應 useMemo 回呼。\r\n\r\nimport { useMemo } from 'react';\r\nimport { collection, query, where, documentId } from 'firebase/firestore';\r\nimport { useUser, useFirestore, useCollection } from '@/firebase';\r\nimport { Button } from '@/components/ui/button';\r\nimport { PlusCircle } from 'lucide-react';\r\nimport { useDialogState } from '@/hooks/use-app-state';\r"
  },
  {
    "priority": "P1",
    "type": "TYPING",
    "description": "no-any (L192, L221) [低認知]",
    "details": [
      "TODO: [P1] HOOK deps (L365) [低認知]",
      "TODO: [P1] REFACTOR src/components/auth/auth-provider.tsx - 縮減責任邊界與資料下傳",
      "原則（Next.js App Router / Firebase）：",
      "- Firestore 聚合轉服務層；Provider 僅保留 userId/effectivePermissions 等最小必要。",
      "- 禁止在 render 期間做 I/O；mutation 走 Server Actions 或明確事件觸發。",
      "- 將 `PermissionGuard` 抽至更小 API（例如 useHasPermission(selector)）以便編譯期 tree-shaking。"
    ],
    "file": "src\\components\\auth\\auth-provider.tsx",
    "line": 9,
    "assignee": "ai",
    "context": "\n'use client';\n// TODO: [P2] CLEANUP unused import (L39) [低認知]\n// TODO: [P1] TYPING no-any (L192, L221) [低認知]\n// TODO: [P1] HOOK deps (L365) [低認知]\n// TODO: [P1] REFACTOR src/components/auth/auth-provider.tsx - 縮減責任邊界與資料下傳\n// 原則（Next.js App Router / Firebase）：\n// - Firestore 聚合轉服務層；Provider 僅保留 userId/effectivePermissions 等最小必要。\n// - 禁止在 render 期間做 I/O；mutation 走 Server Actions 或明確事件觸發。\n// - 將 `PermissionGuard` 抽至更小 API（例如 useHasPermission(selector)）以便編譯期 tree-shaking。\n// @assignee ai\n\n// TODO: [P2] REFACTOR src/components/auth/auth-provider.tsx - 奧卡姆剃刀精簡權限/認證 Provider"
  },
  {
    "priority": "P1",
    "type": "HOOK",
    "description": "deps (L365) [低認知]",
    "details": [
      "TODO: [P1] REFACTOR src/components/auth/auth-provider.tsx - 縮減責任邊界與資料下傳",
      "原則（Next.js App Router / Firebase）：",
      "- Firestore 聚合轉服務層；Provider 僅保留 userId/effectivePermissions 等最小必要。",
      "- 禁止在 render 期間做 I/O；mutation 走 Server Actions 或明確事件觸發。",
      "- 將 `PermissionGuard` 抽至更小 API（例如 useHasPermission(selector)）以便編譯期 tree-shaking。"
    ],
    "file": "src\\components\\auth\\auth-provider.tsx",
    "line": 10,
    "assignee": "ai",
    "context": "'use client';\n// TODO: [P2] CLEANUP unused import (L39) [低認知]\n// TODO: [P1] TYPING no-any (L192, L221) [低認知]\n// TODO: [P1] HOOK deps (L365) [低認知]\n// TODO: [P1] REFACTOR src/components/auth/auth-provider.tsx - 縮減責任邊界與資料下傳\n// 原則（Next.js App Router / Firebase）：\n// - Firestore 聚合轉服務層；Provider 僅保留 userId/effectivePermissions 等最小必要。\n// - 禁止在 render 期間做 I/O；mutation 走 Server Actions 或明確事件觸發。\n// - 將 `PermissionGuard` 抽至更小 API（例如 useHasPermission(selector)）以便編譯期 tree-shaking。\n// @assignee ai\n\n// TODO: [P2] REFACTOR src/components/auth/auth-provider.tsx - 奧卡姆剃刀精簡權限/認證 Provider\n// 建議："
  },
  {
    "priority": "P1",
    "type": "REFACTOR",
    "description": "src/components/auth/auth-provider.tsx - 縮減責任邊界與資料下傳",
    "details": [
      "原則（Next.js App Router / Firebase）：",
      "- Firestore 聚合轉服務層；Provider 僅保留 userId/effectivePermissions 等最小必要。",
      "- 禁止在 render 期間做 I/O；mutation 走 Server Actions 或明確事件觸發。",
      "- 將 `PermissionGuard` 抽至更小 API（例如 useHasPermission(selector)）以便編譯期 tree-shaking。"
    ],
    "file": "src\\components\\auth\\auth-provider.tsx",
    "line": 11,
    "assignee": "ai",
    "context": "// TODO: [P2] CLEANUP unused import (L39) [低認知]\n// TODO: [P1] TYPING no-any (L192, L221) [低認知]\n// TODO: [P1] HOOK deps (L365) [低認知]\n// TODO: [P1] REFACTOR src/components/auth/auth-provider.tsx - 縮減責任邊界與資料下傳\n// 原則（Next.js App Router / Firebase）：\n// - Firestore 聚合轉服務層；Provider 僅保留 userId/effectivePermissions 等最小必要。\n// - 禁止在 render 期間做 I/O；mutation 走 Server Actions 或明確事件觸發。\n// - 將 `PermissionGuard` 抽至更小 API（例如 useHasPermission(selector)）以便編譯期 tree-shaking。\n// @assignee ai\n\n// TODO: [P2] REFACTOR src/components/auth/auth-provider.tsx - 奧卡姆剃刀精簡權限/認證 Provider\n// 建議：\n// 1) 將 Firestore 讀取拆為最小 API（單一 fetchUserRoleAssignment），其餘聚合邏輯移至 service；Provider 僅保存必要狀態。"
  },
  {
    "priority": "P1",
    "type": "HOOK",
    "description": "deps (L156) [低認知]",
    "details": [
      "TODO: [P2] REFACTOR src/components/auth/role-manager.tsx - 避免列表渲染期昂貴操作",
      "建議：",
      "- 將 roles/users 載入改為懶載（按需打開時再查詢）；表格僅顯示前幾個權限，其餘以 lazy 展開。",
      "- 對話框抽成小型子元件或同檔內聯，避免 props 鏈過深；重複邏輯 ≥3 次再抽象。",
      "- 權限檢查改用 `useAuth()` 的單一 selector，移除本檔重複 hasPermission 調用。"
    ],
    "file": "src\\components\\auth\\role-manager.tsx",
    "line": 9,
    "assignee": "ai",
    "context": "\n'use client';\n// TODO: [P2] CLEANUP unused imports/vars (L28, L41, L70, L88, L89, L134) [低認知]\n// TODO: [P1] HOOK deps (L156) [低認知]\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx - 避免列表渲染期昂貴操作\n// 建議：\n// - 將 roles/users 載入改為懶載（按需打開時再查詢）；表格僅顯示前幾個權限，其餘以 lazy 展開。\n// - 對話框抽成小型子元件或同檔內聯，避免 props 鏈過深；重複邏輯 ≥3 次再抽象。\n// - 權限檢查改用 `useAuth()` 的單一 selector，移除本檔重複 hasPermission 調用。\n// @assignee ai\n\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx - 奧卡姆剃刀精簡角色管理\n// 建議："
  },
  {
    "priority": "P1",
    "type": "REFACTOR",
    "description": "src/firebase/provider.tsx - Provider 只做服務注入與極簡使用者狀態",
    "details": [
      "指南：",
      "1) 移除非必要邏輯（如聚合/轉換），避免與授權/角色耦合；與 `components/auth` 分離。",
      "2) 嚴格作為 Client Provider，被 Server Layout 包裹；避免在此放置 UI 或多重副作用。",
      "3) 將錯誤呈現交由上層 global-error，僅維護 user/isUserLoading/userError 的最小狀態。"
    ],
    "file": "src\\firebase\\provider.tsx",
    "line": 2,
    "assignee": "ai",
    "context": "'use client';\n// TODO: [P1] REFACTOR src/firebase/provider.tsx - Provider 只做服務注入與極簡使用者狀態\n// 指南：\n// 1) 移除非必要邏輯（如聚合/轉換），避免與授權/角色耦合；與 `components/auth` 分離。\n// 2) 嚴格作為 Client Provider，被 Server Layout 包裹；避免在此放置 UI 或多重副作用。\n// 3) 將錯誤呈現交由上層 global-error，僅維護 user/isUserLoading/userError 的最小狀態。\n// @assignee ai\n\n\nimport React, { createContext, useContext, ReactNode, useMemo, useState, useEffect } from 'react';\nimport { FirebaseApp } from 'firebase/app';"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/adjust-stock-dialog.tsx:133 - 修復非空斷言警告",
    "details": [
      "問題：使用非空斷言 (!) 可能導致運行時錯誤",
      "影響：類型安全問題，可能導致應用崩潰",
      "建議：添加適當的類型檢查或使用可選鏈操作符"
    ],
    "file": "src\\components\\adjust-stock-dialog.tsx",
    "line": 142,
    "assignee": "frontend",
    "deadline": "2025-01-25",
    "context": "              // 說明：在使用 stockInfo.stockId 前進行存在性檢查，移除非空斷言\r\n              stockDocRef = doc(firestore, 'accounts', organizationId, 'warehouses', warehouseId, 'stock', stockInfo.stockId!);\r\n              \r\n// TODO: [P2] REFACTOR src/components/adjust-stock-dialog.tsx:133 - 修復非空斷言警告\r\n// 問題：使用非空斷言 (!) 可能導致運行時錯誤\r\n// 影響：類型安全問題，可能導致應用崩潰\r\n// 建議：添加適當的類型檢查或使用可選鏈操作符\r\n// @assignee frontend-team\r\n// @deadline 2025-01-25\r\n              batch.update(stockDocRef, { quantity: increment(adjustment) });\r\n          } else {\r\n              // Create a new stock document\r\n              stockDocRef = doc(collection(firestore, 'accounts', organizationId, 'warehouses', warehouseId, 'stock'));\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/auth/auth-provider.tsx:192 - 修復 TypeScript any 類型使用",
    "details": [
      "問題：使用 any 類型違反類型安全原則",
      "影響：失去類型檢查，可能導致運行時錯誤",
      "建議：定義具體的類型接口替代 any 類型"
    ],
    "file": "src\\components\\auth\\auth-provider.tsx",
    "line": 197,
    "assignee": "frontend",
    "deadline": "2025-01-25",
    "context": "      spaceRolesSnapshot.forEach(d => {\n        const data = d.data() as any;\n        \n// TODO: [P2] REFACTOR src/components/auth/auth-provider.tsx:192 - 修復 TypeScript any 類型使用\n// 問題：使用 any 類型違反類型安全原則\n// 影響：失去類型檢查，可能導致運行時錯誤\n// 建議：定義具體的類型接口替代 any 類型\n// @assignee frontend-team\n// @deadline 2025-01-25\n        const ts: Timestamp = data.assignedAt && typeof data.assignedAt.toDate === 'function'\n          ? data.assignedAt as Timestamp\n          : Timestamp.fromDate(new Date());\n        spaceRoles[data.spaceId] = {"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/auth/auth-provider.tsx:221 - 修復 TypeScript any 類型使用",
    "details": [
      "問題：使用 any 類型違反類型安全原則",
      "影響：失去類型檢查，可能導致運行時錯誤",
      "建議：定義具體的類型接口替代 any 類型"
    ],
    "file": "src\\components\\auth\\auth-provider.tsx",
    "line": 226,
    "assignee": "frontend",
    "deadline": "2025-01-25",
    "context": "      orgRolesSnapshot.forEach(d => {\n        const data = d.data() as any;\n        \n// TODO: [P2] REFACTOR src/components/auth/auth-provider.tsx:221 - 修復 TypeScript any 類型使用\n// 問題：使用 any 類型違反類型安全原則\n// 影響：失去類型檢查，可能導致運行時錯誤\n// 建議：定義具體的類型接口替代 any 類型\n// @assignee frontend-team\n// @deadline 2025-01-25\n        const ts: Timestamp = data.assignedAt && typeof data.assignedAt.toDate === 'function'\n          ? data.assignedAt as Timestamp\n          : Timestamp.fromDate(new Date());\n        organizationRoles.push({"
  },
  {
    "priority": "P2",
    "type": "PERF",
    "description": "src/components/features/spaces/components/file-explorer/ - 優化 Client/Server Components 使用",
    "details": [
      "問題：過度使用 Client Components，違反 Next.js 15 最佳實踐",
      "影響：增加 JavaScript bundle 大小、影響首屏性能",
      "建議：",
      "1) 將純展示組件改為 Server Components",
      "2) 使用 Next.js 15 的 'use client' 邊界優化",
      "3) 實現適當的代碼分割和懶加載",
      "4) 使用 React 19 的新特性優化渲染"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\file-explorer.tsx",
    "line": 28,
    "assignee": "performance",
    "deadline": "2025-01-25",
    "context": "// @assignee frontend-team\r\n// @deadline 2025-01-15\r\n\r\n// TODO: [P2] PERF src/components/features/spaces/components/file-explorer/ - 優化 Client/Server Components 使用\r\n// 問題：過度使用 Client Components，違反 Next.js 15 最佳實踐\r\n// 影響：增加 JavaScript bundle 大小、影響首屏性能\r\n// 建議：\r\n// 1) 將純展示組件改為 Server Components\r\n// 2) 使用 Next.js 15 的 'use client' 邊界優化\r\n// 3) 實現適當的代碼分割和懶加載\r\n// 4) 使用 React 19 的新特性優化渲染\r\n// @assignee performance-team\r\n// @deadline 2025-01-25\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/file-table.tsx:76-77 - 修復 TypeScript any 類型使用",
    "details": [
      "問題：使用 any 類型違反類型安全原則",
      "影響：失去類型檢查，可能導致運行時錯誤",
      "建議：定義具體的類型接口替代 any 類型"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\file-table.tsx",
    "line": 80,
    "assignee": "frontend",
    "deadline": "2025-01-25",
    "context": "      let aValue: any;\r\n      let bValue: any;\r\n      \r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/file-table.tsx:76-77 - 修復 TypeScript any 類型使用\r\n// 問題：使用 any 類型違反類型安全原則\r\n// 影響：失去類型檢查，可能導致運行時錯誤\r\n// 建議：定義具體的類型接口替代 any 類型\r\n// @assignee frontend-team\r\n// @deadline 2025-01-25\r\n\r\n      switch (sortField) {\r\n        case 'name':\r\n          aValue = a.name.toLowerCase();\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/filter-panel.tsx:81 - 修復 TypeScript any 類型使用",
    "details": [
      "問題：使用 any 類型違反類型安全原則",
      "影響：失去類型檢查，可能導致運行時錯誤",
      "建議：定義具體的類型接口替代 any 類型"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\filter-panel.tsx",
    "line": 102,
    "assignee": "frontend",
    "deadline": "2025-01-25",
    "context": "\r\n  const handleFilterChange = (key: keyof FilterOptions, value: any) => {\r\n    \r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/filter-panel.tsx:81 - 修復 TypeScript any 類型使用\r\n// 問題：使用 any 類型違反類型安全原則\r\n// 影響：失去類型檢查，可能導致運行時錯誤\r\n// 建議：定義具體的類型接口替代 any 類型\r\n// @assignee frontend-team\r\n// @deadline 2025-01-25\r\n    setFilters(prev => ({ ...prev, [key]: value }));\r\n  };\r\n\r\n  const handleApply = () => {\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/ - 合併重複的組件邏輯",
    "details": [
      "問題：多個 list/card/dialog 組件存在重複邏輯",
      "影響：代碼重複、維護困難、一致性問題",
      "建議：",
      "1) 創建通用的 List/Card/Dialog 基礎組件",
      "2) 使用 TypeScript 泛型提高類型安全",
      "3) 實現組合模式而非繼承",
      "4) 遵循 DRY 原則和奧卡姆剃刀",
      "Spaces feature components exports"
    ],
    "file": "src\\components\\features\\spaces\\components\\index.ts",
    "line": 18,
    "assignee": "frontend",
    "deadline": "2025-01-30",
    "context": "// @assignee frontend-team\r\n// @deadline 2025-01-20\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/ - 合併重複的組件邏輯\r\n// 問題：多個 list/card/dialog 組件存在重複邏輯\r\n// 影響：代碼重複、維護困難、一致性問題\r\n// 建議：\r\n// 1) 創建通用的 List/Card/Dialog 基礎組件\r\n// 2) 使用 TypeScript 泛型提高類型安全\r\n// 3) 實現組合模式而非繼承\r\n// 4) 遵循 DRY 原則和奧卡姆剃刀\r\n// @assignee frontend-team\r\n// @deadline 2025-01-30\r"
  },
  {
    "priority": "P2",
    "type": "PERF",
    "description": "next.config.ts - 實現 Next.js 15 性能優化配置",
    "details": [
      "問題：未充分利用 Next.js 15 的性能優化特性",
      "影響：圖片載入性能差、bundle 大小過大",
      "建議：",
      "1) 啟用 optimizePackageImports 減少 bundle 大小",
      "2) 配置 bundlePagesRouterDependencies 優化依賴打包",
      "3) 添加 experimental.turbo 配置提升開發體驗",
      "4) 配置適當的圖片優化參數"
    ],
    "file": "next.config.ts",
    "line": 12,
    "assignee": "performance",
    "deadline": "2025-02-01",
    "context": "    ignoreDuringBuilds: true,\n  },\n  \n  // TODO: [P2] PERF next.config.ts - 實現 Next.js 15 性能優化配置\n  // 問題：未充分利用 Next.js 15 的性能優化特性\n  // 影響：圖片載入性能差、bundle 大小過大\n  // 建議：\n  // 1) 啟用 optimizePackageImports 減少 bundle 大小\n  // 2) 配置 bundlePagesRouterDependencies 優化依賴打包\n  // 3) 添加 experimental.turbo 配置提升開發體驗\n  // 4) 配置適當的圖片優化參數\n  // @assignee performance-team\n  // @deadline 2025-02-01"
  },
  {
    "priority": "P2",
    "type": "PERF",
    "description": "src/components/ui/file-type-icon.tsx - 實現 Next.js 15 圖片優化最佳實踐",
    "details": [
      "問題：未充分利用 Next.js Image 組件的優化特性",
      "影響：圖片載入性能差、LCP 指標不佳",
      "建議：",
      "1) 使用 next/image 替代所有 <img> 標籤",
      "2) 配置適當的 priority 和 sizes 屬性",
      "3) 實現圖片預載入和懶加載策略",
      "4) 使用 WebP/AVIF 格式優化"
    ],
    "file": "src\\components\\ui\\file-type-icon.tsx",
    "line": 28,
    "assignee": "performance",
    "deadline": "2025-02-01",
    "context": "  FileImage,\n  // TODO: [P2] REFACTOR src/components/ui/file-type-icon.tsx - 清理未使用的導入（useEffect, Image, Video, Music, Archive, Code 未使用）\n  \n// TODO: [P2] PERF src/components/ui/file-type-icon.tsx - 實現 Next.js 15 圖片優化最佳實踐\n// 問題：未充分利用 Next.js Image 組件的優化特性\n// 影響：圖片載入性能差、LCP 指標不佳\n// 建議：\n// 1) 使用 next/image 替代所有 <img> 標籤\n// 2) 配置適當的 priority 和 sizes 屬性\n// 3) 實現圖片預載入和懶加載策略\n// 4) 使用 WebP/AVIF 格式優化\n// @assignee performance-team\n// @deadline 2025-02-01"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/hooks/ - 簡化 hooks 邏輯",
    "details": [
      "問題：多個 hooks 文件可能包含重複邏輯",
      "影響：代碼重複、狀態管理複雜",
      "建議：",
      "1) 合併相似的 hooks 邏輯",
      "2) 使用 React 19 的新 hooks 特性",
      "3) 實現更簡單的狀態管理模式",
      "4) 減少不必要的 useEffect 使用",
      "Spaces feature hooks exports"
    ],
    "file": "src\\components\\features\\spaces\\hooks\\index.ts",
    "line": 7,
    "assignee": "frontend",
    "deadline": "2025-02-05",
    "context": " * hooks, such as those for handling actions, into other components.\r\n */\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/hooks/ - 簡化 hooks 邏輯\r\n// 問題：多個 hooks 文件可能包含重複邏輯\r\n// 影響：代碼重複、狀態管理複雜\r\n// 建議：\r\n// 1) 合併相似的 hooks 邏輯\r\n// 2) 使用 React 19 的新 hooks 特性\r\n// 3) 實現更簡單的狀態管理模式\r\n// 4) 減少不必要的 useEffect 使用\r\n// @assignee frontend-team\r\n// @deadline 2025-02-05\r"
  },
  {
    "priority": "P2",
    "type": "CLEANUP",
    "description": "unused import (L3) [低認知]",
    "details": [
      "- 問題：useCollection 未使用",
      "- 指引：移除未使用匯入或以前綴 _ 命名表示暫未用。"
    ],
    "file": "src\\app\\(app)\\organizations\\[organizationslug]\\roles\\page.tsx",
    "line": 2,
    "context": "'use client';\n// TODO: [P2] CLEANUP unused import (L3) [低認知]\n// - 問題：useCollection 未使用\n// - 指引：移除未使用匯入或以前綴 _ 命名表示暫未用。\n\nimport { useCollection, useFirestore } from '@/firebase';\n\n// TODO: [P2] REFACTOR src/app/(app)/organizations/[organizationslug]/roles/page.tsx:3 - 清理未使用的導入\n// 問題：'useCollection' 已導入但從未使用\n// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/app/(app)/organizations/[organizationslug]/roles/page.tsx:3 - 清理未使用的導入",
    "details": [
      "問題：'useCollection' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\app\\(app)\\organizations\\[organizationslug]\\roles\\page.tsx",
    "line": 8,
    "assignee": "frontend",
    "context": "\nimport { useCollection, useFirestore } from '@/firebase';\n\n// TODO: [P2] REFACTOR src/app/(app)/organizations/[organizationslug]/roles/page.tsx:3 - 清理未使用的導入\n// 問題：'useCollection' 已導入但從未使用\n// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\n// @assignee frontend-team\nimport { collection, query, where, getDocs, limit } from 'firebase/firestore';\nimport React, { useEffect, useState } from 'react';\nimport { RoleList } from '@/components/features/organizations/components/roles';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { type Account } from '@/lib/types-unified';"
  },
  {
    "priority": "P2",
    "type": "CLEANUP",
    "description": "unused arg (L6) [低認知]",
    "details": [
      "- 問題：params 未使用",
      "- 指引：移除參數或以前綴 _ 命名。"
    ],
    "file": "src\\app\\(app)\\organizations\\[organizationslug]\\spaces\\page.tsx",
    "line": 2,
    "context": "'use client';\r\n// TODO: [P2] CLEANUP unused arg (L6) [低認知]\r\n// - 問題：params 未使用\r\n// - 指引：移除參數或以前綴 _ 命名。\r\n\r\nimport { redirect } from 'next/navigation';\r\n\r\nexport default function OrgSpacesPageWrapper({\r\n  params,\r\n}: {\r\n  params: { organizationslug: string };\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/app/(app)/organizations/[organizationslug]/spaces/page.tsx:6 - 清理未使用的參數",
    "details": [
      "問題：'params' 參數已定義但從未使用",
      "影響：代碼可讀性差，可能造成混淆",
      "建議：移除未使用的參數或添加下劃線前綴表示有意未使用",
      "Redirect to unified spaces page"
    ],
    "file": "src\\app\\(app)\\organizations\\[organizationslug]\\spaces\\page.tsx",
    "line": 15,
    "assignee": "frontend",
    "context": "}) {\r\n  // TODO: [P3] REFACTOR src/app/(app)/organizations/[organizationslug]/spaces/page.tsx - 清理未使用的參數（params 未使用）\r\n  \r\n// TODO: [P2] REFACTOR src/app/(app)/organizations/[organizationslug]/spaces/page.tsx:6 - 清理未使用的參數\r\n// 問題：'params' 參數已定義但從未使用\r\n// 影響：代碼可讀性差，可能造成混淆\r\n// 建議：移除未使用的參數或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n  // Redirect to unified spaces page\r\n  redirect('/spaces');\r\n}\r\n"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/app/actions/contracts.ts - 實作合約 AI 分析",
    "details": [
      "說明：整合 Genkit AI 或其他 AI 服務，輸出摘要與風險點"
    ],
    "file": "src\\app\\actions\\contracts.ts",
    "line": 89,
    "context": "\r\nexport async function analyzeContract(spaceId: string, contractId: string) {\r\n  try {\r\n    // TODO: [P2] FEAT src/app/actions/contracts.ts - 實作合約 AI 分析\r\n    // 說明：整合 Genkit AI 或其他 AI 服務，輸出摘要與風險點\r\n    console.log('Analyzing contract:', contractId);\r\n    \r\n    return { success: true, data: { analysis: 'Contract analysis completed' } };\r\n  } catch (error) {\r\n    console.error('Error analyzing contract:', error);\r\n    return { success: false, error: 'Failed to analyze contract' };\r\n  }\r\n}\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/app/actions/contracts.ts - 實作合約 PDF 生成",
    "details": [
      "說明：整合 PDF 生成服務（含標題、雙方、金額、日期、簽名）"
    ],
    "file": "src\\app\\actions\\contracts.ts",
    "line": 102,
    "context": "\r\nexport async function generateContractPDF(spaceId: string, contractId: string) {\r\n  try {\r\n    // TODO: [P2] FEAT src/app/actions/contracts.ts - 實作合約 PDF 生成\r\n    // 說明：整合 PDF 生成服務（含標題、雙方、金額、日期、簽名）\r\n    console.log('Generating PDF for contract:', contractId);\r\n    \r\n    return { success: true, data: { pdfUrl: 'https://example.com/contract.pdf' } };\r\n  } catch (error) {\r\n    console.error('Error generating PDF:', error);\r\n    return { success: false, error: 'Failed to generate PDF' };\r\n  }\r\n}\r"
  },
  {
    "priority": "P2",
    "type": "CLEANUP",
    "description": "unused import/ops (L13, L138) [低認知]",
    "details": [
      "- 指引：移除未使用 setDoc；避免 non-null assertion，改以條件判斷。"
    ],
    "file": "src\\components\\adjust-stock-dialog.tsx",
    "line": 3,
    "context": "\r\n'use client';\r\n// TODO: [P2] CLEANUP unused import/ops (L13, L138) [低認知]\r\n// - 指引：移除未使用 setDoc；避免 non-null assertion，改以條件判斷。\r\n\r\nimport { useMemo, useState, useEffect } from 'react';\r\nimport {\r\n  collection,\r\n  doc,\r\n  getDocs,\r\n  query,\r\n  where,\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/adjust-stock-dialog.tsx:13 - 清理未使用的導入",
    "details": [
      "問題：'setDoc' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\adjust-stock-dialog.tsx",
    "line": 18,
    "assignee": "frontend",
    "context": "  setDoc,\r\n} from 'firebase/firestore';\r\n\r\n// TODO: [P2] REFACTOR src/components/adjust-stock-dialog.tsx:13 - 清理未使用的導入\r\n// 問題：'setDoc' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\nimport { useFirestore } from '@/firebase';\r\nimport { useDialogState } from '@/hooks/use-app-state';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport {\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/adjust-stock-dialog.tsx - 修復非空斷言警告",
    "details": [
      "說明：在使用 stockInfo.stockId 前進行存在性檢查，移除非空斷言"
    ],
    "file": "src\\components\\adjust-stock-dialog.tsx",
    "line": 138,
    "context": "          let stockDocRef;\r\n\r\n  if (hasExistingStockRecord) {\r\n              // TODO: [P2] FIX src/components/adjust-stock-dialog.tsx - 修復非空斷言警告\r\n              // 說明：在使用 stockInfo.stockId 前進行存在性檢查，移除非空斷言\r\n              stockDocRef = doc(firestore, 'accounts', organizationId, 'warehouses', warehouseId, 'stock', stockInfo.stockId!);\r\n              \r\n// TODO: [P2] REFACTOR src/components/adjust-stock-dialog.tsx:133 - 修復非空斷言警告\r\n// 問題：使用非空斷言 (!) 可能導致運行時錯誤\r\n// 影響：類型安全問題，可能導致應用崩潰\r\n// 建議：添加適當的類型檢查或使用可選鏈操作符\r\n// @assignee frontend-team\r\n// @deadline 2025-01-25\r"
  },
  {
    "priority": "P2",
    "type": "CLEANUP",
    "description": "unused import (L39) [低認知]",
    "details": [
      "TODO: [P1] TYPING no-any (L192, L221) [低認知]",
      "TODO: [P1] HOOK deps (L365) [低認知]",
      "TODO: [P1] REFACTOR src/components/auth/auth-provider.tsx - 縮減責任邊界與資料下傳",
      "原則（Next.js App Router / Firebase）：",
      "- Firestore 聚合轉服務層；Provider 僅保留 userId/effectivePermissions 等最小必要。",
      "- 禁止在 render 期間做 I/O；mutation 走 Server Actions 或明確事件觸發。",
      "- 將 `PermissionGuard` 抽至更小 API（例如 useHasPermission(selector)）以便編譯期 tree-shaking。"
    ],
    "file": "src\\components\\auth\\auth-provider.tsx",
    "line": 8,
    "assignee": "ai",
    "context": " */\n\n'use client';\n// TODO: [P2] CLEANUP unused import (L39) [低認知]\n// TODO: [P1] TYPING no-any (L192, L221) [低認知]\n// TODO: [P1] HOOK deps (L365) [低認知]\n// TODO: [P1] REFACTOR src/components/auth/auth-provider.tsx - 縮減責任邊界與資料下傳\n// 原則（Next.js App Router / Firebase）：\n// - Firestore 聚合轉服務層；Provider 僅保留 userId/effectivePermissions 等最小必要。\n// - 禁止在 render 期間做 I/O；mutation 走 Server Actions 或明確事件觸發。\n// - 將 `PermissionGuard` 抽至更小 API（例如 useHasPermission(selector)）以便編譯期 tree-shaking。\n// @assignee ai\n"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/auth/auth-provider.tsx - 奧卡姆剃刀精簡權限/認證 Provider",
    "details": [
      "建議：",
      "1) 將 Firestore 讀取拆為最小 API（單一 fetchUserRoleAssignment），其餘聚合邏輯移至 service；Provider 僅保存必要狀態。",
      "2) 僅暴露最小 API（hasPermission / checkPermission / signIn / signOut），其餘輔助函式封裝內部。",
      "3) 避免渲染期副作用；所有 mutation 綁定事件或 Server Actions；避免將完整使用者資料下傳至 client。"
    ],
    "file": "src\\components\\auth\\auth-provider.tsx",
    "line": 18,
    "context": "// - 將 `PermissionGuard` 抽至更小 API（例如 useHasPermission(selector)）以便編譯期 tree-shaking。\n// @assignee ai\n\n// TODO: [P2] REFACTOR src/components/auth/auth-provider.tsx - 奧卡姆剃刀精簡權限/認證 Provider\n// 建議：\n// 1) 將 Firestore 讀取拆為最小 API（單一 fetchUserRoleAssignment），其餘聚合邏輯移至 service；Provider 僅保存必要狀態。\n// 2) 僅暴露最小 API（hasPermission / checkPermission / signIn / signOut），其餘輔助函式封裝內部。\n// 3) 避免渲染期副作用；所有 mutation 綁定事件或 Server Actions；避免將完整使用者資料下傳至 client。\n\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { \n  Permission, \n  UserRoleAssignment, "
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/auth/auth-provider.tsx:39 - 清理未使用的導入",
    "details": [
      "問題：'getFirestore' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\auth\\auth-provider.tsx",
    "line": 49,
    "assignee": "frontend",
    "context": "  query, \n  where,\n  \n// TODO: [P2] REFACTOR src/components/auth/auth-provider.tsx:39 - 清理未使用的導入\n// 問題：'getFirestore' 已導入但從未使用\n// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\n// @assignee frontend-team \n  getDocs,\n  Timestamp \n} from 'firebase/firestore';\nimport { initializeFirebase } from '@/firebase';\n"
  },
  {
    "priority": "P2",
    "type": "CLEANUP",
    "description": "unused imports/vars (L28, L41, L70, L88, L89, L134) [低認知]",
    "details": [
      "TODO: [P1] HOOK deps (L156) [低認知]",
      "TODO: [P2] REFACTOR src/components/auth/role-manager.tsx - 避免列表渲染期昂貴操作",
      "建議：",
      "- 將 roles/users 載入改為懶載（按需打開時再查詢）；表格僅顯示前幾個權限，其餘以 lazy 展開。",
      "- 對話框抽成小型子元件或同檔內聯，避免 props 鏈過深；重複邏輯 ≥3 次再抽象。",
      "- 權限檢查改用 `useAuth()` 的單一 selector，移除本檔重複 hasPermission 調用。"
    ],
    "file": "src\\components\\auth\\role-manager.tsx",
    "line": 8,
    "assignee": "ai",
    "context": " */\n\n'use client';\n// TODO: [P2] CLEANUP unused imports/vars (L28, L41, L70, L88, L89, L134) [低認知]\n// TODO: [P1] HOOK deps (L156) [低認知]\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx - 避免列表渲染期昂貴操作\n// 建議：\n// - 將 roles/users 載入改為懶載（按需打開時再查詢）；表格僅顯示前幾個權限，其餘以 lazy 展開。\n// - 對話框抽成小型子元件或同檔內聯，避免 props 鏈過深；重複邏輯 ≥3 次再抽象。\n// - 權限檢查改用 `useAuth()` 的單一 selector，移除本檔重複 hasPermission 調用。\n// @assignee ai\n\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx - 奧卡姆剃刀精簡角色管理"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/auth/role-manager.tsx - 避免列表渲染期昂貴操作",
    "details": [
      "建議：",
      "- 將 roles/users 載入改為懶載（按需打開時再查詢）；表格僅顯示前幾個權限，其餘以 lazy 展開。",
      "- 對話框抽成小型子元件或同檔內聯，避免 props 鏈過深；重複邏輯 ≥3 次再抽象。",
      "- 權限檢查改用 `useAuth()` 的單一 selector，移除本檔重複 hasPermission 調用。"
    ],
    "file": "src\\components\\auth\\role-manager.tsx",
    "line": 10,
    "assignee": "ai",
    "context": "'use client';\n// TODO: [P2] CLEANUP unused imports/vars (L28, L41, L70, L88, L89, L134) [低認知]\n// TODO: [P1] HOOK deps (L156) [低認知]\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx - 避免列表渲染期昂貴操作\n// 建議：\n// - 將 roles/users 載入改為懶載（按需打開時再查詢）；表格僅顯示前幾個權限，其餘以 lazy 展開。\n// - 對話框抽成小型子元件或同檔內聯，避免 props 鏈過深；重複邏輯 ≥3 次再抽象。\n// - 權限檢查改用 `useAuth()` 的單一 selector，移除本檔重複 hasPermission 調用。\n// @assignee ai\n\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx - 奧卡姆剃刀精簡角色管理\n// 建議：\n// 1) 合併 Firestore 讀取：批量查詢與最小欄位投影；以單一 hook/context 管理 users/roles 狀態，移除重複 useState。"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/auth/role-manager.tsx - 奧卡姆剃刀精簡角色管理",
    "details": [
      "建議：",
      "1) 合併 Firestore 讀取：批量查詢與最小欄位投影；以單一 hook/context 管理 users/roles 狀態，移除重複 useState。",
      "2) 僅在互動時載入詳情（lazy/load-on-demand），表格只顯示最少欄位；避免在列表渲染時計算聚合。",
      "3) 將對話框組件移至同一檔內的輕量內聯或共用子目錄；重複出現 ≥3 次的表單行為再抽象。",
      "4) 權限判斷集中在 `useAuth()` 暴露的單一 selector，避免在本檔重複 hasPermission。"
    ],
    "file": "src\\components\\auth\\role-manager.tsx",
    "line": 17,
    "context": "// - 權限檢查改用 `useAuth()` 的單一 selector，移除本檔重複 hasPermission 調用。\n// @assignee ai\n\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx - 奧卡姆剃刀精簡角色管理\n// 建議：\n// 1) 合併 Firestore 讀取：批量查詢與最小欄位投影；以單一 hook/context 管理 users/roles 狀態，移除重複 useState。\n// 2) 僅在互動時載入詳情（lazy/load-on-demand），表格只顯示最少欄位；避免在列表渲染時計算聚合。\n// 3) 將對話框組件移至同一檔內的輕量內聯或共用子目錄；重複出現 ≥3 次的表單行為再抽象。\n// 4) 權限判斷集中在 `useAuth()` 暴露的單一 selector，避免在本檔重複 hasPermission。\n\nimport React, { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/auth/role-manager.tsx:28 - 清理未使用的導入",
    "details": [
      "問題：'Switch' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\auth\\role-manager.tsx",
    "line": 32,
    "assignee": "frontend",
    "context": "import { Badge } from '@/components/ui/badge';\nimport { Switch } from '@/components/ui/switch';\n\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx:28 - 清理未使用的導入\n// 問題：'Switch' 已導入但從未使用\n// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\n// @assignee frontend-team\n\nimport { \n  Dialog, \n  DialogContent, \n  DialogHeader, "
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/auth/role-manager.tsx:34 - 清理未使用的導入",
    "details": [
      "問題：'DialogTrigger' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\auth\\role-manager.tsx",
    "line": 46,
    "assignee": "frontend",
    "context": "  DialogTrigger \n} from '@/components/ui/dialog';\n\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx:34 - 清理未使用的導入\n// 問題：'DialogTrigger' 已導入但從未使用\n// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\n// @assignee frontend-team\nimport { \n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/auth/role-manager.tsx:57 - 清理未使用的導入",
    "details": [
      "問題：'Settings' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\auth\\role-manager.tsx",
    "line": 76,
    "assignee": "frontend",
    "context": "  Search\n} from 'lucide-react';\n\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx:57 - 清理未使用的導入\n// 問題：'Settings' 已導入但從未使用\n// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\n// @assignee frontend-team\n\nimport { useAuth } from './auth-provider';\n\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx:61 - 清理未使用的導入\n// 問題：'roleManagementService' 已導入但從未使用"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/auth/role-manager.tsx:61 - 清理未使用的導入",
    "details": [
      "問題：'roleManagementService' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\auth\\role-manager.tsx",
    "line": 84,
    "assignee": "frontend",
    "context": "\nimport { useAuth } from './auth-provider';\n\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx:61 - 清理未使用的導入\n// 問題：'roleManagementService' 已導入但從未使用\n// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\n// @assignee frontend-team\n\nimport { roleManagementService } from '@/lib/role-management';\nimport { Permission, UserRoleAssignment } from '@/lib/types-unified';\n\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx:62 - 清理未使用的導入"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/auth/role-manager.tsx:62 - 清理未使用的導入",
    "details": [
      "問題：'UserRoleAssignment' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\auth\\role-manager.tsx",
    "line": 93,
    "assignee": "frontend",
    "context": "import { roleManagementService } from '@/lib/role-management';\nimport { Permission, UserRoleAssignment } from '@/lib/types-unified';\n\n// TODO: [P2] REFACTOR src/components/auth/role-manager.tsx:62 - 清理未使用的導入\n// 問題：'UserRoleAssignment' 已導入但從未使用\n// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\n// @assignee frontend-team\nimport { \n  getFirestore, \n  collection, \n  doc, \n  getDocs, "
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/contribution-breakdown-chart.tsx:10 - 清理未使用的導入",
    "details": [
      "問題：'Card', 'CardContent', 'CardHeader', 'CardTitle' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\contribution-breakdown-chart.tsx",
    "line": 12,
    "assignee": "frontend",
    "context": "import { PolarAngleAxis, PolarGrid, Radar, RadarChart, ResponsiveContainer } from 'recharts';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\n\r\n// TODO: [P2] REFACTOR src/components/contribution-breakdown-chart.tsx:10 - 清理未使用的導入\r\n// 問題：'Card', 'CardContent', 'CardHeader', 'CardTitle' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\ninterface ContributionData {\r\n    subject: string;\r\n    value: number;\r\n}\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/contracts/contract-list.tsx:15 - 清理未使用的導入",
    "details": [
      "問題：'Filter' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\contracts\\contract-list.tsx",
    "line": 17,
    "assignee": "frontend",
    "context": "import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { FileText, Plus, Calendar, DollarSign, Eye, Edit, Trash2, Search, Filter, X } from 'lucide-react';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/contracts/contract-list.tsx:15 - 清理未使用的導入\r\n// 問題：'Filter' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\nimport { Contract, ContractFilters } from '@/lib/types/contract.types';\r\nimport { useState, useMemo } from 'react';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/contracts/contract-list.tsx:17 - 清理未使用的導入\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/contracts/contract-list.tsx:17 - 清理未使用的導入",
    "details": [
      "問題：'useMemo' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\contracts\\contract-list.tsx",
    "line": 26,
    "assignee": "frontend",
    "context": "import { Contract, ContractFilters } from '@/lib/types/contract.types';\r\nimport { useState, useMemo } from 'react';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/contracts/contract-list.tsx:17 - 清理未使用的導入\r\n// 問題：'useMemo' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { useContracts, useDeleteContract, useAnalyzeContract, useGenerateContractPDF } from '@/hooks/use-contracts';\r\nimport { useDebounce } from 'use-debounce';\r\n\r\ninterface ContractListProps {\r\n  spaceId: string;\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/organizations/components/roles/create-role-dialog.tsx - 實現角色創建 API 調用",
    "details": [],
    "file": "src\\components\\features\\organizations\\components\\roles\\create-role-dialog.tsx",
    "line": 70,
    "context": "  const onSubmit = async (data: RoleFormData) => {\r\n    setIsLoading(true);\r\n    try {\r\n      // TODO: [P2] FEAT src/components/features/organizations/components/roles/create-role-dialog.tsx - 實現角色創建 API 調用\r\n      console.log('Creating role for organization:', organizationId, data);\r\n      // @assignee dev\r\n      \r\n      // Simulate API call\r\n      await new Promise(resolve => setTimeout(resolve, 1000));\r\n      \r\n      reset();\r\n      onOpenChange(false);\r\n    } catch (error) {\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/organizations/components/roles/role-list.tsx - 實現權限更新邏輯",
    "details": [],
    "file": "src\\components\\features\\organizations\\components\\roles\\role-list.tsx",
    "line": 169,
    "context": "  );\r\n\r\n  const handlePermissionToggle = (roleId: string, permission: keyof Role['permissions']) => {\r\n    // TODO: [P2] FEAT src/components/features/organizations/components/roles/role-list.tsx - 實現權限更新邏輯\r\n    console.log(`Toggle ${permission} for role ${roleId}`);\r\n    // @assignee dev\r\n  };\r\n\r\n  const handleAccessLevelChange = (roleId: string, accessLevel: string) => {\r\n    // TODO: [P2] FEAT src/components/features/organizations/components/roles/role-list.tsx - 實現訪問級別更新邏輯\r\n    console.log(`Change access level to ${accessLevel} for role ${roleId}`);\r\n    // @assignee dev\r\n  };\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/organizations/components/roles/role-list.tsx - 實現訪問級別更新邏輯",
    "details": [],
    "file": "src\\components\\features\\organizations\\components\\roles\\role-list.tsx",
    "line": 175,
    "context": "  };\r\n\r\n  const handleAccessLevelChange = (roleId: string, accessLevel: string) => {\r\n    // TODO: [P2] FEAT src/components/features/organizations/components/roles/role-list.tsx - 實現訪問級別更新邏輯\r\n    console.log(`Change access level to ${accessLevel} for role ${roleId}`);\r\n    // @assignee dev\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/acceptance/acceptance-item.tsx:5 - 清理未使用的導入",
    "details": [
      "問題：'Button' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\acceptance\\acceptance-item.tsx",
    "line": 7,
    "assignee": "frontend",
    "context": "import { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/acceptance/acceptance-item.tsx:5 - 清理未使用的導入\r\n// 問題：'Button' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { Separator } from '@/components/ui/separator';\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/acceptance/initiate-acceptance-flow.tsx - 修正 unknown/any 類型",
    "details": [
      "說明：以具名型別替代 unknown，為 acceptance 建立明確型別介面"
    ],
    "file": "src\\components\\features\\spaces\\components\\acceptance\\initiate-acceptance-flow.tsx",
    "line": 29,
    "context": "  spaceId: string;\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  // TODO: [P2] FIX src/components/features/spaces/components/acceptance/initiate-acceptance-flow.tsx - 修正 unknown/any 類型\r\n  // 說明：以具名型別替代 unknown，為 acceptance 建立明確型別介面\r\n  onAcceptanceCreated?: (acceptance: unknown) => void;\r\n}\r\n\r\nexport function InitiateAcceptanceFlow({\r\n  spaceId,\r\n  open,\r\n  onOpenChange,\r\n  onAcceptanceCreated,\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/acceptance/initiate-acceptance-flow.tsx - 實作創建驗收 API 呼叫",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\acceptance\\initiate-acceptance-flow.tsx",
    "line": 57,
    "context": "  const onSubmit = async (data: InitiateAcceptanceFormValues) => {\r\n    setIsLoading(true);\r\n    try {\r\n      // TODO: [P2] FEAT src/components/features/spaces/components/acceptance/initiate-acceptance-flow.tsx - 實作創建驗收 API 呼叫\r\n      console.log('Creating acceptance item:', { spaceId, ...data });\r\n      // @assignee dev\r\n      await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate API call\r\n      \r\n      const newAcceptance = {\r\n        id: Date.now().toString(),\r\n        ...data,\r\n        status: 'pending' as const,\r\n        requester: { id: 'current-user', name: 'Current User' },\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/contracts/contract-details.tsx:3 - 清理未使用的導入",
    "details": [
      "問題：'Avatar', 'AvatarFallback', 'AvatarImage' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\contracts\\contract-details.tsx",
    "line": 5,
    "assignee": "frontend",
    "context": "\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/contracts/contract-details.tsx:3 - 清理未使用的導入\r\n// 問題：'Avatar', 'AvatarFallback', 'AvatarImage' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/contracts/contract-details.tsx:10 - 清理未使用的導入",
    "details": [
      "問題：'Phone' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\contracts\\contract-details.tsx",
    "line": 19,
    "assignee": "frontend",
    "context": "import { Separator } from '@/components/ui/separator';\r\nimport { Calendar, DollarSign, FileText, Mail, Phone, User } from 'lucide-react';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/contracts/contract-details.tsx:10 - 清理未使用的導入\r\n// 問題：'Phone' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { formatDistanceToNow } from 'date-fns';\r\n\r\ninterface Contract {\r\n  id: string;\r\n  title: string;\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/contracts/contract-details.tsx - 實現合約下載邏輯",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\contracts\\contract-details.tsx",
    "line": 110,
    "context": "  };\r\n\r\n  const handleDownload = () => {\r\n    // TODO: [P2] FEAT src/components/features/spaces/components/contracts/contract-details.tsx - 實現合約下載邏輯\r\n    console.log('Downloading contract:', contract.title);\r\n    // @assignee dev\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-4xl max-h-[90vh]\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/contracts/contract-list.tsx - 修復 JSX 語法錯誤（第317行未閉合標籤或無效字元）",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\contracts\\contract-list.tsx",
    "line": 3,
    "context": "'use client';\r\n\r\n// TODO: [P2] FIX src/components/features/spaces/components/contracts/contract-list.tsx - 修復 JSX 語法錯誤（第317行未閉合標籤或無效字元）\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { FileText, Plus, Search, Filter, Calendar, DollarSign } from 'lucide-react';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/contracts/contract-list.tsx:10 - 清理未使用的導入\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/contracts/contract-list.tsx:10 - 清理未使用的導入",
    "details": [
      "問題：'FileText', 'DollarSign' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用",
      "TODO: [P2] REFACTOR src/components/features/spaces/components/contracts/contract-list.tsx - 奧卡姆剃刀精簡列表",
      "建議：",
      "1) 將統計（total/pending/active）移至 memo 或上層 hook，避免在渲染期反覆計算。",
      "2) 類型圖示以 CSS/variant 取代多分支；最小化 UI 條件分支。",
      "3) 詳情 `ContractDetails` 採 lazy import（動態載入），減少首屏負擔。"
    ],
    "file": "src\\components\\features\\spaces\\components\\contracts\\contract-list.tsx",
    "line": 12,
    "assignee": "frontend",
    "context": "import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { FileText, Plus, Search, Filter, Calendar, DollarSign } from 'lucide-react';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/contracts/contract-list.tsx:10 - 清理未使用的導入\r\n// 問題：'FileText', 'DollarSign' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/contracts/contract-list.tsx - 奧卡姆剃刀精簡列表\r\n// 建議：\r\n// 1) 將統計（total/pending/active）移至 memo 或上層 hook，避免在渲染期反覆計算。\r\n// 2) 類型圖示以 CSS/variant 取代多分支；最小化 UI 條件分支。\r\n// 3) 詳情 `ContractDetails` 採 lazy import（動態載入），減少首屏負擔。\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/contracts/contract-list.tsx - 奧卡姆剃刀精簡列表",
    "details": [
      "建議：",
      "1) 將統計（total/pending/active）移至 memo 或上層 hook，避免在渲染期反覆計算。",
      "2) 類型圖示以 CSS/variant 取代多分支；最小化 UI 條件分支。",
      "3) 詳情 `ContractDetails` 採 lazy import（動態載入），減少首屏負擔。"
    ],
    "file": "src\\components\\features\\spaces\\components\\contracts\\contract-list.tsx",
    "line": 17,
    "context": "// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/contracts/contract-list.tsx - 奧卡姆剃刀精簡列表\r\n// 建議：\r\n// 1) 將統計（total/pending/active）移至 memo 或上層 hook，避免在渲染期反覆計算。\r\n// 2) 類型圖示以 CSS/variant 取代多分支；最小化 UI 條件分支。\r\n// 3) 詳情 `ContractDetails` 採 lazy import（動態載入），減少首屏負擔。\r\nimport { CreateContractDialog } from './create-contract-dialog';\r\nimport { ContractDetails } from './contract-details';\r\nimport { useState } from 'react';\r\n\r\ninterface Contract {\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/contracts/create-contract-dialog.tsx - 修正 unknown/any 類型",
    "details": [
      "說明：以具名型別替代 unknown，為 contract 建立明確型別介面"
    ],
    "file": "src\\components\\features\\spaces\\components\\contracts\\create-contract-dialog.tsx",
    "line": 36,
    "context": "  spaceId: string;\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  // TODO: [P2] FIX src/components/features/spaces/components/contracts/create-contract-dialog.tsx - 修正 unknown/any 類型\r\n  // 說明：以具名型別替代 unknown，為 contract 建立明確型別介面\r\n  onContractCreated?: (contract: unknown) => void;\r\n}\r\n\r\nexport function CreateContractDialog({\r\n  spaceId,\r\n  open,\r\n  onOpenChange,\r\n  onContractCreated,\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/contracts/create-contract-dialog.tsx - 實作創建合約 API 呼叫",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\contracts\\create-contract-dialog.tsx",
    "line": 71,
    "context": "  const onSubmit = async (data: CreateContractFormValues) => {\r\n    setIsLoading(true);\r\n    try {\r\n      // TODO: [P2] FEAT src/components/features/spaces/components/contracts/create-contract-dialog.tsx - 實作創建合約 API 呼叫\r\n      console.log('Creating contract:', { spaceId, ...data });\r\n      // @assignee dev\r\n      await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate API call\r\n      \r\n      const newContract = {\r\n        id: Date.now().toString(),\r\n        ...data,\r\n        startDate: new Date(data.startDate),\r\n        endDate: data.endDate ? new Date(data.endDate) : undefined,\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/file-explorer/context-menu.tsx - 修復字符串字面量錯誤（第126行未終止）",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\context-menu.tsx",
    "line": 7,
    "context": " * selected item. A separate context menu for the toolbar is also defined here.\r\n */\r\n'use client';\r\n// TODO: [P2] FIX src/components/features/spaces/components/file-explorer/context-menu.tsx - 修復字符串字面量錯誤（第126行未終止）\r\n\r\nimport React from 'react';\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu';\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/file-explorer/deleted-items.tsx - 修復字符串字面量錯誤（第50行未終止）",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\deleted-items.tsx",
    "line": 8,
    "context": " * file explorer toolbar.\r\n */\r\n'use client';\r\n// TODO: [P2] FIX src/components/features/spaces/components/file-explorer/deleted-items.tsx - 修復字符串字面量錯誤（第50行未終止）\r\n\r\nimport React, { useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Trash2, RotateCcw, Trash, Calendar, User } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport { type FileItem } from './folder-tree';\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/file-explorer/detail/file-detail-view.tsx - 修復字符串字面量錯誤（第75行未終止）",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\detail\\file-detail-view.tsx",
    "line": 6,
    "context": " * in a side panel. Integrates with Context7 file viewing libraries.\r\n */\r\n'use client';\r\n// TODO: [P2] FIX src/components/features/spaces/components/file-explorer/detail/file-detail-view.tsx - 修復字符串字面量錯誤（第75行未終止）\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Separator } from '@/components/ui/separator';\r\nimport { cn } from '@/lib/utils';\r\nimport { \r\n  Download, \r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/file-explorer/empty-folder-state.tsx - 修復字符串字面量錯誤（第31行未終止）",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\empty-folder-state.tsx",
    "line": 8,
    "context": " * for new or empty directories.\r\n */\r\n'use client';\r\n// TODO: [P2] FIX src/components/features/spaces/components/file-explorer/empty-folder-state.tsx - 修復字符串字面量錯誤（第31行未終止）\r\n\r\nimport React from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { UploadCloud, FolderOpen } from 'lucide-react';\r\n\r\ninterface EmptyFolderStateProps {\r\n  onUpload: () => void;\r\n  folderName?: string;\r\n}\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/file-table.tsx:29 - 清理未使用的導入",
    "details": [
      "問題：'FolderOpen' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\file-table.tsx",
    "line": 28,
    "assignee": "frontend",
    "context": "  FolderOpen\r\n} from 'lucide-react';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/file-table.tsx:29 - 清理未使用的導入\r\n// 問題：'FolderOpen' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { cn } from '@/lib/utils';\r\nimport { type FileItem } from './folder-tree';\r\nimport { ColumnSettingsMenu, type ColumnConfig } from './column-settings-menu';\r\n\r\ninterface FileTableProps {\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/filter-panel.tsx:27 - 清理未使用的導入",
    "details": [
      "問題：'Filter' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\filter-panel.tsx",
    "line": 35,
    "assignee": "frontend",
    "context": "  Plus\r\n} from 'lucide-react';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/filter-panel.tsx:27 - 清理未使用的導入\r\n// 問題：'Filter' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/filter-panel.tsx:29 - 清理未使用的導入\r\n// 問題：'Save' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/filter-panel.tsx:29 - 清理未使用的導入",
    "details": [
      "問題：'Save' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\filter-panel.tsx",
    "line": 41,
    "assignee": "frontend",
    "context": "// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/filter-panel.tsx:29 - 清理未使用的導入\r\n// 問題：'Save' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\nimport { cn } from '@/lib/utils';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/filter-panel.tsx:34 - 清理未使用的導入\r\n// 問題：'cn' 已導入但從未使用\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/filter-panel.tsx:34 - 清理未使用的導入",
    "details": [
      "問題：'cn' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\filter-panel.tsx",
    "line": 49,
    "assignee": "frontend",
    "context": "\r\nimport { cn } from '@/lib/utils';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/filter-panel.tsx:34 - 清理未使用的導入\r\n// 問題：'cn' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { format } from 'date-fns';\r\nimport { zhTW } from 'date-fns/locale';\r\n\r\nexport interface FilterOptions {\r\n  searchQuery: string;\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/folder-tree.tsx:12 - 清理未使用的導入",
    "details": [
      "問題：'Button' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\folder-tree.tsx",
    "line": 14,
    "assignee": "frontend",
    "context": "import React, { useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/folder-tree.tsx:12 - 清理未使用的導入\r\n// 問題：'Button' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { \r\n  ChevronRight, \r\n  ChevronDown, \r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/thumbnail/file-thumbnail-grid.tsx:9 - 清理未使用的導入",
    "details": [
      "問題：'useMemo' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\thumbnail\\file-thumbnail-grid.tsx",
    "line": 11,
    "assignee": "frontend",
    "context": "\r\nimport React, { useState, useEffect, useMemo, useRef } from 'react';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/thumbnail/file-thumbnail-grid.tsx:9 - 清理未使用的導入\r\n// 問題：'useMemo' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { useVirtualizer } from '@tanstack/react-virtual';\r\nimport { cn } from '@/lib/utils';\r\nimport { FileThumbnailCard } from './file-thumbnail-card';\r\nimport { type FileItem } from '../folder-tree';\r\n\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/toolbar.tsx:13 - 清理未使用的導入",
    "details": [
      "問題：'Input' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\toolbar.tsx",
    "line": 18,
    "assignee": "frontend",
    "context": "import { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/toolbar.tsx:13 - 清理未使用的導入\r\n// 問題：'Input' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/upload-dialog.tsx:12 - 清理未使用的導入",
    "details": [
      "問題：'Input' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\upload-dialog.tsx",
    "line": 14,
    "assignee": "frontend",
    "context": "import { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Input } from '@/components/ui/input';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/upload-dialog.tsx:12 - 清理未使用的導入\r\n// 問題：'Input' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { Label } from '@/components/ui/label';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { \r\n  Upload, \r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/version-history-drawer.tsx:12 - 清理未使用的導入",
    "details": [
      "問題：'Avatar', 'AvatarFallback' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\version-history-drawer.tsx",
    "line": 14,
    "assignee": "frontend",
    "context": "import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Avatar, AvatarFallback } from '@/components/ui/avatar';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/version-history-drawer.tsx:12 - 清理未使用的導入\r\n// 問題：'Avatar', 'AvatarFallback' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { \r\n  X, \r\n  FileText, \r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/version-history-drawer.tsx:19 - 清理未使用的導入",
    "details": [
      "問題：'User' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\version-history-drawer.tsx",
    "line": 29,
    "assignee": "frontend",
    "context": "  User\r\n} from 'lucide-react';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/version-history-drawer.tsx:19 - 清理未使用的導入\r\n// 問題：'User' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\nimport { cn } from '@/lib/utils';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/version-history-drawer.tsx:21 - 清理未使用的導入\r\n// 問題：'cn' 已導入但從未使用\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/file-explorer/version-history-drawer.tsx:21 - 清理未使用的導入",
    "details": [
      "問題：'cn' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\file-explorer\\version-history-drawer.tsx",
    "line": 37,
    "assignee": "frontend",
    "context": "\r\nimport { cn } from '@/lib/utils';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/file-explorer/version-history-drawer.tsx:21 - 清理未使用的導入\r\n// 問題：'cn' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\nexport interface VersionItem {\r\n  id: string;\r\n  version: string;\r\n  name: string;\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/issues/create-issue-form.tsx - 修正 unknown/any 類型",
    "details": [
      "說明：以具名型別替代 unknown，為 issue 建立明確型別介面"
    ],
    "file": "src\\components\\features\\spaces\\components\\issues\\create-issue-form.tsx",
    "line": 29,
    "context": "  spaceId: string;\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  // TODO: [P2] FIX src/components/features/spaces/components/issues/create-issue-form.tsx - 修正 unknown/any 類型\r\n  // 說明：以具名型別替代 unknown，為 issue 建立明確型別介面\r\n  onIssueCreated?: (issue: unknown) => void;\r\n}\r\n\r\nexport function CreateIssueForm({ spaceId, open, onOpenChange, onIssueCreated }: CreateIssueFormProps) {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const form = useForm<CreateIssueFormValues>({\r\n    resolver: zodResolver(createIssueSchema),\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/issues/create-issue-form.tsx - 實作創建問題 API 呼叫",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\issues\\create-issue-form.tsx",
    "line": 52,
    "context": "  const onSubmit = async (data: CreateIssueFormValues) => {\r\n    setIsLoading(true);\r\n    try {\r\n      // TODO: [P2] FEAT src/components/features/spaces/components/issues/create-issue-form.tsx - 實作創建問題 API 呼叫\r\n      console.log('Creating issue:', { spaceId, ...data });\r\n      // @assignee dev\r\n      await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate API call\r\n      \r\n      const newIssue = {\r\n        id: Date.now().toString(),\r\n        ...data,\r\n        status: 'open' as const,\r\n        reporter: { id: 'current-user', name: 'Current User' },\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/overview/hooks/use-dashboard-data.ts - 替換為實際的 API 調用",
    "details": [
      "這裡使用模擬數據"
    ],
    "file": "src\\components\\features\\spaces\\components\\overview\\hooks\\use-dashboard-data.ts",
    "line": 41,
    "assignee": "dev",
    "context": "\r\n  // 獲取儀表板統計數據\r\n  const fetchStats = useCallback(async (): Promise<DashboardStats> => {\r\n    // TODO: [P2] FEAT src/components/features/spaces/components/overview/hooks/use-dashboard-data.ts - 替換為實際的 API 調用\r\n    // 這裡使用模擬數據\r\n    // @assignee dev\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        resolve({\r\n          members: Math.floor(Math.random() * 50) + 10,\r\n          files: Math.floor(Math.random() * 200) + 50,\r\n          issues: Math.floor(Math.random() * 20) + 2,\r\n          lastActivity: '2 hours ago',\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/overview/hooks/use-dashboard-data.ts - 替換為實際的 API 調用",
    "details": [
      "這裡使用模擬數據"
    ],
    "file": "src\\components\\features\\spaces\\components\\overview\\hooks\\use-dashboard-data.ts",
    "line": 60,
    "assignee": "dev",
    "context": "\r\n  // 獲取活動數據\r\n  const fetchActivities = useCallback(async (): Promise<ActivityItem[]> => {\r\n    // TODO: [P2] FEAT src/components/features/spaces/components/overview/hooks/use-dashboard-data.ts - 替換為實際的 API 調用\r\n    // 這裡使用模擬數據\r\n    // @assignee dev\r\n    return new Promise((resolve) => {\r\n      setTimeout(() => {\r\n        const mockActivities: ActivityItem[] = [\r\n          {\r\n            id: '1',\r\n            type: 'file_upload',\r\n            user: 'John Doe',\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/overview/recent-activity.tsx - 修正 unknown/any 類型",
    "details": [
      "說明：定義 metadata 結構或使用更嚴格的型別映射"
    ],
    "file": "src\\components\\features\\spaces\\components\\overview\\recent-activity.tsx",
    "line": 17,
    "context": "  };\r\n  description: string;\r\n  timestamp: Date;\r\n  // TODO: [P2] FIX src/components/features/spaces/components/overview/recent-activity.tsx - 修正 unknown/any 類型\r\n  // 說明：定義 metadata 結構或使用更嚴格的型別映射\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\ninterface RecentActivityProps {\r\n  spaceId: string;\r\n  activities?: ActivityItem[];\r\n}\r\n\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/overview/types.ts - 修正 unknown/any 類型（定義 metadata 結構）",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\overview\\types.ts",
    "line": 41,
    "context": "  };\r\n  description: string;\r\n  timestamp: Date;\r\n  // TODO: [P2] FIX src/components/features/spaces/components/overview/types.ts - 修正 unknown/any 類型（定義 metadata 結構）\r\n  metadata?: Record<string, unknown>;\r\n  status?: 'completed' | 'pending' | 'failed';\r\n}\r\n\r\nexport interface DashboardStats {\r\n  members: number;\r\n  files: number;\r\n  issues: number;\r\n  lastActivity: string;\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/participants/invite-participant-dialog.tsx - 顯示錯誤提示",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\participants\\invite-participant-dialog.tsx",
    "line": 59,
    "assignee": "dev",
    "context": "      onOpenChange(false);\r\n    } catch (error) {\r\n      console.error('Failed to invite participant:', error);\r\n      // TODO: [P2] FEAT src/components/features/spaces/components/participants/invite-participant-dialog.tsx - 顯示錯誤提示\r\n      // @assignee dev\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"sm:max-w-[425px]\">\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/participants/participant-role-editor.tsx - 實現角色變更 API 調用",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\participants\\participant-role-editor.tsx",
    "line": 50,
    "context": "  const onSubmit = async (data: RoleFormValues) => {\r\n    setIsLoading(true);\r\n    try {\r\n      // TODO: [P2] FEAT src/components/features/spaces/components/participants/participant-role-editor.tsx - 實現角色變更 API 調用\r\n      console.log('Changing role:', { participantId, newRole: data.role });\r\n      // @assignee dev\r\n      await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate API call\r\n      onRoleChange?.(participantId, data.role);\r\n      onOpenChange(false);\r\n    } catch (error) {\r\n      console.error('Failed to change role:', error);\r\n    } finally {\r\n      setIsLoading(false);\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/participants/participant-table.tsx - 打開角色更新對話框",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\participants\\participant-table.tsx",
    "line": 145,
    "context": "  }, [actions]);\r\n\r\n  const handleUpdateRole = useCallback((participantId: string) => {\r\n    // TODO: [P2] FEAT src/components/features/spaces/components/participants/participant-table.tsx - 打開角色更新對話框\r\n    console.log('Update role for participant:', participantId);\r\n    // @assignee dev\r\n  }, []);\r\n\r\n  const handleRemove = useCallback((participantId: string) => {\r\n    if (confirm('確定要移除此成員嗎？')) {\r\n      actions.onRemove(participantId);\r\n    }\r\n  }, [actions]);\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/participants/view-toggle.tsx:9 - 清理未使用的導入",
    "details": [
      "問題：'Button' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\participants\\view-toggle.tsx",
    "line": 10,
    "assignee": "frontend",
    "context": "\r\nimport React from 'react';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/participants/view-toggle.tsx:9 - 清理未使用的導入\r\n// 問題：'Button' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { ToggleGroup, ToggleGroupItem } from '@/components/ui/toggle-group';\r\nimport { Table, Grid3X3, List } from 'lucide-react';\r\nimport { ViewMode } from './types';\r\n\r\ninterface ViewToggleProps {\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/participants/virtualized-table.tsx - 實現編輯對話框",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\participants\\virtualized-table.tsx",
    "line": 216,
    "context": "  const handleAction = useCallback((action: string, participantId: string) => {\r\n    switch (action) {\r\n      case 'edit':\r\n        // TODO: [P2] FEAT src/components/features/spaces/components/participants/virtualized-table.tsx - 實現編輯對話框\r\n        console.log('編輯?�員:', participantId);\r\n        break;\r\n      case 'role':\r\n        // TODO: [P2] FEAT src/components/features/spaces/components/participants/virtualized-table.tsx - 實現角色變更對話框\r\n        console.log('變更角色:', participantId);\r\n        break;\r\n      case 'remove':\r\n        if (confirm('確定要移除此成員嗎？')) {\r\n          actions.onRemove(participantId);\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/participants/virtualized-table.tsx - 實現角色變更對話框",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\participants\\virtualized-table.tsx",
    "line": 220,
    "context": "        console.log('編輯?�員:', participantId);\r\n        break;\r\n      case 'role':\r\n        // TODO: [P2] FEAT src/components/features/spaces/components/participants/virtualized-table.tsx - 實現角色變更對話框\r\n        console.log('變更角色:', participantId);\r\n        break;\r\n      case 'remove':\r\n        if (confirm('確定要移除此成員嗎？')) {\r\n          actions.onRemove(participantId);\r\n        }\r\n        break;\r\n    }\r\n  }, [actions]);\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/quality/checklist.tsx:4 - 清理未使用的導入",
    "details": [
      "問題：'Button' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\quality\\checklist.tsx",
    "line": 6,
    "assignee": "frontend",
    "context": "import { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/quality/checklist.tsx:4 - 清理未使用的導入\r\n// 問題：'Button' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { Separator } from '@/components/ui/separator';\r\nimport { CheckCircle, Circle, Clock, AlertCircle } from 'lucide-react';\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/quality/create-checklist-template.tsx - 修正 unknown/any 類型",
    "details": [
      "說明：以具名型別替代 unknown，為 template 建立明確型別介面"
    ],
    "file": "src\\components\\features\\spaces\\components\\quality\\create-checklist-template.tsx",
    "line": 33,
    "context": "  spaceId: string;\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  // TODO: [P2] FIX src/components/features/spaces/components/quality/create-checklist-template.tsx - 修正 unknown/any 類型\r\n  // 說明：以具名型別替代 unknown，為 template 建立明確型別介面\r\n  onTemplateCreated?: (template: unknown) => void;\r\n}\r\n\r\nexport function CreateChecklistTemplate({\r\n  spaceId,\r\n  open,\r\n  onOpenChange,\r\n  onTemplateCreated,\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/quality/create-checklist-template.tsx - 實現創建模板 API 調用",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\quality\\create-checklist-template.tsx",
    "line": 71,
    "context": "  const onSubmit = async (data: ChecklistTemplateFormValues) => {\r\n    setIsLoading(true);\r\n    try {\r\n      // TODO: [P2] FEAT src/components/features/spaces/components/quality/create-checklist-template.tsx - 實現創建模板 API 調用\r\n      console.log('Creating checklist template:', { spaceId, ...data });\r\n      // @assignee dev\r\n      await new Promise(resolve => setTimeout(resolve, 1000)); // Simulate API call\r\n      \r\n      const newTemplate = {\r\n        id: Date.now().toString(),\r\n        ...data,\r\n        createdAt: new Date(),\r\n        createdBy: 'current-user',\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/components/features/spaces/components/report/create-report-dialog.tsx - 修正 unknown/any 類型",
    "details": [
      "說明：以具名型別替代 unknown，為 report 建立明確型別介面"
    ],
    "file": "src\\components\\features\\spaces\\components\\report\\create-report-dialog.tsx",
    "line": 36,
    "context": "  spaceId: string;\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  // TODO: [P2] FIX src/components/features/spaces/components/report/create-report-dialog.tsx - 修正 unknown/any 類型\r\n  // 說明：以具名型別替代 unknown，為 report 建立明確型別介面\r\n  onReportCreated?: (report: unknown) => void;\r\n}\r\n\r\nexport function CreateReportDialog({\r\n  spaceId,\r\n  open,\r\n  onOpenChange,\r\n  onReportCreated,\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/report/create-report-dialog.tsx - 實現創建報告 API 調用",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\report\\create-report-dialog.tsx",
    "line": 70,
    "context": "  const onSubmit = async (data: CreateReportFormValues) => {\r\n    setIsLoading(true);\r\n    try {\r\n      // TODO: [P2] FEAT src/components/features/spaces/components/report/create-report-dialog.tsx - 實現創建報告 API 調用\r\n      console.log('Creating report:', { spaceId, ...data });\r\n      // @assignee dev\r\n      await new Promise(resolve => setTimeout(resolve, 2000)); // Simulate API call\r\n      \r\n      const newReport = {\r\n        id: Date.now().toString(),\r\n        ...data,\r\n        status: 'generating' as const,\r\n        createdAt: new Date(),\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/report/report-dashboard.tsx - 實現實際下載邏輯",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\report\\report-dashboard.tsx",
    "line": 124,
    "context": "\r\n  const handleDownload = (report: Report) => {\r\n    if (report.downloadUrl) {\r\n      // TODO: [P2] FEAT src/components/features/spaces/components/report/report-dashboard.tsx - 實現實際下載邏輯\r\n      console.log('Downloading report:', report.title);\r\n      // @assignee dev\r\n      window.open(report.downloadUrl, '_blank');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/report/report-viewer.tsx:3 - 清理未使用的導入",
    "details": [
      "問題：'Avatar', 'AvatarFallback', 'AvatarImage' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\report\\report-viewer.tsx",
    "line": 5,
    "assignee": "frontend",
    "context": "\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/report/report-viewer.tsx:3 - 清理未使用的導入\r\n// 問題：'Avatar', 'AvatarFallback', 'AvatarImage' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport { Separator } from '@/components/ui/separator';\r"
  },
  {
    "priority": "P2",
    "type": "FEAT",
    "description": "src/components/features/spaces/components/report/report-viewer.tsx - 實現實際下載邏輯",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\report\\report-viewer.tsx",
    "line": 84,
    "context": "\r\n  const handleDownload = () => {\r\n    if (report.downloadUrl) {\r\n      // TODO: [P2] FEAT src/components/features/spaces/components/report/report-viewer.tsx - 實現實際下載邏輯\r\n      console.log('Downloading report:', report.title);\r\n      // @assignee dev\r\n      window.open(report.downloadUrl, '_blank');\r\n    }\r\n  };\r\n\r\n  // Mock report content based on type\r\n  const getReportContent = () => {\r\n    switch (report.type) {\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/spaces-list-view.tsx:27 - 清理未使用的導入",
    "details": [
      "問題：'cn' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\features\\spaces\\components\\spaces-list-view.tsx",
    "line": 29,
    "assignee": "frontend",
    "context": "import { Skeleton } from '@/components/ui/skeleton';\r\nimport { cn } from '@/lib/utils';\r\n\r\n// TODO: [P2] REFACTOR src/components/features/spaces/components/spaces-list-view.tsx:27 - 清理未使用的導入\r\n// 問題：'cn' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport {\r\n  Tabs,\r\n  TabsContent,\r\n  TabsList,\r\n  TabsTrigger,\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/hooks/use-file-actions.ts - 奧卡姆剃刀精簡檔案動作 Hook",
    "details": [
      "建議：",
      "1) 將 fileOperations 相關依賴集中於單一 factory/context，移除多處 useCallback 依賴項導致的 hooks 警告。",
      "2) 僅回傳實際用到的最小 API（如 download/preview/delete），避免暴露整包操作以降低重渲染。",
      "3) 針對重複邏輯（權限/錯誤處理/Toast）抽為 util，避免每個 action 內重複。"
    ],
    "file": "src\\components\\features\\spaces\\hooks\\use-file-actions.ts",
    "line": 8,
    "context": " * and errors. This simplifies file management logic in the UI components.\n */\n'use client';\n// TODO: [P2] REFACTOR src/components/features/spaces/hooks/use-file-actions.ts - 奧卡姆剃刀精簡檔案動作 Hook\n// 建議：\n// 1) 將 fileOperations 相關依賴集中於單一 factory/context，移除多處 useCallback 依賴項導致的 hooks 警告。\n// 2) 僅回傳實際用到的最小 API（如 download/preview/delete），避免暴露整包操作以降低重渲染。\n// 3) 針對重複邏輯（權限/錯誤處理/Toast）抽為 util，避免每個 action 內重複。\n\nimport { useState, useCallback } from 'react';\nimport { useToast } from '@/hooks/use-toast';\nimport { useFileOperations, type FileItem as FileActionItem } from './use-file-operations';\n"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/hooks/use-star-actions.ts - 清理未使用的導入（Space 未使用）",
    "details": [],
    "file": "src\\components\\features\\spaces\\hooks\\use-star-actions.ts",
    "line": 14,
    "context": "import { useToast } from '@/hooks/use-toast';\r\nimport { doc, updateDoc, arrayUnion, arrayRemove } from 'firebase/firestore';\r\nimport { type Space } from '@/lib/types-unified';\r\n// TODO: [P2] REFACTOR src/components/features/spaces/hooks/use-star-actions.ts - 清理未使用的導入（Space 未使用）\r\n\r\ninterface UseStarActionsReturn {\r\n  // Actions\r\n  starSpace: (spaceId: string, userId: string) => Promise<boolean>;\r\n  unstarSpace: (spaceId: string, userId: string) => Promise<boolean>;\r\n  toggleStar: (spaceId: string, userId: string, isStarred: boolean) => Promise<boolean>;\r\n  \r\n  // State\r\n  isLoading: boolean;\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/follower-list.tsx:11 - 清理未使用的導入",
    "details": [
      "問題：'doc' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\follower-list.tsx",
    "line": 13,
    "assignee": "frontend",
    "context": "import Link from 'next/link';\r\nimport { collection, doc, query, where, documentId } from 'firebase/firestore';\r\n\r\n// TODO: [P2] REFACTOR src/components/follower-list.tsx:11 - 清理未使用的導入\r\n// 問題：'doc' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\nimport { useFirestore, useCollection } from '@/firebase';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Button } from '@/components/ui/button';\r\nimport {\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/forms/form-card.tsx:18 - 清理未使用的導入",
    "details": [
      "問題：'Skeleton' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\forms\\form-card.tsx",
    "line": 20,
    "assignee": "frontend",
    "context": "} from '@/components/ui/card';\r\nimport { Skeleton } from '@/components/ui/skeleton';\r\n\r\n// TODO: [P2] REFACTOR src/components/forms/form-card.tsx:18 - 清理未使用的導入\r\n// 問題：'Skeleton' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { Form } from '@/components/ui/form';\r\nimport { Button } from '@/components/ui/button';\r\nimport { UseFormReturn, FieldValues } from 'react-hook-form';\r\nimport { FormCardSkeleton } from '../form-card-skeleton';\r\n\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/github-heat-map.tsx:39 - 清理未使用的變數",
    "details": [
      "問題：'weekDays' 已定義但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的變數或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\github-heat-map.tsx",
    "line": 41,
    "assignee": "frontend",
    "context": "\r\nconst _weekDays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\r\n\r\n// TODO: [P2] REFACTOR src/components/github-heat-map.tsx:39 - 清理未使用的變數\r\n// 問題：'weekDays' 已定義但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的變數或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\nexport const GitHubHeatMap: React.FC<HeatMapProps> = ({\r\n  data,\r\n  endDate = new Date(),\r\n  numDays = 365,\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/layout/sidebar.tsx:13 - 清理未使用的導入",
    "details": [
      "問題：'Settings' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\layout\\sidebar.tsx",
    "line": 16,
    "assignee": "frontend",
    "context": "  Settings,\n} from \"lucide-react\";\n\n// TODO: [P2] REFACTOR src/components/layout/sidebar.tsx:13 - 清理未使用的導入\n// 問題：'Settings' 已導入但從未使用\n// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\n// @assignee frontend-team\n\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\n\n// TODO: [P2] REFACTOR src/components/layout/sidebar.tsx:15 - 清理未使用的導入\n// 問題：'Tooltip', 'TooltipContent', 'TooltipProvider', 'TooltipTrigger' 已導入但從未使用"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/layout/sidebar.tsx:15 - 清理未使用的導入",
    "details": [
      "問題：'Tooltip', 'TooltipContent', 'TooltipProvider', 'TooltipTrigger' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用",
      "TODO: [P2] REFACTOR src/components/layout/sidebar.tsx - 奧卡姆剃刀精簡側邊欄",
      "建議：",
      "1) 刪除未用的視覺裝飾/狀態與條件（保留最小導航能力）。",
      "2) 將動態權限與導覽來源集中於單一 selector/hook，避免多處分支與重複邏輯。",
      "3) 僅保留使用中之交互（hover/tooltip 適度減量），避免不必要的 re-render 與樣式開銷。"
    ],
    "file": "src\\components\\layout\\sidebar.tsx",
    "line": 24,
    "assignee": "frontend",
    "context": "\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\n\n// TODO: [P2] REFACTOR src/components/layout/sidebar.tsx:15 - 清理未使用的導入\n// 問題：'Tooltip', 'TooltipContent', 'TooltipProvider', 'TooltipTrigger' 已導入但從未使用\n// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\n// @assignee frontend-team\n// TODO: [P2] REFACTOR src/components/layout/sidebar.tsx - 奧卡姆剃刀精簡側邊欄\n// 建議：\n// 1) 刪除未用的視覺裝飾/狀態與條件（保留最小導航能力）。\n// 2) 將動態權限與導覽來源集中於單一 selector/hook，避免多處分支與重複邏輯。\n// 3) 僅保留使用中之交互（hover/tooltip 適度減量），避免不必要的 re-render 與樣式開銷。"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/layout/sidebar.tsx - 奧卡姆剃刀精簡側邊欄",
    "details": [
      "建議：",
      "1) 刪除未用的視覺裝飾/狀態與條件（保留最小導航能力）。",
      "2) 將動態權限與導覽來源集中於單一 selector/hook，避免多處分支與重複邏輯。",
      "3) 僅保留使用中之交互（hover/tooltip 適度減量），避免不必要的 re-render 與樣式開銷。"
    ],
    "file": "src\\components\\layout\\sidebar.tsx",
    "line": 29,
    "context": "// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\n// @assignee frontend-team\n// TODO: [P2] REFACTOR src/components/layout/sidebar.tsx - 奧卡姆剃刀精簡側邊欄\n// 建議：\n// 1) 刪除未用的視覺裝飾/狀態與條件（保留最小導航能力）。\n// 2) 將動態權限與導覽來源集中於單一 selector/hook，避免多處分支與重複邏輯。\n// 3) 僅保留使用中之交互（hover/tooltip 適度減量），避免不必要的 re-render 與樣式開銷。\n\nimport { cn } from \"@/lib/utils\";\nimport { Logo } from \"../logo\";\nimport { Nav } from \"./nav\";\nimport { type NavItem } from \"./navigation\";"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/ui/chart.tsx - 奧卡姆剃刀精簡圖表層",
    "details": [
      "建議：",
      "1) 以 props 驅動、單一責任：只渲染必要視圖，不內嵌資料轉換/來源選擇。",
      "2) 將重複的 formatter/mapper 提升為 util，避免在多圖表內重複實作。",
      "3) 禁止於渲染期間觸發副作用或資料拉取，將副作用遷至上層 hook。"
    ],
    "file": "src\\components\\ui\\chart.tsx",
    "line": 1,
    "context": "// TODO: [P2] REFACTOR src/components/ui/chart.tsx - 奧卡姆剃刀精簡圖表層\r\n// 建議：\r\n// 1) 以 props 驅動、單一責任：只渲染必要視圖，不內嵌資料轉換/來源選擇。\r\n// 2) 將重複的 formatter/mapper 提升為 util，避免在多圖表內重複實作。\r\n// 3) 禁止於渲染期間觸發副作用或資料拉取，將副作用遷至上層 hook。\r\n\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as RechartsPrimitive from \"recharts\"\r\n\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/ui/file-type-icon.tsx:7 - 清理未使用的導入",
    "details": [
      "問題：'useEffect' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\ui\\file-type-icon.tsx",
    "line": 9,
    "assignee": "frontend",
    "context": "\nimport React, { useState } from 'react';\n\n// TODO: [P2] REFACTOR src/components/ui/file-type-icon.tsx:7 - 清理未使用的導入\n// 問題：'useEffect' 已導入但從未使用\n// 影響：增加 bundle 大小，影響性能\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\n// @assignee frontend-team\nimport { cn } from '@/lib/utils';\nimport { \n  File, \n  FileText, \n  Image, "
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/ui/file-type-icon.tsx - 清理未使用的導入（useEffect, Image, Video, Music, Archive, Code 未使用）",
    "details": [],
    "file": "src\\components\\ui\\file-type-icon.tsx",
    "line": 26,
    "context": "  FileSpreadsheet,\n  Presentation,\n  FileImage,\n  // TODO: [P2] REFACTOR src/components/ui/file-type-icon.tsx - 清理未使用的導入（useEffect, Image, Video, Music, Archive, Code 未使用）\n  \n// TODO: [P2] PERF src/components/ui/file-type-icon.tsx - 實現 Next.js 15 圖片優化最佳實踐\n// 問題：未充分利用 Next.js Image 組件的優化特性\n// 影響：圖片載入性能差、LCP 指標不佳\n// 建議：\n// 1) 使用 next/image 替代所有 <img> 標籤\n// 2) 配置適當的 priority 和 sizes 屬性\n// 3) 實現圖片預載入和懶加載策略\n// 4) 使用 WebP/AVIF 格式優化"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/ui/file-upload.tsx:15 - 清理未使用的導入",
    "details": [
      "問題：'Badge' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\ui\\file-upload.tsx",
    "line": 17,
    "assignee": "frontend",
    "context": "import { Progress } from '@/components/ui/progress';\r\nimport { Badge } from '@/components/ui/badge';\r\n\r\n// TODO: [P2] REFACTOR src/components/ui/file-upload.tsx:15 - 清理未使用的導入\r\n// 問題：'Badge' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\nimport { FileTypeIcon } from '@/components/ui/file-type-icon';\r\nimport { \r\n  Upload, \r\n  File, \r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/ui/file-upload.tsx:20 - 清理未使用的導入",
    "details": [
      "問題：'X' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\ui\\file-upload.tsx",
    "line": 35,
    "assignee": "frontend",
    "context": "  AlertCircle \r\n} from 'lucide-react';\r\n\r\n// TODO: [P2] REFACTOR src/components/ui/file-upload.tsx:20 - 清理未使用的導入\r\n// 問題：'X' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\n// TODO: [P2] REFACTOR src/components/ui/file-upload.tsx:24 - 清理未使用的導入\r\n// 問題：'CheckCircle' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/ui/file-upload.tsx:24 - 清理未使用的導入",
    "details": [
      "問題：'CheckCircle' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\ui\\file-upload.tsx",
    "line": 41,
    "assignee": "frontend",
    "context": "// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\n// TODO: [P2] REFACTOR src/components/ui/file-upload.tsx:24 - 清理未使用的導入\r\n// 問題：'CheckCircle' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\n// TODO: [P2] REFACTOR src/components/ui/file-upload.tsx:25 - 清理未使用的導入\r\n// 問題：'AlertCircle' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/components/ui/file-upload.tsx:25 - 清理未使用的導入",
    "details": [
      "問題：'AlertCircle' 已導入但從未使用",
      "影響：增加 bundle 大小，影響性能",
      "建議：移除未使用的導入或添加下劃線前綴表示有意未使用"
    ],
    "file": "src\\components\\ui\\file-upload.tsx",
    "line": 47,
    "assignee": "frontend",
    "context": "// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n\r\n// TODO: [P2] REFACTOR src/components/ui/file-upload.tsx:25 - 清理未使用的導入\r\n// 問題：'AlertCircle' 已導入但從未使用\r\n// 影響：增加 bundle 大小，影響性能\r\n// 建議：移除未使用的導入或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\nimport { useUploadFile, useDeleteFile, useDownloadFile, usePreviewFile } from '@/hooks/use-file-operations';\r\nimport { ContractDocument } from '@/lib/types/contract.types';\r\n\r\n// Helper functions for file validation (not hooks)\r\nconst isFileTypeSupported = (fileName: string): boolean => {\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/firebase/firestore/use-collection.tsx - 控制快取與依賴穩定，降低重新訂閱",
    "details": [
      "建議：",
      "- 呼叫端須 useMemo 穩定 Query/Ref，hook 內可檢查相等性避免過度 unsubscribe/subscribe。",
      "- 提供選項：{ listen?: boolean; cache?: 'no-store'|'memory' }，與 App Router 快取策略對齊。",
      "- 僅回傳必要欄位，錯誤統一由 errorEmitter 傳遞。"
    ],
    "file": "src\\firebase\\firestore\\use-collection.tsx",
    "line": 37,
    "context": " * The Firestore CollectionReference or Query. Waits if null/undefined.\n * @returns {UseCollectionResult<T>} Object with data, isLoading, error.\n */\n// TODO: [P2] REFACTOR src/firebase/firestore/use-collection.tsx - 控制快取與依賴穩定，降低重新訂閱\n// 建議：\n// - 呼叫端須 useMemo 穩定 Query/Ref，hook 內可檢查相等性避免過度 unsubscribe/subscribe。\n// - 提供選項：{ listen?: boolean; cache?: 'no-store'|'memory' }，與 App Router 快取策略對齊。\n// - 僅回傳必要欄位，錯誤統一由 errorEmitter 傳遞。\nexport function useCollection<T = DocumentData>(\n    targetRefOrQuery: CollectionReference<DocumentData> | Query<DocumentData> | null | undefined,\n): UseCollectionResult<T> {\n  type ResultItemType = WithId<T>;\n  type StateDataType = ResultItemType[] | null;"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/hooks/use-app-state.ts - 修正 unknown/any 類型",
    "details": [
      "說明：以具名型別替代 unknown，為 dialog data 建立明確型別"
    ],
    "file": "src\\hooks\\use-app-state.ts",
    "line": 12,
    "context": "\r\ninterface DialogState {\r\n  type: string | null;\r\n  // TODO: [P2] FIX src/hooks/use-app-state.ts - 修正 unknown/any 類型\r\n  // 說明：以具名型別替代 unknown，為 dialog data 建立明確型別\r\n  data: unknown;\r\n  isOpen: boolean;\r\n}\r\n\r\ninterface AppState {\r\n  chat: ChatState;\r\n  dialog: DialogState;\r\n}\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/hooks/use-app-state.ts - 修正 unknown/any 類型",
    "details": [
      "說明：替換為具名型別或泛型參數，避免使用 unknown"
    ],
    "file": "src\\hooks\\use-app-state.ts",
    "line": 28,
    "context": "  closeChat: () => void;\r\n  toggleChat: () => void;\r\n  toggleMinimizeChat: () => void;\r\n  // TODO: [P2] FIX src/hooks/use-app-state.ts - 修正 unknown/any 類型\r\n  // 說明：替換為具名型別或泛型參數，避免使用 unknown\r\n  openDialog: (type: string, data?: unknown) => void;\r\n  closeDialog: () => void;\r\n}\r\n\r\ninterface AppStateContext extends AppState, AppStateActions {}\r\n\r\nconst AppStateContext = createContext<AppStateContext | undefined>(undefined);\r\n\r"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/hooks/use-app-state.ts - 修正 unknown/any 類型",
    "details": [
      "說明：為 data 提供具名型別或受限泛型，避免使用 unknown"
    ],
    "file": "src\\hooks\\use-app-state.ts",
    "line": 74,
    "context": "    setChat(prev => ({ ...prev, isMinimized: !prev.isMinimized }));\r\n  }, []);\r\n\r\n  // TODO: [P2] FIX src/hooks/use-app-state.ts - 修正 unknown/any 類型\r\n  // 說明：為 data 提供具名型別或受限泛型，避免使用 unknown\r\n  const openDialog = useCallback((type: string, data: unknown = {}) => {\r\n    setDialog({ type, data, isOpen: true });\r\n  }, []);\r\n\r\n  const closeDialog = useCallback(() => {\r\n    setDialog({ type: null, data: {}, isOpen: false });\r\n  }, []);\r\n\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/hooks/use-permissions.ts - 奧卡姆剃刀精簡權限 Hook",
    "details": [
      "建議：",
      "1) 將 checkOrganizationPermissionInternal 暴露為單一 memoized selector，避免多處 useCallback 依賴分散。",
      "2) 僅回傳呼叫端實際需要的最小資料（布林/字串），降低重渲染與心智負擔。",
      "3) 以穩定依賴陣列與衍生值 memo 化，移除多餘依賴導致的 hooks 警告。"
    ],
    "file": "src\\hooks\\use-permissions.ts",
    "line": 2,
    "context": "'use client';\r\n// TODO: [P2] REFACTOR src/hooks/use-permissions.ts - 奧卡姆剃刀精簡權限 Hook\r\n// 建議：\r\n// 1) 將 checkOrganizationPermissionInternal 暴露為單一 memoized selector，避免多處 useCallback 依賴分散。\r\n// 2) 僅回傳呼叫端實際需要的最小資料（布林/字串），降低重渲染與心智負擔。\r\n// 3) 以穩定依賴陣列與衍生值 memo 化，移除多餘依賴導致的 hooks 警告。\r\n\r\nimport { useState, useCallback, useMemo } from 'react';\r\nimport { Permission, PermissionCheckResult, UserRoleAssignment } from '@/lib/types-unified';\r\nimport { useAuth } from '@/components/auth/auth-provider';\r\nimport { roleManagementService } from '@/lib/role-management';\r"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/lib/role-management.ts - 合併查詢與快取，僅回傳最小資料",
    "details": [
      "指南：",
      "- 提供 in-memory 快取（弱映射）以減少 getRoleDefinition 重複查詢；",
      "- checkPermission 與 getAllRoleDefinitions 共享快取；",
      "- 僅暴露 id/name/permissions；將非必要欄位延後查詢。"
    ],
    "file": "src\\lib\\role-management.ts",
    "line": 112,
    "assignee": "ai",
    "context": "  },\n};\n\n// TODO: [P2] REFACTOR src/lib/role-management.ts - 合併查詢與快取，僅回傳最小資料\n// 指南：\n// - 提供 in-memory 快取（弱映射）以減少 getRoleDefinition 重複查詢；\n// - checkPermission 與 getAllRoleDefinitions 共享快取；\n// - 僅暴露 id/name/permissions；將非必要欄位延後查詢。\n// @assignee ai\nexport const roleManagementService = {\n  // 初始化 Firestore\n  db: getFirestore(initializeFirebase().firebaseApp),\n  // TODO: [P2] REFACTOR src/lib/role-management.ts - 奧卡姆剃刀精簡服務層"
  },
  {
    "priority": "P2",
    "type": "REFACTOR",
    "description": "src/lib/role-management.ts - 奧卡姆剃刀精簡服務層",
    "details": [
      "建議：",
      "1) 以 pure function + 最小輸出為主，避免在 service 層維持隱藏狀態。",
      "2) 將 getAllRoleDefinitions 與 checkPermission 的重複查詢合併/快取；避免重複 Firestore round-trip。",
      "3) 僅回傳渲染所需欄位（id/name/permissions），其餘細節延後查詢。"
    ],
    "file": "src\\lib\\role-management.ts",
    "line": 121,
    "context": "export const roleManagementService = {\n  // 初始化 Firestore\n  db: getFirestore(initializeFirebase().firebaseApp),\n  // TODO: [P2] REFACTOR src/lib/role-management.ts - 奧卡姆剃刀精簡服務層\n  // 建議：\n  // 1) 以 pure function + 最小輸出為主，避免在 service 層維持隱藏狀態。\n  // 2) 將 getAllRoleDefinitions 與 checkPermission 的重複查詢合併/快取；避免重複 Firestore round-trip。\n  // 3) 僅回傳渲染所需欄位（id/name/permissions），其餘細節延後查詢。\n\n  // 獲取角色定義\n  getRoleDefinition: async (roleId: string): Promise<RoleDefinition | null> => {\n    try {\n      // 首先檢查系統角色"
  },
  {
    "priority": "P2",
    "type": "FIX",
    "description": "src/lib/types-unified.ts - 修正 unknown/any 類型",
    "details": [
      "說明：以具名型別替代 unknown，或引入泛型以約束資料型別"
    ],
    "file": "src\\lib\\types-unified.ts",
    "line": 245,
    "context": "  };\r\n  dialog: {\r\n    type: string | null;\r\n    // TODO: [P2] FIX src/lib/types-unified.ts - 修正 unknown/any 類型\r\n    // 說明：以具名型別替代 unknown，或引入泛型以約束資料型別\r\n    data: unknown;\r\n    isOpen: boolean;\r\n  };\r\n}\r\n\r\nexport interface AuthState {\r\n  userId: string | null;\r\n  userRoleAssignment: UserRoleAssignment | null;\r"
  },
  {
    "priority": "P3",
    "type": "REFACTOR",
    "description": "src/app/(app)/organizations/[organizationslug]/spaces/page.tsx - 清理未使用的參數（params 未使用）",
    "details": [],
    "file": "src\\app\\(app)\\organizations\\[organizationslug]\\spaces\\page.tsx",
    "line": 13,
    "context": "}: {\r\n  params: { organizationslug: string };\r\n}) {\r\n  // TODO: [P3] REFACTOR src/app/(app)/organizations/[organizationslug]/spaces/page.tsx - 清理未使用的參數（params 未使用）\r\n  \r\n// TODO: [P2] REFACTOR src/app/(app)/organizations/[organizationslug]/spaces/page.tsx:6 - 清理未使用的參數\r\n// 問題：'params' 參數已定義但從未使用\r\n// 影響：代碼可讀性差，可能造成混淆\r\n// 建議：移除未使用的參數或添加下劃線前綴表示有意未使用\r\n// @assignee frontend-team\r\n  // Redirect to unified spaces page\r\n  redirect('/spaces');\r\n}\r"
  },
  {
    "priority": "P3",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/overview/recent-activity.tsx - 清理未使用的參數",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\overview\\recent-activity.tsx",
    "line": 28,
    "context": "}\r\n\r\nexport function RecentActivity({ spaceId: _spaceId, activities }: RecentActivityProps) {\r\n  // TODO: [P3] REFACTOR src/components/features/spaces/components/overview/recent-activity.tsx - 清理未使用的參數\r\n  const defaultActivities: ActivityItem[] = [\r\n    {\r\n      id: '1',\r\n      type: 'file_upload',\r\n      user: { name: 'John Doe', avatar: '/avatars/john.jpg' },\r\n      description: 'uploaded a new file',\r\n      timestamp: new Date(Date.now() - 1000 * 60 * 30), // 30 minutes ago\r\n      metadata: { fileName: 'project-spec.pdf' },\r\n    },\r"
  },
  {
    "priority": "P3",
    "type": "REFACTOR",
    "description": "src/components/features/spaces/components/quality/quality-dashboard.tsx - 清理未使用的參數（spaceId 未使用）",
    "details": [],
    "file": "src\\components\\features\\spaces\\components\\quality\\quality-dashboard.tsx",
    "line": 28,
    "context": "}\r\n\r\nexport function QualityDashboard({ spaceId: _spaceId, metrics }: QualityDashboardProps) {\r\n  // TODO: [P3] REFACTOR src/components/features/spaces/components/quality/quality-dashboard.tsx - 清理未使用的參數（spaceId 未使用）\r\n  const defaultMetrics: QualityMetrics = {\r\n    overallScore: 85,\r\n    completedChecks: 12,\r\n    totalChecks: 15,\r\n    criticalIssues: 2,\r\n    warnings: 5,\r\n    trends: {\r\n      scoreChange: 5,\r\n      completionRate: 80,\r"
  },
  {
    "priority": "P3",
    "type": "REFACTOR",
    "description": "src/components/ui/menubar.tsx - 奧卡姆剃刀精簡 API 表面",
    "details": [
      "建議：",
      "1) 僅導出常用組件（Menubar, Trigger, Content, Item, Separator），其餘用到再暴露，降低 API 心智負擔。",
      "2) 以範例/Story 取代過度封裝，鼓勵組合而非新增包裝層。"
    ],
    "file": "src\\components\\ui\\menubar.tsx",
    "line": 8,
    "context": "import { Check, ChevronRight, Circle } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n// TODO: [P3] REFACTOR src/components/ui/menubar.tsx - 奧卡姆剃刀精簡 API 表面\r\n// 建議：\r\n// 1) 僅導出常用組件（Menubar, Trigger, Content, Item, Separator），其餘用到再暴露，降低 API 心智負擔。\r\n// 2) 以範例/Story 取代過度封裝，鼓勵組合而非新增包裝層。\r\n\r\nfunction MenubarMenu({\r\n  ...props\r\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\r\n  return <MenubarPrimitive.Menu {...props} />\r\n}\r"
  }
]
```

## 💡 建議的 AI 命令

你可以使用以下命令讓 AI 處理特定 TODO：

```
# 處理第一個緊急項目
請根據 src\components\features\spaces\components\file-explorer\file-explorer.tsx 第 9 行的 TODO，完成修復

# 處理所有 P0 安全性問題
請處理所有標記為 P0-SECURITY 的 TODO

# 生成測試檔案
請為所有標記為 TEST 的 TODO 生成對應的測試檔案
```