{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's core profile and progress data.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the UserProfile entity." },
        "username": { "type": "string", "description": "The user's chosen username." },
        "slug": { "type": "string", "description": "The URL-friendly slug for the user's profile." },
        "name": { "type": "string", "description": "The user's full name." },
        "email": { "type": "string", "description": "The user's email address.", "format": "email" },
        "avatarUrl": { "type": "string", "description": "URL of the user's avatar image.", "format": "uri" },
        "level": { "type": "number", "description": "The user's current level." },
        "experience": { "type": "number", "description": "The user's current experience points (XP)." },
        "managementScore": { "type": "number", "description": "A score representing the user's management skills or progress." },
        "followingCount": { "type": "number", "description": "The number of users this user is following." },
        "followersCount": { "type": "number", "description": "The number of users following this user." },
        "moduleInventory": { "type": "object", "description": "A map of Module IDs to the quantity the user owns.", "additionalProperties": { "type": "number" } }
      },
      "required": [ "id", "username", "slug", "name", "email" ]
    },
    "UserFollow": {
        "title": "UserFollow",
        "type": "object",
        "description": "Represents a follow relationship, including the timestamp. Stored in subcollections.",
        "properties": {
            "followedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["followedAt"]
    },
    "Organization": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Organization",
      "type": "object",
      "description": "Represents an organization within the application.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the Organization entity." },
        "name": { "type": "string", "description": "The name of the organization." },
        "slug": { "type": "string", "description": "The URL-friendly slug for the organization." },
        "description": { "type": "string", "description": "A description of the organization." },
        "memberIds": { "type": "array", "description": "References to UserProfiles that are members of this organization.", "items": { "type": "string" } }
      },
      "required": [ "id", "name", "slug", "description" ]
    },
    "Group": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Group",
      "type": "object",
      "description": "Represents a group within an organization.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the Group entity." },
        "organizationId": { "type": "string", "description": "Reference to the Organization this group belongs to." },
        "name": { "type": "string", "description": "The name of the group." },
        "description": { "type": "string", "description": "A description of the group." },
        "memberIds": { "type": "array", "description": "References to UserProfiles that are members of this group.", "items": { "type": "string" } }
      },
      "required": [ "id", "organizationId", "name", "description" ]
    },
    "Space": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Space",
      "type": "object",
      "description": "Represents a space created by a user or organization.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the Space entity." },
        "ownerId": { "type": "string", "description": "Reference to the UserProfile or Organization that owns this space." },
        "ownerType": { "type": "string", "description": "The type of the owner, either 'user' or 'organization'." },
        "name": { "type": "string", "description": "The name of the space." },
        "slug": { "type": "string", "description": "The URL-friendly slug for the space." },
        "description": { "type": "string", "description": "A description of the space." },
        "isPublic": { "type": "boolean", "description": "Indicates whether the space is public or private." },
        "moduleIds": { "type": "array", "description": "An 'equipment slot' array of Module IDs installed in the space.", "items": { "type": "string" } },
        "starredByUserIds": { "type": "array", "description": "References to UserProfiles that have starred this space.", "items": { "type": "string" } }
      },
      "required": [ "id", "ownerId", "ownerType", "name", "slug", "isPublic" ]
    },
    "Module": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Module",
      "type": "object",
      "description": "Represents a module that can be added to a space. Can be of different types, e.g., a functional module like 'File Storage' or a content module.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the Module entity." },
        "name": { "type": "string", "description": "The name of the module." },
        "description": { "type": "string", "description": "A description of the module." },
        "icon": { "type": "string", "description": "A string identifier for a Lucide icon (e.g., 'puzzle', 'file-storage')." }
      },
      "required": [ "id", "name", "description" ]
    },
    "Achievement": {
      "title": "Achievement",
      "type": "object",
      "description": "Defines a global achievement that can be unlocked by users.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "description": { "type": "string" },
        "icon": { "type": "string" }
      },
      "required": ["id", "name", "description"]
    },
    "UserAchievement": {
        "title": "User Achievement",
        "type": "object",
        "description": "Represents a user's unlocked achievement, linking a user to an achievement.",
        "properties": {
            "achievementId": { "type": "string" },
            "unlockedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["achievementId", "unlockedAt"]
    },
    "Wallet": {
        "title": "Wallet",
        "type": "object",
        "description": "Represents the balance of a single currency for a user.",
        "properties": {
            "balance": { "type": "number" }
        },
        "required": ["balance"]
    },
    "Transaction": {
        "title": "Transaction",
        "type": "object",
        "description": "Represents a single transaction or event in a user's history.",
        "properties": {
            "id": { "type": "string" },
            "type": { "type": "string", "enum": ["gain_gold", "spend_gold", "gain_xp"] },
            "amount": { "type": "number" },
            "description": { "type": "string" },
            "timestamp": { "type": "string", "format": "date-time" }
        },
        "required": ["id", "type", "amount", "timestamp"]
    },
    "Conversation": {
      "title": "Conversation",
      "type": "object",
      "description": "Represents a conversation between two or more users.",
      "properties": {
        "id": { "type": "string" },
        "participantIds": { "type": "array", "items": { "type": "string" } },
        "lastMessage": { "$ref": "#/entities/Message" },
        "updatedAt": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "participantIds", "updatedAt"]
    },
    "Message": {
      "title": "Message",
      "type": "object",
      "description": "Represents a single message within a conversation.",
      "properties": {
        "id": { "type": "string" },
        "conversationId": { "type": "string" },
        "senderId": { "type": "string" },
        "text": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "conversationId", "senderId", "text", "createdAt"]
    },
    "Item": {
      "title": "Item",
      "type": "object",
      "description": "Represents a product or item in the inventory.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "description": { "type": "string" },
        "price": { "type": "number" }
      },
      "required": ["id", "name", "price"]
    },
    "Warehouse": {
      "title": "Warehouse",
      "type": "object",
      "description": "Represents a physical location where items are stored.",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "location": { "type": "string" }
      },
      "required": ["id", "name"]
    },
    "Stock": {
      "title": "Stock",
      "type": "object",
      "description": "Represents the stock level of a specific item in a warehouse.",
      "properties": {
        "id": { "type": "string" },
        "itemId": { "type": "string" },
        "warehouseId": { "type": "string" },
        "quantity": { "type": "number" }
      },
      "required": ["id", "itemId", "warehouseId", "quantity"]
    },
    "AuditLog": {
      "title": "Audit Log",
      "type": "object",
      "description": "Represents a single audit log entry for an organization.",
      "properties": {
        "id": { "type": "string" },
        "organizationId": { "type": "string" },
        "userId": { "type": "string" },
        "userName": { "type": "string" },
        "userAvatarUrl": { "type": "string", "format": "uri" },
        "action": { "type": "string", "enum": ["CREATE", "UPDATE", "DELETE"] },
        "entityType": { "type": "string", "enum": ["ORGANIZATION", "ITEM", "WAREHOUSE", "MEMBER"] },
        "entityId": { "type": "string" },
        "entityTitle": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["id", "organizationId", "userId", "action", "entityType", "entityId", "createdAt"]
    }
  },
  "auth": {
    "providers": [ "password", "anonymous" ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/entities/UserProfile" },
      "description": "Stores user profiles, including embedded progress data like level and XP and aggregated counts for followers/following for quick access."
    },
    "/users/{userId}/following/{followingId}": {
      "schema": { "$ref": "#/entities/UserFollow" },
      "description": "A collection where each document represents a user that the parent user is following. The document ID is the ID of the user being followed."
    },
    "/users/{userId}/followers/{followerId}": {
      "schema": { "$ref": "#/entities/UserFollow" },
      "description": "A collection where each document represents a user that is following the parent user. The document ID is the ID of the follower."
    },
    "/users/{userId}/user_achievements/{achievementId}": {
      "schema": { "$ref": "#/entities/UserAchievement" },
      "description": "Stores achievements unlocked by a specific user. The document ID is the global achievement ID."
    },
    "/users/{userId}/wallet/{currencyId}": {
      "schema": { "$ref": "#/entities/Wallet" },
      "description": "Stores the balance for a specific currency (e.g., 'gold', 'gems') for a user. Designed for secure, server-side updates."
    },
    "/users/{userId}/transactions/{transactionId}": {
      "schema": { "$ref": "#/entities/Transaction" },
      "description": "A log of all significant events for a user, such as currency changes or level-ups."
    },
    "/users/{userId}/spaces/{spaceId}": {
      "schema": { "$ref": "#/entities/Space" },
      "description": "A subcollection for spaces owned directly by a user. This is a denormalization for quick access on the dashboard."
    },
    "/organizations/{organizationId}": {
      "schema": { "$ref": "#/entities/Organization" },
      "description": "Stores organization profiles."
    },
     "/organizations/{organizationId}/audit_logs/{logId}": {
      "schema": { "$ref": "#/entities/AuditLog" },
      "description": "Stores the audit trail of all actions performed within an organization."
    },
    "/organizations/{organizationId}/groups/{groupId}": {
      "schema": { "$ref": "#/entities/Group" },
      "description": "Stores groups within an organization."
    },
    "/spaces/{spaceId}": {
      "schema": { "$ref": "#/entities/Space" },
      "description": "Stores all spaces. The 'ownerId' determines ownership. The 'moduleIds' array acts as an 'equipment slot' for features."
    },
    "/modules/{moduleId}": {
      "schema": { "$ref": "#/entities/Module" },
      "description": "Stores module definitions, which are like 'blueprints' for features that can be added to spaces."
    },
    "/achievements/{achievementId}": {
      "schema": { "$ref": "#/entities/Achievement" },
      "description": "Stores global definitions for all possible achievements in the application."
    },
    "/conversations/{conversationId}": {
      "schema": { "$ref": "#/entities/Conversation" },
      "description": "Stores conversation metadata."
    },
    "/conversations/{conversationId}/messages/{messageId}": {
      "schema": { "$ref": "#/entities/Message" },
      "description": "Stores messages within a conversation."
    },
    "/organizations/{organizationId}/items/{itemId}": {
      "schema": { "$ref": "#/entities/Item" },
      "description": "Items belonging to an organization."
    },
    "/organizations/{organizationId}/warehouses/{warehouseId}": {
      "schema": { "$ref": "#/entities/Warehouse" },
      "description": "Warehouses belonging to an organization."
    },
    "/organizations/{organizationId}/warehouses/{warehouseId}/stock/{stockId}": {
      "schema": { "$ref": "#/entities/Stock" },
      "description": "Stock levels for items within a specific warehouse of an organization."
    }
  }
}
