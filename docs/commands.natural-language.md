# AI Agent 自然語言指令系統

> **版本**: 1.0 | **更新**: 2025-10-03  
> **目標**: 降低 AI agent 認知難度，提升開發效率

---

## 🎯 核心指令格式

### 1. 動作指令 (Action Commands)
```
格式: [動作] [目標] [條件] [優先級]

範例:
- "創建用戶認證組件"
- "修復登入頁面的 TypeScript 錯誤"
- "優化文件上傳的性能"
- "重構角色管理邏輯"
```

### 2. 查詢指令 (Query Commands)
```
格式: [查詢類型] [目標] [範圍]

範例:
- "檢查所有 TODO 項目"
- "分析認證相關的錯誤"
- "查看文件上傳組件的依賴"
- "統計未使用的導入"
```

### 3. 修復指令 (Fix Commands)
```
格式: [修復] [問題類型] [目標文件] [具體問題]

範例:
- "修復 JSX 語法錯誤在 contract-list.tsx"
- "清理未使用的導入在 auth-provider.tsx"
- "修復 TypeScript 類型錯誤在 use-permissions.ts"
- "修復 React Hooks 規則違反在 file-upload.tsx"
```

---

## 📋 標準化指令分類

### 🔧 開發指令 (Development)

#### 組件創建
- `創建 [功能] 組件` - 創建新的 React 組件
- `創建 [功能] 頁面` - 創建新的 Next.js 頁面
- `創建 [功能] Hook` - 創建自定義 React Hook
- `創建 [功能] 服務` - 創建服務層邏輯

#### 組件修改
- `修改 [組件名] 添加 [功能]` - 為現有組件添加功能
- `重構 [組件名] 使用 [模式]` - 重構組件使用特定模式
- `優化 [組件名] 性能` - 優化組件性能
- `簡化 [組件名] 邏輯` - 簡化組件邏輯

#### 錯誤修復
- `修復 [文件] 的 [錯誤類型]` - 修復特定錯誤
- `清理 [文件] 的 [問題]` - 清理代碼問題
- `更新 [文件] 的 [依賴]` - 更新依賴關係

### 🔍 分析指令 (Analysis)

#### 代碼分析
- `分析 [模組] 的依賴關係` - 分析模組依賴
- `檢查 [功能] 的實現狀態` - 檢查功能實現
- `統計 [類型] 的數量` - 統計特定類型項目
- `識別 [問題] 的模式` - 識別問題模式

#### 性能分析
- `分析 [組件] 的渲染性能` - 分析組件性能
- `檢查 [功能] 的記憶體使用` - 檢查記憶體使用
- `優化 [操作] 的執行時間` - 優化執行時間

### 🧹 清理指令 (Cleanup)

#### 代碼清理
- `清理未使用的導入` - 移除未使用的 import
- `清理未使用的變數` - 移除未使用的變數
- `清理未使用的參數` - 移除未使用的參數
- `清理重複的代碼` - 移除重複代碼

#### 文件清理
- `清理 [文件] 的格式` - 格式化文件
- `清理 [目錄] 的結構` - 整理目錄結構
- `清理 [模組] 的依賴` - 清理模組依賴

---

## 🎨 專案特定指令

### Next.js 15 指令
- `創建 App Router 頁面` - 創建 Next.js 15 頁面
- `創建 Server Action` - 創建服務端動作
- `創建 Client Component` - 創建客戶端組件
- `配置環境變數` - 配置環境變數

### Firebase 指令
- `創建 Firestore 查詢` - 創建 Firestore 查詢
- `創建認證邏輯` - 創建 Firebase 認證
- `創建 Storage 操作` - 創建 Storage 操作
- `配置 Security Rules` - 配置安全規則

### UI 組件指令
- `創建 shadcn/ui 組件` - 創建 shadcn/ui 組件
- `創建表單組件` - 創建表單相關組件
- `創建數據表格` - 創建數據表格組件
- `創建對話框組件` - 創建對話框組件

---

## 🚀 快速指令 (Quick Commands)

### 常用開發指令
```
# 創建功能
創建用戶管理功能
創建文件上傳功能
創建角色權限功能

# 修復問題
修復所有 TypeScript 錯誤
修復所有 ESLint 警告
修復所有 JSX 語法錯誤

# 優化代碼
優化所有組件性能
清理所有未使用的導入
重構所有重複代碼

# 檢查狀態
檢查所有 TODO 項目
檢查所有錯誤狀態
檢查所有依賴關係
```

### 專案維護指令
```
# 文檔更新
更新項目結構文檔
更新 TODO 列表
更新開發規範

# 代碼質量
運行所有測試
檢查代碼覆蓋率
分析代碼複雜度

# 部署準備
檢查生產環境配置
驗證環境變數
檢查構建狀態
```

---

## 🎯 智能指令模式

### 上下文感知指令
```
# 基於當前文件
"修復這個文件的錯誤" - 修復當前文件的錯誤
"優化這個組件" - 優化當前組件
"重構這個邏輯" - 重構當前邏輯

# 基於當前功能
"完善認證功能" - 完善當前認證相關功能
"優化文件管理" - 優化當前文件管理功能
"修復權限控制" - 修復當前權限控制功能
```

### 批量操作指令
```
# 批量修復
"修復所有 P1 錯誤" - 修復所有高優先級錯誤
"清理所有未使用導入" - 清理所有未使用的導入
"修復所有 TypeScript 錯誤" - 修復所有 TS 錯誤

# 批量創建
"創建所有缺失的組件" - 創建所有缺失的組件
"創建所有 API 接口" - 創建所有 API 接口
"創建所有測試文件" - 創建所有測試文件
```

---

## 📊 指令優先級標記

### 優先級標記
- `[P0]` - 緊急修復，阻塞開發
- `[P1]` - 高優先級，影響功能
- `[P2]` - 中優先級，代碼質量
- `[P3]` - 低優先級，優化建議

### 類型標記
- `[BUG]` - 錯誤修復
- `[FEATURE]` - 功能開發
- `[REFACTOR]` - 代碼重構
- `[CLEANUP]` - 代碼清理
- `[UI]` - UI 相關
- `[AUTH]` - 認證相關
- `[API]` - API 相關

### 範例
```
[P1][BUG][AUTH] 修復登入頁面的認證錯誤
[P2][CLEANUP][UI] 清理未使用的導入
[P0][FEATURE][API] 創建用戶管理 API
```

---

## 🔄 指令執行流程

### 1. 指令解析
```
輸入: "修復 contract-list.tsx 的 JSX 語法錯誤"
解析: 
- 動作: 修復
- 目標: contract-list.tsx
- 問題: JSX 語法錯誤
- 類型: [BUG][UI]
```

### 2. 上下文收集
```
- 讀取目標文件
- 分析錯誤類型
- 檢查相關依賴
- 確認修復策略
```

### 3. 執行修復
```
- 應用修復邏輯
- 驗證修復結果
- 更新相關文件
- 記錄變更日誌
```

### 4. 結果驗證
```
- 檢查語法正確性
- 驗證功能完整性
- 確認無副作用
- 更新文檔狀態
```

---

## 💡 最佳實踐

### 指令撰寫建議
1. **明確具體**: 使用具體的文件名和功能名
2. **包含上下文**: 提供足夠的上下文信息
3. **指定優先級**: 使用優先級標記
4. **分步驟**: 複雜任務分解為多個步驟

### 避免的指令模式
```
❌ "修復錯誤" - 太模糊
❌ "優化代碼" - 沒有具體目標
❌ "創建組件" - 缺少功能描述

✅ "修復 contract-list.tsx 第319行的 JSX 語法錯誤"
✅ "優化 file-upload.tsx 的 React Hooks 使用"
✅ "創建用戶角色管理的對話框組件"
```

---

## 🎯 專案特定優化

### 基於專案結構的指令
```
# 基於 features 目錄
"創建 spaces 功能的新組件"
"修復 organizations 模組的錯誤"
"優化 contracts 功能的性能"

# 基於組件類型
"創建 UI 組件庫的新組件"
"修復 forms 組件的驗證邏輯"
"優化 layout 組件的響應式設計"
```

### 基於技術棧的指令
```
# Firebase 相關
"創建 Firestore 查詢 Hook"
"修復 Firebase 認證錯誤"
"優化 Firebase Storage 上傳"

# Next.js 15 相關
"創建 App Router 頁面"
"修復 Server Action 錯誤"
"優化 Client Component 性能"

# TypeScript 相關
"修復類型定義錯誤"
"創建類型安全的 API"
"優化類型推導性能"
```

---

## 📈 指令效果評估

### 成功指標
- 指令理解準確率 > 95%
- 執行成功率 > 90%
- 修復準確率 > 85%
- 代碼質量提升 > 80%

### 持續改進
- 收集指令使用數據
- 分析失敗案例
- 優化指令格式
- 更新指令庫

---

## 🔧 指令擴展

### 自定義指令
```
# 添加新的動作指令
"部署 [環境]" - 部署到指定環境
"測試 [功能]" - 測試指定功能
"文檔 [模組]" - 生成模組文檔

# 添加新的查詢指令
"比較 [版本]" - 比較代碼版本
"分析 [性能]" - 分析性能指標
"檢查 [安全]" - 檢查安全問題
```

### 指令組合
```
# 組合指令
"創建並測試 [功能]" - 創建功能並運行測試
"修復並優化 [組件]" - 修復問題並優化性能
"重構並文檔 [模組]" - 重構代碼並更新文檔
```

---

## 🔍 專案規範檢查指令 (Compliance Commands)

### 規範發現指令 (Compliance Discovery)

#### 架構規範檢查
- `檢查架構分離合規性` - 檢查 Server Actions 與 Firebase 分離
- `檢查文件命名規範` - 驗證文件命名是否符合約定
- `檢查組件職責分離` - 檢查組件是否保持單一職責
- `檢查目錄結構規範` - 驗證目錄結構是否符合標準

#### 代碼質量規範檢查
- `檢查 TypeScript 嚴格模式` - 驗證 TypeScript 配置
- `檢查 ESLint 規範` - 檢查代碼風格和最佳實踐
- `檢查未使用代碼` - 發現未使用的導入、變數、函數
- `檢查錯誤處理規範` - 驗證錯誤處理是否完整

#### Firebase 規範檢查
- `檢查 Firebase 使用位置` - 確保 Firebase 只在客戶端使用
- `檢查 Security Rules` - 驗證 Firebase 安全規則配置
- `檢查環境變數配置` - 檢查 Firebase 環境變數設置

#### UI/UX 規範檢查
- `檢查 Radix UI 使用` - 驗證是否正確使用 Radix UI 組件
- `檢查 Tailwind CSS 使用` - 檢查樣式是否使用 Tailwind
- `檢查無障礙性規範` - 檢查鍵盤導航和 ARIA 屬性
- `檢查響應式設計` - 驗證移動端適配

### 規範修復指令 (Compliance Fix)

#### 自動修復指令
- `修復所有架構違規` - 自動修復架構分離問題
- `修復所有命名違規` - 自動修復文件命名問題
- `修復所有 TypeScript 錯誤` - 自動修復類型錯誤
- `修復所有 ESLint 警告` - 自動修復代碼風格問題

#### 手動修復指令
- `重構 [組件] 符合單一職責` - 重構組件職責分離
- `重構 [文件] 符合命名規範` - 重構文件命名
- `重構 [模組] 符合架構規範` - 重構模組架構

### TODO 生成指令 (TODO Generation)

#### 規範檢查 TODO 生成
- `生成架構規範 TODO` - 為架構違規生成 TODO 項目
- `生成代碼質量 TODO` - 為代碼質量問題生成 TODO
- `生成 Firebase 規範 TODO` - 為 Firebase 使用問題生成 TODO
- `生成 UI 規範 TODO` - 為 UI/UX 問題生成 TODO

#### 優先級分類 TODO
- `生成 P0 緊急 TODO` - 生成阻塞開發的緊急問題
- `生成 P1 高優先級 TODO` - 生成影響功能的高優先級問題
- `生成 P2 中優先級 TODO` - 生成代碼質量的中優先級問題
- `生成 P3 低優先級 TODO` - 生成優化建議的低優先級問題

### 規範審計指令 (Compliance Audit)

#### 全面審計
- `執行完整規範審計` - 檢查所有規範項目
- `執行架構審計` - 專注於架構規範檢查
- `執行代碼質量審計` - 專注於代碼質量檢查
- `執行安全審計` - 專注於安全相關檢查

#### 分類審計
- `審計 [功能模組] 規範` - 檢查特定功能模組的規範
- `審計 [文件類型] 規範` - 檢查特定文件類型的規範
- `審計 [優先級] 問題` - 檢查特定優先級的問題

### 規範報告指令 (Compliance Reporting)

#### 報告生成
- `生成規範合規報告` - 生成完整的合規性報告
- `生成問題統計報告` - 生成問題統計和分析
- `生成修復建議報告` - 生成修復建議和優先級
- `生成進度追蹤報告` - 生成規範改進進度報告

#### 報告分析
- `分析規範違規模式` - 分析違規問題的模式
- `分析修復優先級` - 分析修復的優先順序
- `分析改進趨勢` - 分析規範改進的趨勢

### 規範優化指令 (Compliance Optimization)

#### 自動化優化
- `優化規範檢查流程` - 改進規範檢查的自動化
- `優化 TODO 生成邏輯` - 改進 TODO 生成的準確性
- `優化報告生成效率` - 提升報告生成的速度

#### 規範更新
- `更新規範檢查規則` - 更新檢查規則和標準
- `更新 TODO 模板` - 更新 TODO 項目的模板
- `更新報告格式` - 更新報告的格式和內容

---

## 🎯 專案特定規範檢查

### Next.js 15 規範檢查
```
# 架構規範
檢查 App Router 使用規範
檢查 Server/Client Components 分離
檢查 Server Actions 使用規範
檢查環境變數配置規範

# 性能規範
檢查代碼分割規範
檢查圖片優化規範
檢查字體優化規範
檢查緩存策略規範
```

### Firebase 規範檢查
```
# 安全規範
檢查 Firebase Security Rules
檢查環境變數安全性
檢查 API 金鑰管理
檢查數據訪問權限

# 使用規範
檢查 Firebase 客戶端使用位置
檢查 Firestore 查詢優化
檢查 Storage 使用規範
檢查 Auth 流程規範
```

### TypeScript 規範檢查
```
# 類型安全
檢查嚴格模式配置
檢查 any 類型使用
檢查類型定義完整性
檢查類型導入規範

# 代碼質量
檢查未使用變數
檢查未使用導入
檢查函數參數使用
檢查返回值類型
```

### UI/UX 規範檢查
```
# 組件規範
檢查 Radix UI 使用
檢查 shadcn/ui 組件
檢查自定義組件設計
檢查組件組合模式

# 樣式規範
檢查 Tailwind CSS 使用
檢查 CSS 變數使用
檢查響應式設計
檢查暗色模式支持
```

---

## 📊 規範檢查結果格式

### 檢查結果結構
```
[P0] [CRITICAL] [ARCHITECTURE] - 架構分離違規
[P1] [HIGH] [TYPESCRIPT] - TypeScript 類型錯誤
[P2] [MEDIUM] [CLEANUP] - 未使用的導入
[P3] [LOW] [OPTIMIZATION] - 性能優化建議
```

### TODO 項目格式
```
- [ ] `文件路徑:行號` - [優先級] [類型] [模組] [描述] - 具體問題說明
```

### 報告格式
```
## 規範合規報告

### 總體狀況
- 合規率: 85%
- 待修復: 15 個問題
- 緊急問題: 2 個

### 分類統計
- 架構問題: 3 個
- 代碼質量: 8 個
- UI/UX 問題: 4 個

### 修復建議
1. 優先修復 P0 問題
2. 批量處理 P1 問題
3. 逐步改善 P2 問題
```

---

## 🚀 實際使用範例

### 基於當前專案的規範檢查範例

#### 發現的規範問題範例
```
# 架構分離問題
- [ ] `src/components/auth/auth-provider.tsx:6` - [P1] [BUG] [AUTH] [TODO] 修復 UTF-8 編碼問題
- [ ] `src/components/auth/role-manager.tsx:3` - [P1] [BUG] [AUTH] [TODO] 修復文件完整性問題

# 代碼質量問題
- [ ] `src/components/features/spaces/components/contracts/contract-list.tsx:319` - [P1] [BUG] [UI] [TODO] 修復 JSX 語法錯誤
- [ ] `src/components/ui/file-upload.tsx:9` - [P1] [BUG] [UI] [TODO] 修復 React Hooks 規則違反

# 清理問題
- [ ] `src/components/features/spaces/components/overview/stat-card.tsx:6` - [P2] [CLEANUP] [UI] [TODO] 清理未使用的導入
- [ ] `src/components/contribution-breakdown-chart.tsx:11` - [P2] [CLEANUP] [UI] [TODO] 清理未使用的導入
```

#### 規範檢查指令使用範例
```
# 檢查特定模組
"檢查 auth 模組規範合規性"
"檢查 spaces 功能架構分離"
"檢查 UI 組件代碼質量"

# 生成分類 TODO
"生成所有 P1 錯誤的 TODO"
"生成所有架構違規的 TODO"
"生成所有清理問題的 TODO"

# 執行全面審計
"執行完整規範審計並生成報告"
"審計 TypeScript 規範並修復錯誤"
"審計 Firebase 使用規範並優化"
```

#### 自動化規範檢查流程
```
1. 執行規範檢查
   "檢查架構分離合規性"
   "檢查代碼質量規範"
   "檢查 UI/UX 規範"

2. 生成 TODO 項目
   "生成架構規範 TODO"
   "生成代碼質量 TODO"
   "生成 UI 規範 TODO"

3. 分類和優先級
   "按優先級分類 TODO 項目"
   "按模組分組 TODO 項目"
   "生成修復建議報告"

4. 執行修復
   "修復所有 P0 緊急問題"
   "修復所有架構違規"
   "清理所有未使用代碼"
```

### 規範檢查最佳實踐

#### 定期檢查流程
```
# 每日檢查
"檢查新增代碼的規範合規性"
"生成當日規範問題 TODO"

# 每週檢查
"執行完整規範審計"
"生成週度規範合規報告"
"更新規範改進進度"

# 發布前檢查
"執行發布前規範檢查"
"修復所有 P0 和 P1 問題"
"生成發布準備報告"
```

#### 規範改進追蹤
```
# 進度追蹤
"追蹤規範改進進度"
"分析規範違規趨勢"
"優化規範檢查流程"

# 持續改進
"更新規範檢查規則"
"優化 TODO 生成邏輯"
"改進報告生成效率"
```

---

## 🎉 總結

這套自然語言指令系統的設計目標是：

1. **降低認知負擔**: 使用直觀的動詞和名詞組合
2. **提高執行效率**: 標準化的指令格式和流程
3. **減少錯誤**: 明確的上下文和驗證機制
4. **便於擴展**: 模組化的指令結構
5. **專案適配**: 基於 Next.js 15 + Firebase 技術棧

通過使用這套指令系統，AI agent 可以更準確地理解用戶意圖，更高效地執行開發任務，並保持代碼質量和專案一致性。

---

## 📚 快速參考

### 常用動詞
- **創建**: 新建組件、頁面、功能
- **修復**: 修復錯誤、問題
- **優化**: 提升性能、效率
- **清理**: 移除冗餘、整理代碼
- **重構**: 改進結構、設計
- **檢查**: 分析狀態、驗證
- **更新**: 升級依賴、文檔

### 常用目標
- **組件**: React 組件
- **頁面**: Next.js 頁面
- **Hook**: 自定義 Hook
- **服務**: 業務邏輯服務
- **API**: 接口和數據
- **類型**: TypeScript 類型
- **測試**: 單元測試

### 常用條件
- **性能**: 執行效率
- **錯誤**: 語法或邏輯錯誤
- **依賴**: 模組依賴關係
- **格式**: 代碼格式
- **類型**: 類型安全
- **權限**: 訪問控制
